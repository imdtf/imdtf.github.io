<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.43" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://vuepress-theme-hope-v2-demo.mrhope.site/interview/zookeeper.html"><meta property="og:site_name" content="DTF's blog"><meta property="og:title" content="Zookeeper ç¯‡"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-06-08T15:47:48.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:modified_time" content="2022-06-08T15:47:48.000Z"><link rel="stylesheet" href="//at.alicdn.com/t/font_2410206_mfj6e1vbwo.css"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"><title>Zookeeper ç¯‡ | DTF's blog</title><meta name="description" content="æˆ‘çš„å­¦ä¹ è®°å½•åšå®¢">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/assets/style.af58f80f.css">
    <link rel="modulepreload" href="/assets/app.597ce2f2.js"><link rel="modulepreload" href="/assets/zookeeper.html.d47f6f3b.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/assets/zookeeper.html.75896320.js"><link rel="prefetch" href="/assets/index.html.e173ef83.js"><link rel="prefetch" href="/assets/ElasticSearch.html.279e5d7b.js"><link rel="prefetch" href="/assets/MQ.html.9d040945.js"><link rel="prefetch" href="/assets/MySQL.html.d1ae2d1e.js"><link rel="prefetch" href="/assets/Redis.html.b201ad05.js"><link rel="prefetch" href="/assets/design-patterns.html.733535fa.js"><link rel="prefetch" href="/assets/dubbo.html.c776d990.js"><link rel="prefetch" href="/assets/git.html.72b47aa0.js"><link rel="prefetch" href="/assets/java-base.html.db5311da.js"><link rel="prefetch" href="/assets/jvm.html.53d34a5d.js"><link rel="prefetch" href="/assets/linux.html.65017b81.js"><link rel="prefetch" href="/assets/maven.html.ceec6571.js"><link rel="prefetch" href="/assets/multi-thread.html.3652cc7f.js"><link rel="prefetch" href="/assets/mybatis.html.cb44fe5a.js"><link rel="prefetch" href="/assets/network.html.b1609fd9.js"><link rel="prefetch" href="/assets/nginx.html.9ca67d3a.js"><link rel="prefetch" href="/assets/soft-power.html.508fb44f.js"><link rel="prefetch" href="/assets/spring-boot.html.e888e4e7.js"><link rel="prefetch" href="/assets/spring-cloud.html.57c2b0d4.js"><link rel="prefetch" href="/assets/spring.html.94b261f5.js"><link rel="prefetch" href="/assets/tomcat.html.dc4aea03.js"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼.html.6e369ff9.js"><link rel="prefetch" href="/assets/java-basic-questions-01.html.58f6dba8.js"><link rel="prefetch" href="/assets/00 å¼€ç¯‡è¯ è¿™ä¸€æ¬¡_ è®©æˆ‘ä»¬ä¸€èµ·æ¥ææ‡‚MySQL.html.04b85b76.js"><link rel="prefetch" href="/assets/01 åŸºç¡€æ¶æ„ ä¸€æ¡SQLæŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„.html.116abb6a.js"><link rel="prefetch" href="/assets/02 æ—¥å¿—ç³»ç»Ÿ ä¸€æ¡SQLæ›´æ–°è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„.html.1d83f138.js"><link rel="prefetch" href="/assets/03 äº‹åŠ¡éš”ç¦» ä¸ºä»€ä¹ˆä½ æ”¹äº†æˆ‘è¿˜çœ‹ä¸è§.html.40f6f1e4.js"><link rel="prefetch" href="/assets/04 æ·±å…¥æµ…å‡ºç´¢å¼•ï¼ˆä¸Šï¼‰.html.900bda42.js"><link rel="prefetch" href="/assets/05 æ·±å…¥æµ…å‡ºç´¢å¼•ï¼ˆä¸‹ï¼‰.html.3492d336.js"><link rel="prefetch" href="/assets/06 å…¨å±€é”å’Œè¡¨é” ç»™è¡¨åŠ ä¸ªå­—æ®µæ€ä¹ˆæœ‰è¿™ä¹ˆå¤šé˜»ç¢.html.dcc88998.js"><link rel="prefetch" href="/assets/07 è¡Œé”åŠŸè¿‡ æ€ä¹ˆå‡å°‘è¡Œé”å¯¹æ€§èƒ½çš„å½±å“.html.7239f150.js"><link rel="prefetch" href="/assets/08 äº‹åŠ¡åˆ°åº•æ˜¯éš”ç¦»çš„è¿˜æ˜¯ä¸éš”ç¦»çš„.html.6199feb4.js"><link rel="prefetch" href="/assets/09 æ™®é€šç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•_ åº”è¯¥æ€ä¹ˆé€‰æ‹©.html.57624587.js"><link rel="prefetch" href="/assets/10 MySQLä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šé€‰é”™ç´¢å¼•.html.d99caa1b.js"><link rel="prefetch" href="/assets/11 æ€ä¹ˆç»™å­—ç¬¦ä¸²å­—æ®µåŠ ç´¢å¼•.html.cabd308f.js"><link rel="prefetch" href="/assets/12 ä¸ºä»€ä¹ˆæˆ‘çš„MySQLä¼šâ€œæŠ–â€ä¸€ä¸‹.html.c89015fe.js"><link rel="prefetch" href="/assets/13 ä¸ºä»€ä¹ˆè¡¨æ•°æ®åˆ æ‰ä¸€åŠ_ è¡¨æ–‡ä»¶å¤§å°ä¸å˜.html.6b8e9ff0.js"><link rel="prefetch" href="/assets/14 count()è¿™ä¹ˆæ…¢_ æˆ‘è¯¥æ€ä¹ˆåŠ.html.e1e4da4a.js"><link rel="prefetch" href="/assets/15 ç­”ç–‘æ–‡ç« ï¼ˆä¸€ï¼‰ æ—¥å¿—å’Œç´¢å¼•ç›¸å…³é—®é¢˜.html.697b9a23.js"><link rel="prefetch" href="/assets/16 â€œorder byâ€æ˜¯æ€ä¹ˆå·¥ä½œçš„.html.9000e742.js"><link rel="prefetch" href="/assets/17 å¦‚ä½•æ­£ç¡®åœ°æ˜¾ç¤ºéšæœºæ¶ˆæ¯.html.4d12fb46.js"><link rel="prefetch" href="/assets/18 ä¸ºä»€ä¹ˆè¿™äº›SQLè¯­å¥é€»è¾‘ç›¸åŒ_ æ€§èƒ½å´å·®å¼‚å·¨å¤§.html.48d80708.js"><link rel="prefetch" href="/assets/19 ä¸ºä»€ä¹ˆæˆ‘åªæŸ¥ä¸€è¡Œçš„è¯­å¥_ ä¹Ÿæ‰§è¡Œè¿™ä¹ˆæ…¢.html.da9eab5a.js"><link rel="prefetch" href="/assets/20 å¹»è¯»æ˜¯ä»€ä¹ˆ_ å¹»è¯»æœ‰ä»€ä¹ˆé—®é¢˜.html.95150d1c.js"><link rel="prefetch" href="/assets/21 ä¸ºä»€ä¹ˆæˆ‘åªæ”¹ä¸€è¡Œçš„è¯­å¥_ é”è¿™ä¹ˆå¤š.html.b9bda91b.js"><link rel="prefetch" href="/assets/22.MySQLæœ‰å“ªäº›â€œé¥®é¸©æ­¢æ¸´â€æé«˜æ€§èƒ½çš„æ–¹æ³•.html.bb805e63.js"><link rel="prefetch" href="/assets/23 MySQLæ˜¯æ€ä¹ˆä¿è¯æ•°æ®ä¸ä¸¢çš„.html.514eb232.js"><link rel="prefetch" href="/assets/24 MySQLæ˜¯æ€ä¹ˆä¿è¯ä¸»å¤‡ä¸€è‡´çš„.html.4cfc99f3.js"><link rel="prefetch" href="/assets/25 MySQLæ˜¯æ€ä¹ˆä¿è¯é«˜å¯ç”¨çš„.html.1561ec1a.js"><link rel="prefetch" href="/assets/26 å¤‡åº“ä¸ºä»€ä¹ˆä¼šå»¶è¿Ÿå¥½å‡ ä¸ªå°æ—¶.html.11ef8b3e.js"><link rel="prefetch" href="/assets/27 ä¸»åº“å‡ºé—®é¢˜äº†_ ä»åº“æ€ä¹ˆåŠ.html.ef765715.js"><link rel="prefetch" href="/assets/28 è¯»å†™åˆ†ç¦»æœ‰å“ªäº›å‘.html.50f4f1d6.js"><link rel="prefetch" href="/assets/29 å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªæ•°æ®åº“æ˜¯ä¸æ˜¯å‡ºé—®é¢˜äº†.html.60a1c908.js"><link rel="prefetch" href="/assets/30 ç­”ç–‘æ–‡ç« ï¼ˆäºŒï¼‰ ç”¨åŠ¨æ€çš„è§‚ç‚¹çœ‹åŠ é”.html.b6c6ee60.js"><link rel="prefetch" href="/assets/31 è¯¯åˆ æ•°æ®åé™¤äº†è·‘è·¯_ è¿˜èƒ½æ€ä¹ˆåŠ.html.0fa73bd5.js"><link rel="prefetch" href="/assets/32 ä¸ºä»€ä¹ˆè¿˜æœ‰killä¸æ‰çš„è¯­å¥.html.bfe213be.js"><link rel="prefetch" href="/assets/33 æˆ‘æŸ¥è¿™ä¹ˆå¤šæ•°æ®_ ä¼šä¸ä¼šæŠŠæ•°æ®åº“å†…å­˜æ‰“çˆ†.html.e0558584.js"><link rel="prefetch" href="/assets/34 åˆ°åº•å¯ä¸å¯ä»¥ä½¿ç”¨join.html.3087bc74.js"><link rel="prefetch" href="/assets/35 joinè¯­å¥æ€ä¹ˆä¼˜åŒ–.html.c5df5f6e.js"><link rel="prefetch" href="/assets/36 ä¸ºä»€ä¹ˆä¸´æ—¶è¡¨å¯ä»¥é‡å.html.b9edc687.js"><link rel="prefetch" href="/assets/37 ä»€ä¹ˆæ—¶å€™ä¼šä½¿ç”¨å†…éƒ¨ä¸´æ—¶è¡¨.html.9906de00.js"><link rel="prefetch" href="/assets/38 éƒ½è¯´InnoDBå¥½_ é‚£è¿˜è¦ä¸è¦ä½¿ç”¨Memoryå¼•æ“.html.4b8670c8.js"><link rel="prefetch" href="/assets/39 è‡ªå¢ä¸»é”®ä¸ºä»€ä¹ˆä¸æ˜¯è¿ç»­çš„.html.b78f67d4.js"><link rel="prefetch" href="/assets/40 insertè¯­å¥çš„é”ä¸ºä»€ä¹ˆè¿™ä¹ˆå¤š.html.b762f081.js"><link rel="prefetch" href="/assets/41 æ€ä¹ˆæœ€å¿«åœ°å¤åˆ¶ä¸€å¼ è¡¨.html.e5ec66c1.js"><link rel="prefetch" href="/assets/42 grantä¹‹åè¦è·Ÿç€flush privilegeså—.html.f9b4c2c6.js"><link rel="prefetch" href="/assets/43 è¦ä¸è¦ä½¿ç”¨åˆ†åŒºè¡¨.html.d4daa082.js"><link rel="prefetch" href="/assets/44 ç­”ç–‘æ–‡ç« ï¼ˆä¸‰ï¼‰ è¯´ä¸€è¯´è¿™äº›å¥½é—®é¢˜.html.1f616fc4.js"><link rel="prefetch" href="/assets/45 è‡ªå¢idç”¨å®Œæ€ä¹ˆåŠ.html.25fe22f4.js"><link rel="prefetch" href="/assets/ç›´æ’­å›é¡¾ æ—æ™“æ–Œ æˆ‘çš„ MySQL å¿ƒè·¯å†ç¨‹.html.8bb53047.js"><link rel="prefetch" href="/assets/ç»“æŸè¯­ ç‚¹çº¿ç½‘é¢_ ä¸€èµ·æ„å»ºMySQLçŸ¥è¯†ç½‘ç»œ.html.63f53d07.js"><link rel="prefetch" href="/assets/00-Introduction.html.aed5c856.js"><link rel="prefetch" href="/assets/00-Preface.html.feee9db3.js"><link rel="prefetch" href="/assets/01-What-is-an-Object.html.ab6ea8b6.js"><link rel="prefetch" href="/assets/02-Installing-Java-and-the-Book-Examples.html.0224a9bf.js"><link rel="prefetch" href="/assets/03-Objects-Everywhere.html.bea55af9.js"><link rel="prefetch" href="/assets/04-Operators.html.35525abf.js"><link rel="prefetch" href="/assets/05-Control-Flow.html.c4cd86f5.js"><link rel="prefetch" href="/assets/06-Housekeeping.html.b5c2b268.js"><link rel="prefetch" href="/assets/07-Implementation-Hiding.html.399ae58f.js"><link rel="prefetch" href="/assets/08-Reuse.html.0ab07e65.js"><link rel="prefetch" href="/assets/09-Polymorphism.html.89443cf5.js"><link rel="prefetch" href="/assets/10-Interfaces.html.4948bb7b.js"><link rel="prefetch" href="/assets/11-Inner-Classes.html.b8f6a196.js"><link rel="prefetch" href="/assets/12-Collections.html.52f2a06b.js"><link rel="prefetch" href="/assets/13-Functional-Programming.html.db50a84d.js"><link rel="prefetch" href="/assets/14-Streams.html.9308751d.js"><link rel="prefetch" href="/assets/15-Exceptions.html.40e68d98.js"><link rel="prefetch" href="/assets/16-Validating-Your-Code.html.3edda5f0.js"><link rel="prefetch" href="/assets/17-Files.html.e87e7c99.js"><link rel="prefetch" href="/assets/18-Strings.html.a2842b17.js"><link rel="prefetch" href="/assets/19-Type-Information.html.12cc605b.js"><link rel="prefetch" href="/assets/20-Generics.html.3e4b17f6.js"><link rel="prefetch" href="/assets/21-Arrays.html.67720723.js"><link rel="prefetch" href="/assets/22-Enumerations.html.ab50f89b.js"><link rel="prefetch" href="/assets/23-Annotations.html.747faef3.js"><link rel="prefetch" href="/assets/24-Concurrent-Programming.html.5b9841aa.js"><link rel="prefetch" href="/assets/25-Patterns.html.10af6fe7.js"><link rel="prefetch" href="/assets/Appendix-Becoming-a-Programmer.html.13f6de18.js"><link rel="prefetch" href="/assets/Appendix-Benefits-and-Costs-of-Static-Type-Checking.html.4774ac79.js"><link rel="prefetch" href="/assets/Appendix-Collection-Topics.html.fec6d369.js"><link rel="prefetch" href="/assets/Appendix-Data-Compression.html.fe3a1870.js"><link rel="prefetch" href="/assets/Appendix-IO-Streams.html.35950f4f.js"><link rel="prefetch" href="/assets/Appendix-Javadoc.html.54af4f5f.js"><link rel="prefetch" href="/assets/Appendix-Low-Level-Concurrency.html.bb07240e.js"><link rel="prefetch" href="/assets/Appendix-New-IO.html.8f39ad15.js"><link rel="prefetch" href="/assets/Appendix-Object-Serialization.html.39836314.js"><link rel="prefetch" href="/assets/Appendix-Passing-and-Returning-Objects.html.ee52b83c.js"><link rel="prefetch" href="/assets/Appendix-Programming-Guidelines.html.68302b50.js"><link rel="prefetch" href="/assets/Appendix-Standard-IO.html.9b5edd63.js"><link rel="prefetch" href="/assets/Appendix-Supplements.html.c8a5f6e1.js"><link rel="prefetch" href="/assets/Appendix-The-Positive-Legacy-of-C-plus-plus-and-Java.html.34dcd815.js"><link rel="prefetch" href="/assets/Appendix-Understanding-equals-and-hashCode.html.8c0a6980.js"><link rel="prefetch" href="/assets/GLOSSARY.html.af317d6f.js"><link rel="prefetch" href="/assets/index.html.859506fe.js"><link rel="prefetch" href="/assets/404.html.61bcede7.js"><link rel="prefetch" href="/assets/index.html.6eefb2c9.js"><link rel="prefetch" href="/assets/index.html.276bb6b8.js"><link rel="prefetch" href="/assets/index.html.6c49b0c9.js"><link rel="prefetch" href="/assets/index.html.938faca6.js"><link rel="prefetch" href="/assets/index.html.234dfb8d.js"><link rel="prefetch" href="/assets/index.html.02cffa46.js"><link rel="prefetch" href="/assets/index.html.c70b19c7.js"><link rel="prefetch" href="/assets/index.html.e9ae5772.js"><link rel="prefetch" href="/assets/index.html.43ef8dd6.js"><link rel="prefetch" href="/assets/index.html.0319d1c3.js"><link rel="prefetch" href="/assets/ElasticSearch.html.1822d360.js"><link rel="prefetch" href="/assets/MQ.html.257a1eec.js"><link rel="prefetch" href="/assets/MySQL.html.12265bed.js"><link rel="prefetch" href="/assets/Redis.html.c5915ac6.js"><link rel="prefetch" href="/assets/design-patterns.html.4dff82bc.js"><link rel="prefetch" href="/assets/dubbo.html.70900b5c.js"><link rel="prefetch" href="/assets/git.html.9f0ce8a6.js"><link rel="prefetch" href="/assets/java-base.html.f9b49957.js"><link rel="prefetch" href="/assets/jvm.html.7b42d915.js"><link rel="prefetch" href="/assets/linux.html.9f1e7d55.js"><link rel="prefetch" href="/assets/maven.html.f848fc43.js"><link rel="prefetch" href="/assets/multi-thread.html.5d323dfe.js"><link rel="prefetch" href="/assets/mybatis.html.868f5463.js"><link rel="prefetch" href="/assets/network.html.347740e9.js"><link rel="prefetch" href="/assets/nginx.html.acf44958.js"><link rel="prefetch" href="/assets/soft-power.html.fa4cc2bb.js"><link rel="prefetch" href="/assets/spring-boot.html.eb446c44.js"><link rel="prefetch" href="/assets/spring-cloud.html.5a2e7953.js"><link rel="prefetch" href="/assets/spring.html.e5d334fa.js"><link rel="prefetch" href="/assets/tomcat.html.1edb1280.js"><link rel="prefetch" href="/assets/åˆ†å¸ƒå¼.html.8362b544.js"><link rel="prefetch" href="/assets/java-basic-questions-01.html.e0b3e691.js"><link rel="prefetch" href="/assets/00 å¼€ç¯‡è¯ è¿™ä¸€æ¬¡_ è®©æˆ‘ä»¬ä¸€èµ·æ¥ææ‡‚MySQL.html.73dedd46.js"><link rel="prefetch" href="/assets/01 åŸºç¡€æ¶æ„ ä¸€æ¡SQLæŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„.html.a7a61510.js"><link rel="prefetch" href="/assets/02 æ—¥å¿—ç³»ç»Ÿ ä¸€æ¡SQLæ›´æ–°è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„.html.19af1cfc.js"><link rel="prefetch" href="/assets/03 äº‹åŠ¡éš”ç¦» ä¸ºä»€ä¹ˆä½ æ”¹äº†æˆ‘è¿˜çœ‹ä¸è§.html.078c9131.js"><link rel="prefetch" href="/assets/04 æ·±å…¥æµ…å‡ºç´¢å¼•ï¼ˆä¸Šï¼‰.html.3da35573.js"><link rel="prefetch" href="/assets/05 æ·±å…¥æµ…å‡ºç´¢å¼•ï¼ˆä¸‹ï¼‰.html.ee1e2ba2.js"><link rel="prefetch" href="/assets/06 å…¨å±€é”å’Œè¡¨é” ç»™è¡¨åŠ ä¸ªå­—æ®µæ€ä¹ˆæœ‰è¿™ä¹ˆå¤šé˜»ç¢.html.5796a618.js"><link rel="prefetch" href="/assets/07 è¡Œé”åŠŸè¿‡ æ€ä¹ˆå‡å°‘è¡Œé”å¯¹æ€§èƒ½çš„å½±å“.html.26f3a028.js"><link rel="prefetch" href="/assets/08 äº‹åŠ¡åˆ°åº•æ˜¯éš”ç¦»çš„è¿˜æ˜¯ä¸éš”ç¦»çš„.html.cbc4b5ad.js"><link rel="prefetch" href="/assets/09 æ™®é€šç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•_ åº”è¯¥æ€ä¹ˆé€‰æ‹©.html.d79a5425.js"><link rel="prefetch" href="/assets/10 MySQLä¸ºä»€ä¹ˆæœ‰æ—¶å€™ä¼šé€‰é”™ç´¢å¼•.html.8dab2c77.js"><link rel="prefetch" href="/assets/11 æ€ä¹ˆç»™å­—ç¬¦ä¸²å­—æ®µåŠ ç´¢å¼•.html.f8e03fcd.js"><link rel="prefetch" href="/assets/12 ä¸ºä»€ä¹ˆæˆ‘çš„MySQLä¼šâ€œæŠ–â€ä¸€ä¸‹.html.f1c1f80f.js"><link rel="prefetch" href="/assets/13 ä¸ºä»€ä¹ˆè¡¨æ•°æ®åˆ æ‰ä¸€åŠ_ è¡¨æ–‡ä»¶å¤§å°ä¸å˜.html.a0b4da7e.js"><link rel="prefetch" href="/assets/14 count()è¿™ä¹ˆæ…¢_ æˆ‘è¯¥æ€ä¹ˆåŠ.html.8cf5825d.js"><link rel="prefetch" href="/assets/15 ç­”ç–‘æ–‡ç« ï¼ˆä¸€ï¼‰ æ—¥å¿—å’Œç´¢å¼•ç›¸å…³é—®é¢˜.html.63173a34.js"><link rel="prefetch" href="/assets/16 â€œorder byâ€æ˜¯æ€ä¹ˆå·¥ä½œçš„.html.a51cc121.js"><link rel="prefetch" href="/assets/17 å¦‚ä½•æ­£ç¡®åœ°æ˜¾ç¤ºéšæœºæ¶ˆæ¯.html.55632279.js"><link rel="prefetch" href="/assets/18 ä¸ºä»€ä¹ˆè¿™äº›SQLè¯­å¥é€»è¾‘ç›¸åŒ_ æ€§èƒ½å´å·®å¼‚å·¨å¤§.html.aa190da2.js"><link rel="prefetch" href="/assets/19 ä¸ºä»€ä¹ˆæˆ‘åªæŸ¥ä¸€è¡Œçš„è¯­å¥_ ä¹Ÿæ‰§è¡Œè¿™ä¹ˆæ…¢.html.c311f962.js"><link rel="prefetch" href="/assets/20 å¹»è¯»æ˜¯ä»€ä¹ˆ_ å¹»è¯»æœ‰ä»€ä¹ˆé—®é¢˜.html.bef20aad.js"><link rel="prefetch" href="/assets/21 ä¸ºä»€ä¹ˆæˆ‘åªæ”¹ä¸€è¡Œçš„è¯­å¥_ é”è¿™ä¹ˆå¤š.html.54dcb84b.js"><link rel="prefetch" href="/assets/22.MySQLæœ‰å“ªäº›â€œé¥®é¸©æ­¢æ¸´â€æé«˜æ€§èƒ½çš„æ–¹æ³•.html.baae2fb3.js"><link rel="prefetch" href="/assets/23 MySQLæ˜¯æ€ä¹ˆä¿è¯æ•°æ®ä¸ä¸¢çš„.html.de07d445.js"><link rel="prefetch" href="/assets/24 MySQLæ˜¯æ€ä¹ˆä¿è¯ä¸»å¤‡ä¸€è‡´çš„.html.d8703177.js"><link rel="prefetch" href="/assets/25 MySQLæ˜¯æ€ä¹ˆä¿è¯é«˜å¯ç”¨çš„.html.93feb431.js"><link rel="prefetch" href="/assets/26 å¤‡åº“ä¸ºä»€ä¹ˆä¼šå»¶è¿Ÿå¥½å‡ ä¸ªå°æ—¶.html.14ad8743.js"><link rel="prefetch" href="/assets/27 ä¸»åº“å‡ºé—®é¢˜äº†_ ä»åº“æ€ä¹ˆåŠ.html.2e4d7d89.js"><link rel="prefetch" href="/assets/28 è¯»å†™åˆ†ç¦»æœ‰å“ªäº›å‘.html.ebe6ec2f.js"><link rel="prefetch" href="/assets/29 å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªæ•°æ®åº“æ˜¯ä¸æ˜¯å‡ºé—®é¢˜äº†.html.a1a0d482.js"><link rel="prefetch" href="/assets/30 ç­”ç–‘æ–‡ç« ï¼ˆäºŒï¼‰ ç”¨åŠ¨æ€çš„è§‚ç‚¹çœ‹åŠ é”.html.7353d51d.js"><link rel="prefetch" href="/assets/31 è¯¯åˆ æ•°æ®åé™¤äº†è·‘è·¯_ è¿˜èƒ½æ€ä¹ˆåŠ.html.b546fd0e.js"><link rel="prefetch" href="/assets/32 ä¸ºä»€ä¹ˆè¿˜æœ‰killä¸æ‰çš„è¯­å¥.html.fa14f195.js"><link rel="prefetch" href="/assets/33 æˆ‘æŸ¥è¿™ä¹ˆå¤šæ•°æ®_ ä¼šä¸ä¼šæŠŠæ•°æ®åº“å†…å­˜æ‰“çˆ†.html.ddaebd47.js"><link rel="prefetch" href="/assets/34 åˆ°åº•å¯ä¸å¯ä»¥ä½¿ç”¨join.html.9f503937.js"><link rel="prefetch" href="/assets/35 joinè¯­å¥æ€ä¹ˆä¼˜åŒ–.html.95f81089.js"><link rel="prefetch" href="/assets/36 ä¸ºä»€ä¹ˆä¸´æ—¶è¡¨å¯ä»¥é‡å.html.354471cd.js"><link rel="prefetch" href="/assets/37 ä»€ä¹ˆæ—¶å€™ä¼šä½¿ç”¨å†…éƒ¨ä¸´æ—¶è¡¨.html.c9d4ab47.js"><link rel="prefetch" href="/assets/38 éƒ½è¯´InnoDBå¥½_ é‚£è¿˜è¦ä¸è¦ä½¿ç”¨Memoryå¼•æ“.html.9b369837.js"><link rel="prefetch" href="/assets/39 è‡ªå¢ä¸»é”®ä¸ºä»€ä¹ˆä¸æ˜¯è¿ç»­çš„.html.93069f29.js"><link rel="prefetch" href="/assets/40 insertè¯­å¥çš„é”ä¸ºä»€ä¹ˆè¿™ä¹ˆå¤š.html.b6a68508.js"><link rel="prefetch" href="/assets/41 æ€ä¹ˆæœ€å¿«åœ°å¤åˆ¶ä¸€å¼ è¡¨.html.4cda471b.js"><link rel="prefetch" href="/assets/42 grantä¹‹åè¦è·Ÿç€flush privilegeså—.html.fec20cbf.js"><link rel="prefetch" href="/assets/43 è¦ä¸è¦ä½¿ç”¨åˆ†åŒºè¡¨.html.46eb93f8.js"><link rel="prefetch" href="/assets/44 ç­”ç–‘æ–‡ç« ï¼ˆä¸‰ï¼‰ è¯´ä¸€è¯´è¿™äº›å¥½é—®é¢˜.html.70884000.js"><link rel="prefetch" href="/assets/45 è‡ªå¢idç”¨å®Œæ€ä¹ˆåŠ.html.16cc56b7.js"><link rel="prefetch" href="/assets/ç›´æ’­å›é¡¾ æ—æ™“æ–Œ æˆ‘çš„ MySQL å¿ƒè·¯å†ç¨‹.html.0f6a9d34.js"><link rel="prefetch" href="/assets/ç»“æŸè¯­ ç‚¹çº¿ç½‘é¢_ ä¸€èµ·æ„å»ºMySQLçŸ¥è¯†ç½‘ç»œ.html.ced5f781.js"><link rel="prefetch" href="/assets/00-Introduction.html.2b1f0852.js"><link rel="prefetch" href="/assets/00-Preface.html.e516d7c3.js"><link rel="prefetch" href="/assets/01-What-is-an-Object.html.86c4af1e.js"><link rel="prefetch" href="/assets/02-Installing-Java-and-the-Book-Examples.html.88cddd12.js"><link rel="prefetch" href="/assets/03-Objects-Everywhere.html.4da53003.js"><link rel="prefetch" href="/assets/04-Operators.html.f9d313c6.js"><link rel="prefetch" href="/assets/05-Control-Flow.html.ecf81ffe.js"><link rel="prefetch" href="/assets/06-Housekeeping.html.c35ecf1b.js"><link rel="prefetch" href="/assets/07-Implementation-Hiding.html.396e0a6f.js"><link rel="prefetch" href="/assets/08-Reuse.html.8c7c4047.js"><link rel="prefetch" href="/assets/09-Polymorphism.html.2150cc57.js"><link rel="prefetch" href="/assets/10-Interfaces.html.6ee853fa.js"><link rel="prefetch" href="/assets/11-Inner-Classes.html.ae7b89c4.js"><link rel="prefetch" href="/assets/12-Collections.html.0483e4dd.js"><link rel="prefetch" href="/assets/13-Functional-Programming.html.63412e72.js"><link rel="prefetch" href="/assets/14-Streams.html.7e7cce42.js"><link rel="prefetch" href="/assets/15-Exceptions.html.c186f23a.js"><link rel="prefetch" href="/assets/16-Validating-Your-Code.html.b3313ffc.js"><link rel="prefetch" href="/assets/17-Files.html.7a9ad498.js"><link rel="prefetch" href="/assets/18-Strings.html.46e57539.js"><link rel="prefetch" href="/assets/19-Type-Information.html.b68894bf.js"><link rel="prefetch" href="/assets/20-Generics.html.3993804b.js"><link rel="prefetch" href="/assets/21-Arrays.html.4d150e5c.js"><link rel="prefetch" href="/assets/22-Enumerations.html.87d060f0.js"><link rel="prefetch" href="/assets/23-Annotations.html.0c455464.js"><link rel="prefetch" href="/assets/24-Concurrent-Programming.html.8485a02c.js"><link rel="prefetch" href="/assets/25-Patterns.html.4f5781b0.js"><link rel="prefetch" href="/assets/Appendix-Becoming-a-Programmer.html.4e7ecda3.js"><link rel="prefetch" href="/assets/Appendix-Benefits-and-Costs-of-Static-Type-Checking.html.1a18282e.js"><link rel="prefetch" href="/assets/Appendix-Collection-Topics.html.ec4969df.js"><link rel="prefetch" href="/assets/Appendix-Data-Compression.html.c956724d.js"><link rel="prefetch" href="/assets/Appendix-IO-Streams.html.ac5ea88b.js"><link rel="prefetch" href="/assets/Appendix-Javadoc.html.26db6884.js"><link rel="prefetch" href="/assets/Appendix-Low-Level-Concurrency.html.80dbdde9.js"><link rel="prefetch" href="/assets/Appendix-New-IO.html.613e991c.js"><link rel="prefetch" href="/assets/Appendix-Object-Serialization.html.de90320b.js"><link rel="prefetch" href="/assets/Appendix-Passing-and-Returning-Objects.html.1f3841f2.js"><link rel="prefetch" href="/assets/Appendix-Programming-Guidelines.html.a3de1972.js"><link rel="prefetch" href="/assets/Appendix-Standard-IO.html.28579d58.js"><link rel="prefetch" href="/assets/Appendix-Supplements.html.aae5a747.js"><link rel="prefetch" href="/assets/Appendix-The-Positive-Legacy-of-C-plus-plus-and-Java.html.4bf49d65.js"><link rel="prefetch" href="/assets/Appendix-Understanding-equals-and-hashCode.html.9d9599c8.js"><link rel="prefetch" href="/assets/GLOSSARY.html.d812823c.js"><link rel="prefetch" href="/assets/index.html.d25b0535.js"><link rel="prefetch" href="/assets/404.html.0c8252b8.js"><link rel="prefetch" href="/assets/index.html.d5cc08ad.js"><link rel="prefetch" href="/assets/index.html.1331f6ca.js"><link rel="prefetch" href="/assets/index.html.da6c3a69.js"><link rel="prefetch" href="/assets/index.html.1174fbbd.js"><link rel="prefetch" href="/assets/index.html.c73d2264.js"><link rel="prefetch" href="/assets/index.html.1e315145.js"><link rel="prefetch" href="/assets/index.html.514b72a3.js"><link rel="prefetch" href="/assets/index.html.b19f5086.js"><link rel="prefetch" href="/assets/index.html.1ac6115e.js"><link rel="prefetch" href="/assets/404.3a5fd86b.js"><link rel="prefetch" href="/assets/Layout.42785ec5.js"><link rel="prefetch" href="/assets/Slide.5e14cdfb.js"><link rel="prefetch" href="/assets/Blog.f29d76d0.js"><link rel="prefetch" href="/assets/auto.esm.15d52109.js"><link rel="prefetch" href="/assets/index.1842ee54.js"><link rel="prefetch" href="/assets/mermaid.esm.min.f71f1464.js"><link rel="prefetch" href="/assets/highlight.esm.d982e650.js"><link rel="prefetch" href="/assets/markdown.esm.832a189d.js"><link rel="prefetch" href="/assets/math.esm.a3f84b6f.js"><link rel="prefetch" href="/assets/notes.esm.3c361cb7.js"><link rel="prefetch" href="/assets/reveal.esm.b96f05d8.js"><link rel="prefetch" href="/assets/search.esm.80da4a02.js"><link rel="prefetch" href="/assets/zoom.esm.8514a202.js"><link rel="prefetch" href="/assets/photoswipe.esm.92018b73.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc sidebar-open"><!--[--><!--[--><header class="navbar"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><a href="/" class="home-link"><img class="logo" src="/logo.png" alt="DTF&#39;s blog"><!----><span class="site-name hide-in-pad">DTF&#39;s blog</span><!--[--><!----><!--]--></a><nav class="nav-links" style=""><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="åšå®¢ä¸»é¡µ"><i class="icon iconfont icon-home"></i>åšå®¢ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/guide/" class="nav-link" aria-label="ä½¿ç”¨æŒ‡å—"><i class="icon iconfont icon-creative"></i>ä½¿ç”¨æŒ‡å—<!----></a></div></nav><div class="nav-actions-wrapper"><!--[--><!----><!--]--><div class="nav-item"><!----></div><div class="nav-item"><a class="repo-link" href="https://github.com/imdtf/blog" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" aria-labelledby="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><title id="github" lang="en">github icon</title><g fill="currentColor"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></g></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewbox="0 0 1024 1024" aria-labelledby="outlook"><title id="outlook" lang="en">outlook icon</title><g fill="currentColor"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></g></svg><div class="outlook-dropdown"><!----></div></button></div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button><!--[--><!----><!--]--></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/" class="nav-link sidebar-link sidebar-page" aria-label="åšå®¢ä¸»é¡µ"><i class="icon iconfont icon-home"></i>åšå®¢ä¸»é¡µ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><i class="icon iconfont icon-guide"></i><span class="title">è¯­è¨€</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><i class="icon iconfont icon-markdown"></i><span class="title">æ•°æ®åº“</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable active"><i class="icon iconfont icon-question"></i><span class="title">é¢è¯•é¢˜</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/interview/java-base.html" class="nav-link sidebar-link sidebar-page" aria-label="åŸºç¡€ç¯‡"><!---->åŸºç¡€ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/interview/jvm.html" class="nav-link sidebar-link sidebar-page" aria-label="JVM ç¯‡"><!---->JVM ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/interview/multi-thread.html" class="nav-link sidebar-link sidebar-page" aria-label="å¤šçº¿ç¨‹&amp;å¹¶å‘ç¯‡"><!---->å¤šçº¿ç¨‹&amp;å¹¶å‘ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/interview/spring.html" class="nav-link sidebar-link sidebar-page" aria-label="Spring ç¯‡"><!---->Spring ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/interview/spring-boot.html" class="nav-link sidebar-link sidebar-page" aria-label="SpringBoot ç¯‡"><!---->SpringBoot ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/interview/spring-cloud.html" class="nav-link sidebar-link sidebar-page" aria-label="SpringCloud ç¯‡"><!---->SpringCloud ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/interview/dubbo.html" class="nav-link sidebar-link sidebar-page" aria-label="Dubbo ç¯‡"><!---->Dubbo ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/interview/mybatis.html" class="nav-link sidebar-link sidebar-page" aria-label="MyBatis ç¯‡"><!---->MyBatis ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/interview/MySQL.html" class="nav-link sidebar-link sidebar-page" aria-label="MySQL ç¯‡"><!---->MySQL ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/interview/nginx.html" class="nav-link sidebar-link sidebar-page" aria-label="Nginx ç¯‡"><!---->Nginx ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/interview/MQ.html" class="nav-link sidebar-link sidebar-page" aria-label="MQ ç¯‡"><!---->MQ ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/interview/linux.html" class="nav-link sidebar-link sidebar-page" aria-label="Linux ç¯‡"><!---->Linux ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/interview/zookeeper.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="Zookeeper ç¯‡"><!---->Zookeeper ç¯‡<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_1ã€è¯´è¯´-zookeeper-æ˜¯ä»€ä¹ˆ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1ã€è¯´è¯´ Zookeeper æ˜¯ä»€ä¹ˆï¼Ÿ"><!---->1ã€è¯´è¯´ Zookeeper æ˜¯ä»€ä¹ˆï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_2ã€zookeeper-æœ‰å“ªäº›åº”ç”¨åœºæ™¯" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2ã€ZooKeeper æœ‰å“ªäº›åº”ç”¨åœºæ™¯ï¼Ÿ"><!---->2ã€ZooKeeper æœ‰å“ªäº›åº”ç”¨åœºæ™¯ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_3ã€è¯´è¯´zookeeperçš„å·¥ä½œåŸç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3ã€è¯´è¯´Zookeeperçš„å·¥ä½œåŸç†ï¼Ÿ"><!---->3ã€è¯´è¯´Zookeeperçš„å·¥ä½œåŸç†ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_4-è¯·æè¿°ä¸€ä¸‹-zookeeper-çš„é€šçŸ¥æœºåˆ¶æ˜¯ä»€ä¹ˆ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4ï¼Œè¯·æè¿°ä¸€ä¸‹ Zookeeper çš„é€šçŸ¥æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ"><!---->4ï¼Œè¯·æè¿°ä¸€ä¸‹ Zookeeper çš„é€šçŸ¥æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_5ã€zookeeper-å¯¹èŠ‚ç‚¹çš„-watch-ç›‘å¬é€šçŸ¥æ˜¯æ°¸ä¹…çš„å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5ã€Zookeeper å¯¹èŠ‚ç‚¹çš„ watch ç›‘å¬é€šçŸ¥æ˜¯æ°¸ä¹…çš„å—ï¼Ÿ"><!---->5ã€Zookeeper å¯¹èŠ‚ç‚¹çš„ watch ç›‘å¬é€šçŸ¥æ˜¯æ°¸ä¹…çš„å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_6ã€zookeeper-é›†ç¾¤ä¸­æœ‰å“ªäº›è§’è‰²" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6ã€Zookeeper é›†ç¾¤ä¸­æœ‰å“ªäº›è§’è‰²ï¼Ÿ"><!---->6ã€Zookeeper é›†ç¾¤ä¸­æœ‰å“ªäº›è§’è‰²ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_7ã€zookeeper-é›†ç¾¤ä¸­-server-æœ‰å“ªäº›å·¥ä½œçŠ¶æ€" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7ã€Zookeeper é›†ç¾¤ä¸­ Server æœ‰å“ªäº›å·¥ä½œçŠ¶æ€ï¼Ÿ"><!---->7ã€Zookeeper é›†ç¾¤ä¸­ Server æœ‰å“ªäº›å·¥ä½œçŠ¶æ€ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_8ã€zookeeper-é›†ç¾¤ä¸­æ˜¯æ€æ ·é€‰ä¸¾-leader-çš„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8ã€Zookeeper é›†ç¾¤ä¸­æ˜¯æ€æ ·é€‰ä¸¾ leader çš„ï¼Ÿ"><!---->8ã€Zookeeper é›†ç¾¤ä¸­æ˜¯æ€æ ·é€‰ä¸¾ leader çš„ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_9ã€zookeeper-æ˜¯å¦‚ä½•ä¿è¯äº‹åŠ¡çš„é¡ºåºä¸€è‡´æ€§çš„å‘¢" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="9ã€Zookeeper æ˜¯å¦‚ä½•ä¿è¯äº‹åŠ¡çš„é¡ºåºä¸€è‡´æ€§çš„å‘¢ï¼Ÿ"><!---->9ã€Zookeeper æ˜¯å¦‚ä½•ä¿è¯äº‹åŠ¡çš„é¡ºåºä¸€è‡´æ€§çš„å‘¢ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_10ã€zookeeper-é›†ç¾¤ä¸­ä¸ªæœåŠ¡å™¨ä¹‹é—´æ˜¯æ€æ ·é€šä¿¡çš„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="10ã€ZooKeeper é›†ç¾¤ä¸­ä¸ªæœåŠ¡å™¨ä¹‹é—´æ˜¯æ€æ ·é€šä¿¡çš„ï¼Ÿ"><!---->10ã€ZooKeeper é›†ç¾¤ä¸­ä¸ªæœåŠ¡å™¨ä¹‹é—´æ˜¯æ€æ ·é€šä¿¡çš„ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_11ã€zookeeper-åˆ†å¸ƒå¼é”æ€ä¹ˆå®ç°çš„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="11ã€ZooKeeper åˆ†å¸ƒå¼é”æ€ä¹ˆå®ç°çš„ï¼Ÿ"><!---->11ã€ZooKeeper åˆ†å¸ƒå¼é”æ€ä¹ˆå®ç°çš„ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_12ã€äº†è§£zookeeperçš„ç³»ç»Ÿæ¶æ„å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="12ã€äº†è§£Zookeeperçš„ç³»ç»Ÿæ¶æ„å—ï¼Ÿ"><!---->12ã€äº†è§£Zookeeperçš„ç³»ç»Ÿæ¶æ„å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_13ã€zookeeperä¸ºä»€ä¹ˆè¦è¿™ä¹ˆè®¾è®¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="13ã€Zookeeperä¸ºä»€ä¹ˆè¦è¿™ä¹ˆè®¾è®¡ï¼Ÿ"><!---->13ã€Zookeeperä¸ºä»€ä¹ˆè¦è¿™ä¹ˆè®¾è®¡ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_14ã€ä½ çŸ¥é“zookeeperä¸­æœ‰å“ªäº›è§’è‰²" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="14ã€ä½ çŸ¥é“Zookeeperä¸­æœ‰å“ªäº›è§’è‰²ï¼Ÿ"><!---->14ã€ä½ çŸ¥é“Zookeeperä¸­æœ‰å“ªäº›è§’è‰²ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_15ã€ä½ ç†Ÿæ‚‰zookeeperèŠ‚ç‚¹znodeå’Œç›¸å…³å±æ€§å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="15ã€ä½ ç†Ÿæ‚‰ZookeeperèŠ‚ç‚¹ZNodeå’Œç›¸å…³å±æ€§å—ï¼Ÿ"><!---->15ã€ä½ ç†Ÿæ‚‰ZookeeperèŠ‚ç‚¹ZNodeå’Œç›¸å…³å±æ€§å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_16ã€è¯·ç®€è¿°zookeeperçš„é€‰ä¸»æµç¨‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="16ã€è¯·ç®€è¿°Zookeeperçš„é€‰ä¸»æµç¨‹"><!---->16ã€è¯·ç®€è¿°Zookeeperçš„é€‰ä¸»æµç¨‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_17ã€ä¸ºä»€ä¹ˆzookeeperé›†ç¾¤çš„æ•°ç›®-ä¸€èˆ¬ä¸ºå¥‡æ•°ä¸ª" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="17ã€ä¸ºä»€ä¹ˆZookeeperé›†ç¾¤çš„æ•°ç›®ï¼Œä¸€èˆ¬ä¸ºå¥‡æ•°ä¸ªï¼Ÿ"><!---->17ã€ä¸ºä»€ä¹ˆZookeeperé›†ç¾¤çš„æ•°ç›®ï¼Œä¸€èˆ¬ä¸ºå¥‡æ•°ä¸ªï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_18ã€çŸ¥é“zookeeperç›‘å¬å™¨çš„åŸç†å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="18ã€çŸ¥é“Zookeeperç›‘å¬å™¨çš„åŸç†å—ï¼Ÿ"><!---->18ã€çŸ¥é“Zookeeperç›‘å¬å™¨çš„åŸç†å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_19ã€è¯´è¯´zookeeperä¸­çš„acl-æƒé™æ§åˆ¶æœºåˆ¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="19ã€è¯´è¯´Zookeeperä¸­çš„ACL æƒé™æ§åˆ¶æœºåˆ¶"><!---->19ã€è¯´è¯´Zookeeperä¸­çš„ACL æƒé™æ§åˆ¶æœºåˆ¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_20ã€zookeeper-æœ‰å“ªå‡ ç§å‡ ç§éƒ¨ç½²æ¨¡å¼" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="20ã€Zookeeper æœ‰å“ªå‡ ç§å‡ ç§éƒ¨ç½²æ¨¡å¼ï¼Ÿ"><!---->20ã€Zookeeper æœ‰å“ªå‡ ç§å‡ ç§éƒ¨ç½²æ¨¡å¼ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_21ã€zookeeperé›†ç¾¤æ”¯æŒåŠ¨æ€æ·»åŠ æœºå™¨å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="21ã€Zookeeperé›†ç¾¤æ”¯æŒåŠ¨æ€æ·»åŠ æœºå™¨å—ï¼Ÿ"><!---->21ã€Zookeeperé›†ç¾¤æ”¯æŒåŠ¨æ€æ·»åŠ æœºå™¨å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_22ã€æè¿°ä¸€ä¸‹-zab-åè®®" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="22ã€æè¿°ä¸€ä¸‹ ZAB åè®®"><!---->22ã€æè¿°ä¸€ä¸‹ ZAB åè®®<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_23ã€zab-å’Œ-paxos-ç®—æ³•çš„è”ç³»ä¸åŒºåˆ«" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="23ã€ZAB å’Œ Paxos ç®—æ³•çš„è”ç³»ä¸åŒºåˆ«ï¼Ÿ"><!---->23ã€ZAB å’Œ Paxos ç®—æ³•çš„è”ç³»ä¸åŒºåˆ«ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_24ã€zookeeper-å®•æœºå¦‚ä½•å¤„ç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="24ã€ZooKeeper å®•æœºå¦‚ä½•å¤„ç†ï¼Ÿ"><!---->24ã€ZooKeeper å®•æœºå¦‚ä½•å¤„ç†ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_25ã€-æè¿°ä¸€ä¸‹-zookeeper-çš„-session-ç®¡ç†çš„æ€æƒ³" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="25ã€ æè¿°ä¸€ä¸‹ ZooKeeper çš„ session ç®¡ç†çš„æ€æƒ³ï¼Ÿ"><!---->25ã€ æè¿°ä¸€ä¸‹ ZooKeeper çš„ session ç®¡ç†çš„æ€æƒ³ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_26ã€zookeeper-è´Ÿè½½å‡è¡¡å’Œ-nginx-è´Ÿè½½å‡è¡¡æœ‰ä»€ä¹ˆåŒºåˆ«" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="26ã€ZooKeeper è´Ÿè½½å‡è¡¡å’Œ Nginx è´Ÿè½½å‡è¡¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><!---->26ã€ZooKeeper è´Ÿè½½å‡è¡¡å’Œ Nginx è´Ÿè½½å‡è¡¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_27ã€è¯´è¯´zookeeper-çš„åºåˆ—åŒ–" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="27ã€è¯´è¯´ZooKeeper çš„åºåˆ—åŒ–"><!---->27ã€è¯´è¯´ZooKeeper çš„åºåˆ—åŒ–<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_28-åœ¨zookeeper-ä¸­-zxid-æ˜¯ä»€ä¹ˆ-æœ‰ä»€ä¹ˆä½œç”¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="28ï¼Œåœ¨Zookeeper ä¸­ Zxid æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"><!---->28ï¼Œåœ¨Zookeeper ä¸­ Zxid æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_29ã€è®²è§£ä¸€ä¸‹-zookeeper-çš„æŒä¹…åŒ–æœºåˆ¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="29ã€è®²è§£ä¸€ä¸‹ ZooKeeper çš„æŒä¹…åŒ–æœºåˆ¶"><!---->29ã€è®²è§£ä¸€ä¸‹ ZooKeeper çš„æŒä¹…åŒ–æœºåˆ¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_30ã€zookeeperé€‰ä¸¾ä¸­æŠ•ç¥¨ä¿¡æ¯çš„äº”å…ƒç»„æ˜¯ä»€ä¹ˆ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="30ã€Zookeeperé€‰ä¸¾ä¸­æŠ•ç¥¨ä¿¡æ¯çš„äº”å…ƒç»„æ˜¯ä»€ä¹ˆï¼Ÿ"><!---->30ã€Zookeeperé€‰ä¸¾ä¸­æŠ•ç¥¨ä¿¡æ¯çš„äº”å…ƒç»„æ˜¯ä»€ä¹ˆï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_31ã€è¯´è¯´zookeeperä¸­çš„è„‘è£‚" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="31ã€è¯´è¯´Zookeeperä¸­çš„è„‘è£‚ï¼Ÿ"><!---->31ã€è¯´è¯´Zookeeperä¸­çš„è„‘è£‚ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_32ã€zookeeperè„‘è£‚æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="32ã€Zookeeperè„‘è£‚æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„ï¼Ÿ"><!---->32ã€Zookeeperè„‘è£‚æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_33ã€zookeeper-æ˜¯å¦‚ä½•è§£å†³è„‘è£‚é—®é¢˜çš„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="33ã€Zookeeper æ˜¯å¦‚ä½•è§£å†³è„‘è£‚é—®é¢˜çš„ï¼Ÿ"><!---->33ã€Zookeeper æ˜¯å¦‚ä½•è§£å†³è„‘è£‚é—®é¢˜çš„ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_34ã€è¯´è¯´-zookeeper-çš„-cap-é—®é¢˜ä¸Šåšçš„å–èˆ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="34ã€è¯´è¯´ Zookeeper çš„ CAP é—®é¢˜ä¸Šåšçš„å–èˆï¼Ÿ"><!---->34ã€è¯´è¯´ Zookeeper çš„ CAP é—®é¢˜ä¸Šåšçš„å–èˆï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/interview/zookeeper.html#_35ã€watch-ç›‘å¬ä¸ºä»€ä¹ˆæ˜¯ä¸€æ¬¡æ€§çš„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="35ã€watch ç›‘å¬ä¸ºä»€ä¹ˆæ˜¯ä¸€æ¬¡æ€§çš„ï¼Ÿ"><!---->35ã€watch ç›‘å¬ä¸ºä»€ä¹ˆæ˜¯ä¸€æ¬¡æ€§çš„ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/interview/Redis.html" class="nav-link sidebar-link sidebar-page" aria-label="Redis ç¯‡"><!---->Redis ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/interview/%E5%88%86%E5%B8%83%E5%BC%8F.html" class="nav-link sidebar-link sidebar-page" aria-label="åˆ†å¸ƒå¼ç¯‡"><!---->åˆ†å¸ƒå¼ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/interview/network.html" class="nav-link sidebar-link sidebar-page" aria-label="ç½‘ç»œç¯‡"><!---->ç½‘ç»œç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/interview/design-patterns.html" class="nav-link sidebar-link sidebar-page" aria-label="è®¾è®¡æ¨¡å¼"><!---->è®¾è®¡æ¨¡å¼<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/interview/maven.html" class="nav-link sidebar-link sidebar-page" aria-label="maven ç¯‡"><!---->maven ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/interview/ElasticSearch.html" class="nav-link sidebar-link sidebar-page" aria-label="ElasticSearch ç¯‡"><!---->ElasticSearch ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/interview/tomcat.html" class="nav-link sidebar-link sidebar-page" aria-label="tomcat ç¯‡"><!---->tomcat ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/interview/git.html" class="nav-link sidebar-link sidebar-page" aria-label="Git ç¯‡"><!---->Git ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/interview/soft-power.html" class="nav-link sidebar-link sidebar-page" aria-label="è½¯å®åŠ›ç¯‡"><!---->è½¯å®åŠ›ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->Zookeeper ç¯‡</h1><div class="page-info"><span class="author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" aria-labelledby="author"><title id="author" lang="en">author icon</title><g fill="currentColor"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></g></svg><span><a class="author-item" href="https://github.com/imdtf" target="_blank" rel="noopener noreferrer">DTF</a></span><span property="author" content="DTF"></span></span><!----><span class="date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" aria-labelledby="calendar"><title id="calendar" lang="en">calendar icon</title><g fill="currentColor"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></g></svg><span>2022å¹´6æœˆ8æ—¥</span><meta property="datePublished" content="2022-06-08T15:47:48.000Z"></span><!----><!----><span class="reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" aria-labelledby="timer"><title id="timer" lang="en">timer icon</title><g fill="currentColor"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></g></svg><span>å¤§çº¦ 39 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT39M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc-list"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_1ã€è¯´è¯´-zookeeper-æ˜¯ä»€ä¹ˆ" class="router-link-active router-link-exact-active toc-link level2">1ã€è¯´è¯´ Zookeeper æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_2ã€zookeeper-æœ‰å“ªäº›åº”ç”¨åœºæ™¯" class="router-link-active router-link-exact-active toc-link level2">2ã€ZooKeeper æœ‰å“ªäº›åº”ç”¨åœºæ™¯ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_3ã€è¯´è¯´zookeeperçš„å·¥ä½œåŸç†" class="router-link-active router-link-exact-active toc-link level2">3ã€è¯´è¯´Zookeeperçš„å·¥ä½œåŸç†ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_4-è¯·æè¿°ä¸€ä¸‹-zookeeper-çš„é€šçŸ¥æœºåˆ¶æ˜¯ä»€ä¹ˆ" class="router-link-active router-link-exact-active toc-link level2">4ï¼Œè¯·æè¿°ä¸€ä¸‹ Zookeeper çš„é€šçŸ¥æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_5ã€zookeeper-å¯¹èŠ‚ç‚¹çš„-watch-ç›‘å¬é€šçŸ¥æ˜¯æ°¸ä¹…çš„å—" class="router-link-active router-link-exact-active toc-link level2">5ã€Zookeeper å¯¹èŠ‚ç‚¹çš„ watch ç›‘å¬é€šçŸ¥æ˜¯æ°¸ä¹…çš„å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_6ã€zookeeper-é›†ç¾¤ä¸­æœ‰å“ªäº›è§’è‰²" class="router-link-active router-link-exact-active toc-link level2">6ã€Zookeeper é›†ç¾¤ä¸­æœ‰å“ªäº›è§’è‰²ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_7ã€zookeeper-é›†ç¾¤ä¸­-server-æœ‰å“ªäº›å·¥ä½œçŠ¶æ€" class="router-link-active router-link-exact-active toc-link level2">7ã€Zookeeper é›†ç¾¤ä¸­ Server æœ‰å“ªäº›å·¥ä½œçŠ¶æ€ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_8ã€zookeeper-é›†ç¾¤ä¸­æ˜¯æ€æ ·é€‰ä¸¾-leader-çš„" class="router-link-active router-link-exact-active toc-link level2">8ã€Zookeeper é›†ç¾¤ä¸­æ˜¯æ€æ ·é€‰ä¸¾ leader çš„ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_9ã€zookeeper-æ˜¯å¦‚ä½•ä¿è¯äº‹åŠ¡çš„é¡ºåºä¸€è‡´æ€§çš„å‘¢" class="router-link-active router-link-exact-active toc-link level2">9ã€Zookeeper æ˜¯å¦‚ä½•ä¿è¯äº‹åŠ¡çš„é¡ºåºä¸€è‡´æ€§çš„å‘¢ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_10ã€zookeeper-é›†ç¾¤ä¸­ä¸ªæœåŠ¡å™¨ä¹‹é—´æ˜¯æ€æ ·é€šä¿¡çš„" class="router-link-active router-link-exact-active toc-link level2">10ã€ZooKeeper é›†ç¾¤ä¸­ä¸ªæœåŠ¡å™¨ä¹‹é—´æ˜¯æ€æ ·é€šä¿¡çš„ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_11ã€zookeeper-åˆ†å¸ƒå¼é”æ€ä¹ˆå®ç°çš„" class="router-link-active router-link-exact-active toc-link level2">11ã€ZooKeeper åˆ†å¸ƒå¼é”æ€ä¹ˆå®ç°çš„ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_12ã€äº†è§£zookeeperçš„ç³»ç»Ÿæ¶æ„å—" class="router-link-active router-link-exact-active toc-link level2">12ã€äº†è§£Zookeeperçš„ç³»ç»Ÿæ¶æ„å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_13ã€zookeeperä¸ºä»€ä¹ˆè¦è¿™ä¹ˆè®¾è®¡" class="router-link-active router-link-exact-active toc-link level2">13ã€Zookeeperä¸ºä»€ä¹ˆè¦è¿™ä¹ˆè®¾è®¡ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_14ã€ä½ çŸ¥é“zookeeperä¸­æœ‰å“ªäº›è§’è‰²" class="router-link-active router-link-exact-active toc-link level2">14ã€ä½ çŸ¥é“Zookeeperä¸­æœ‰å“ªäº›è§’è‰²ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_15ã€ä½ ç†Ÿæ‚‰zookeeperèŠ‚ç‚¹znodeå’Œç›¸å…³å±æ€§å—" class="router-link-active router-link-exact-active toc-link level2">15ã€ä½ ç†Ÿæ‚‰ZookeeperèŠ‚ç‚¹ZNodeå’Œç›¸å…³å±æ€§å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_16ã€è¯·ç®€è¿°zookeeperçš„é€‰ä¸»æµç¨‹" class="router-link-active router-link-exact-active toc-link level2">16ã€è¯·ç®€è¿°Zookeeperçš„é€‰ä¸»æµç¨‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_17ã€ä¸ºä»€ä¹ˆzookeeperé›†ç¾¤çš„æ•°ç›®-ä¸€èˆ¬ä¸ºå¥‡æ•°ä¸ª" class="router-link-active router-link-exact-active toc-link level2">17ã€ä¸ºä»€ä¹ˆZookeeperé›†ç¾¤çš„æ•°ç›®ï¼Œä¸€èˆ¬ä¸ºå¥‡æ•°ä¸ªï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_18ã€çŸ¥é“zookeeperç›‘å¬å™¨çš„åŸç†å—" class="router-link-active router-link-exact-active toc-link level2">18ã€çŸ¥é“Zookeeperç›‘å¬å™¨çš„åŸç†å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_19ã€è¯´è¯´zookeeperä¸­çš„acl-æƒé™æ§åˆ¶æœºåˆ¶" class="router-link-active router-link-exact-active toc-link level2">19ã€è¯´è¯´Zookeeperä¸­çš„ACL æƒé™æ§åˆ¶æœºåˆ¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_20ã€zookeeper-æœ‰å“ªå‡ ç§å‡ ç§éƒ¨ç½²æ¨¡å¼" class="router-link-active router-link-exact-active toc-link level2">20ã€Zookeeper æœ‰å“ªå‡ ç§å‡ ç§éƒ¨ç½²æ¨¡å¼ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_21ã€zookeeperé›†ç¾¤æ”¯æŒåŠ¨æ€æ·»åŠ æœºå™¨å—" class="router-link-active router-link-exact-active toc-link level2">21ã€Zookeeperé›†ç¾¤æ”¯æŒåŠ¨æ€æ·»åŠ æœºå™¨å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_22ã€æè¿°ä¸€ä¸‹-zab-åè®®" class="router-link-active router-link-exact-active toc-link level2">22ã€æè¿°ä¸€ä¸‹ ZAB åè®®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_23ã€zab-å’Œ-paxos-ç®—æ³•çš„è”ç³»ä¸åŒºåˆ«" class="router-link-active router-link-exact-active toc-link level2">23ã€ZAB å’Œ Paxos ç®—æ³•çš„è”ç³»ä¸åŒºåˆ«ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_24ã€zookeeper-å®•æœºå¦‚ä½•å¤„ç†" class="router-link-active router-link-exact-active toc-link level2">24ã€ZooKeeper å®•æœºå¦‚ä½•å¤„ç†ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_25ã€-æè¿°ä¸€ä¸‹-zookeeper-çš„-session-ç®¡ç†çš„æ€æƒ³" class="router-link-active router-link-exact-active toc-link level2">25ã€ æè¿°ä¸€ä¸‹ ZooKeeper çš„ session ç®¡ç†çš„æ€æƒ³ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_26ã€zookeeper-è´Ÿè½½å‡è¡¡å’Œ-nginx-è´Ÿè½½å‡è¡¡æœ‰ä»€ä¹ˆåŒºåˆ«" class="router-link-active router-link-exact-active toc-link level2">26ã€ZooKeeper è´Ÿè½½å‡è¡¡å’Œ Nginx è´Ÿè½½å‡è¡¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_27ã€è¯´è¯´zookeeper-çš„åºåˆ—åŒ–" class="router-link-active router-link-exact-active toc-link level2">27ã€è¯´è¯´ZooKeeper çš„åºåˆ—åŒ–</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_28-åœ¨zookeeper-ä¸­-zxid-æ˜¯ä»€ä¹ˆ-æœ‰ä»€ä¹ˆä½œç”¨" class="router-link-active router-link-exact-active toc-link level2">28ï¼Œåœ¨Zookeeper ä¸­ Zxid æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_29ã€è®²è§£ä¸€ä¸‹-zookeeper-çš„æŒä¹…åŒ–æœºåˆ¶" class="router-link-active router-link-exact-active toc-link level2">29ã€è®²è§£ä¸€ä¸‹ ZooKeeper çš„æŒä¹…åŒ–æœºåˆ¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_30ã€zookeeperé€‰ä¸¾ä¸­æŠ•ç¥¨ä¿¡æ¯çš„äº”å…ƒç»„æ˜¯ä»€ä¹ˆ" class="router-link-active router-link-exact-active toc-link level2">30ã€Zookeeperé€‰ä¸¾ä¸­æŠ•ç¥¨ä¿¡æ¯çš„äº”å…ƒç»„æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_31ã€è¯´è¯´zookeeperä¸­çš„è„‘è£‚" class="router-link-active router-link-exact-active toc-link level2">31ã€è¯´è¯´Zookeeperä¸­çš„è„‘è£‚ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_32ã€zookeeperè„‘è£‚æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„" class="router-link-active router-link-exact-active toc-link level2">32ã€Zookeeperè„‘è£‚æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_33ã€zookeeper-æ˜¯å¦‚ä½•è§£å†³è„‘è£‚é—®é¢˜çš„" class="router-link-active router-link-exact-active toc-link level2">33ã€Zookeeper æ˜¯å¦‚ä½•è§£å†³è„‘è£‚é—®é¢˜çš„ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_34ã€è¯´è¯´-zookeeper-çš„-cap-é—®é¢˜ä¸Šåšçš„å–èˆ" class="router-link-active router-link-exact-active toc-link level2">34ã€è¯´è¯´ Zookeeper çš„ CAP é—®é¢˜ä¸Šåšçš„å–èˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/interview/zookeeper.html#_35ã€watch-ç›‘å¬ä¸ºä»€ä¹ˆæ˜¯ä¸€æ¬¡æ€§çš„" class="router-link-active router-link-exact-active toc-link level2">35ã€watch ç›‘å¬ä¸ºä»€ä¹ˆæ˜¯ä¸€æ¬¡æ€§çš„ï¼Ÿ</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><!--[--><h1 id="zookeeper-ç¯‡" tabindex="-1"><a class="header-anchor" href="#zookeeper-ç¯‡" aria-hidden="true">#</a> Zookeeper ç¯‡</h1><h2 id="_1ã€è¯´è¯´-zookeeper-æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#_1ã€è¯´è¯´-zookeeper-æ˜¯ä»€ä¹ˆ" aria-hidden="true">#</a> 1ã€è¯´è¯´ Zookeeper æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p><strong>ç›´è¯‘</strong>: ä»åå­—ä¸Šç›´è¯‘å°±æ˜¯åŠ¨ç‰©ç®¡ç†å‘˜ï¼ŒåŠ¨ç‰©æŒ‡çš„æ˜¯ Hadoop ä¸€ç±»çš„åˆ†å¸ƒå¼è½¯ä»¶ï¼Œç®¡ç†å‘˜ä¸‰ä¸ªå­—ä½“ç°äº† ZooKeeper çš„ç‰¹ç‚¹ï¼šç»´æŠ¤ã€åè°ƒã€ç®¡ç†ã€ç›‘æ§ã€‚</p><p><strong>ç®€è¿°</strong>: æœ‰äº›è½¯ä»¶ä½ æƒ³åšæˆé›†ç¾¤æˆ–è€…åˆ†å¸ƒå¼ï¼Œä½ å¯ä»¥ç”¨ ZooKeeper å¸®ä½ æ¥è¾…åŠ©å®ç°ã€‚</p><p><strong>ç‰¹ç‚¹</strong> :</p><ul><li>æœ€ç»ˆä¸€è‡´æ€§ï¼šå®¢æˆ·ç«¯çœ‹åˆ°çš„æ•°æ®æœ€ç»ˆæ˜¯ä¸€è‡´çš„ã€‚</li><li>å¯é æ€§ï¼šæœåŠ¡å™¨ä¿å­˜äº†æ¶ˆæ¯ï¼Œé‚£ä¹ˆå®ƒå°±ä¸€ç›´éƒ½å­˜åœ¨ã€‚</li><li>å®æ—¶æ€§ï¼šZooKeeper ä¸èƒ½ä¿è¯ä¸¤ä¸ªå®¢æˆ·ç«¯åŒæ—¶å¾—åˆ°åˆšæ›´æ–°çš„æ•°æ®ã€‚ç‹¬ç«‹æ€§ï¼ˆç­‰å¾…æ— å…³ï¼‰ï¼šä¸åŒå®¢æˆ·ç«¯ç›´æ¥äº’ä¸å½±å“ã€‚</li><li>åŸå­æ€§ï¼šæ›´æ–°è¦ä¸æˆåŠŸè¦ä¸å¤±è´¥ï¼Œæ²¡æœ‰ç¬¬ä¸‰ä¸ªçŠ¶æ€ã€‚</li></ul><p>æ³¨æ„ï¼šå›ç­”é¢è¯•é¢˜ï¼Œåˆ‡å¿Œåªæ˜¯ç®€å•ä¸€å¥è¯å›ç­”ï¼Œå¯ä»¥å°†ä½ å¯¹æ¦‚å¿µçš„ç†è§£ï¼Œç‰¹ç‚¹ç­‰å¤šä¸ªæ–¹é¢æè¿°ä¸€ä¸‹ï¼Œå“ªæ€•ä½ è‡ªå·±è®¤ä¸ºä¸å®Œå…¨åˆ‡ä¸­é¢˜æ„çš„ä¹Ÿå¯ä»¥è¯´è¯´ï¼Œé¢è¯•å®˜ä¸å–œæ¬¢ä¼šæ‰“æ–­ä½ çš„ï¼Œä½ çš„ç›®çš„æ˜¯è®©é¢è¯•å®˜è®¤ä¸ºä½ æ˜¯å¥½æ²Ÿé€šçš„ã€‚å½“ç„¶äº†ï¼Œå¦‚æœä¸ä¼šå¯åˆ«è£…ä½œä¼šï¼Œè¯´å¤ªå¤šä¸ä¸“ä¸šçš„æƒ³æ³•ã€‚</p><h2 id="_2ã€zookeeper-æœ‰å“ªäº›åº”ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#_2ã€zookeeper-æœ‰å“ªäº›åº”ç”¨åœºæ™¯" aria-hidden="true">#</a> 2ã€ZooKeeper æœ‰å“ªäº›åº”ç”¨åœºæ™¯ï¼Ÿ</h2><ul><li><p><strong>æ•°æ®å‘å¸ƒä¸è®¢é˜…</strong></p><p>å‘å¸ƒä¸è®¢é˜…å³æ‰€è°“çš„é…ç½®ç®¡ç†ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯å°†æ•°æ®å‘å¸ƒåˆ° ZooKeeper èŠ‚ç‚¹ä¸Šï¼Œä¾›è®¢é˜…è€…åŠ¨æ€è·å–æ•°æ®ï¼Œå®ç°é…ç½®ä¿¡æ¯çš„é›†ä¸­å¼ç®¡ç†å’ŒåŠ¨æ€æ›´æ–°ã€‚ä¾‹å¦‚å…¨å±€çš„é…ç½®ä¿¡æ¯ï¼Œåœ°å€åˆ—è¡¨ç­‰å°±éå¸¸é€‚åˆä½¿ç”¨ã€‚</p><p>æ•°æ®å‘å¸ƒ/è®¢é˜…çš„ä¸€ä¸ªå¸¸è§çš„åœºæ™¯æ˜¯é…ç½®ä¸­å¿ƒï¼Œå‘å¸ƒè€…æŠŠæ•°æ®å‘å¸ƒåˆ° ZooKeeper çš„ä¸€ä¸ªæˆ–ä¸€ç³»åˆ—çš„èŠ‚ç‚¹ä¸Šï¼Œä¾›è®¢é˜…è€…è¿›è¡Œæ•°æ®è®¢é˜…ï¼Œè¾¾åˆ°åŠ¨æ€è·å–æ•°æ®çš„ç›®çš„ã€‚</p><p>é…ç½®ä¿¡æ¯ä¸€èˆ¬æœ‰å‡ ä¸ªç‰¹ç‚¹:</p><ol><li>æ•°æ®é‡å°çš„ KV</li><li>æ•°æ®å†…å®¹åœ¨è¿è¡Œæ—¶ä¼šå‘ç”ŸåŠ¨æ€å˜åŒ–</li><li>é›†ç¾¤æœºå™¨å…±äº«ï¼Œé…ç½®ä¸€è‡´</li></ol><p>ZooKeeper é‡‡ç”¨çš„æ˜¯æ¨æ‹‰ç»“åˆçš„æ–¹å¼ã€‚</p><ol><li>æ¨: æœåŠ¡ç«¯ä¼šæ¨ç»™æ³¨å†Œäº†ç›‘æ§èŠ‚ç‚¹çš„å®¢æˆ·ç«¯ Wathcer äº‹ä»¶é€šçŸ¥</li><li>æ‹‰: å®¢æˆ·ç«¯è·å¾—é€šçŸ¥åï¼Œç„¶åä¸»åŠ¨åˆ°æœåŠ¡ç«¯æ‹‰å–æœ€æ–°çš„æ•°æ®</li></ol></li><li><p><strong>å‘½åæœåŠ¡</strong></p><p>ä½œä¸ºåˆ†å¸ƒå¼å‘½åæœåŠ¡ï¼Œå‘½åæœåŠ¡æ˜¯æŒ‡é€šè¿‡æŒ‡å®šçš„åå­—æ¥è·å–èµ„æºæˆ–è€…æœåŠ¡çš„åœ°å€ï¼Œåˆ©ç”¨ ZooKeeper åˆ›å»ºä¸€ä¸ªå…¨å±€çš„è·¯å¾„ï¼Œè¿™ä¸ªè·¯å¾„å°±å¯ä»¥ä½œä¸ºä¸€ä¸ªåå­—ï¼ŒæŒ‡å‘é›†ç¾¤ä¸­çš„é›†ç¾¤ï¼Œæä¾›çš„æœåŠ¡çš„åœ°å€ï¼Œæˆ–è€…ä¸€ä¸ªè¿œç¨‹çš„å¯¹è±¡ç­‰ç­‰ã€‚</p><p>ç»Ÿä¸€å‘½åæœåŠ¡çš„å‘½åç»“æ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><ol><li><p>åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œç»å¸¸éœ€è¦å¯¹åº”ç”¨/æœåŠ¡è¿›è¡Œç»Ÿä¸€å‘½åï¼Œä¾¿äºè¯†åˆ«ä¸åŒæœåŠ¡ã€‚</p><p>ç±»ä¼¼äºåŸŸåä¸ IP ä¹‹é—´å¯¹åº”å…³ç³»ï¼ŒIP ä¸å®¹æ˜“è®°ä½ï¼Œè€ŒåŸŸåå®¹æ˜“è®°ä½ã€‚</p><p>é€šè¿‡åç§°æ¥è·å–èµ„æºæˆ–æœåŠ¡çš„åœ°å€ï¼Œæä¾›è€…ç­‰ä¿¡æ¯ã€‚</p></li><li><p>æŒ‰ç…§å±‚æ¬¡ç»“æ„ç»„ç»‡æœåŠ¡/åº”ç”¨åç§°ã€‚ å¯å°†æœåŠ¡åç§°ä»¥åŠåœ°å€ä¿¡æ¯å†™åˆ° ZooKeeper ä¸Šï¼Œå®¢æˆ·ç«¯é€šè¿‡ ZooKeeper è·å–å¯ç”¨æœåŠ¡åˆ—è¡¨ç±»ã€‚</p></li></ol></li><li><p><strong>é…ç½®ç®¡ç†</strong></p><p>ç¨‹åºåˆ†å¸ƒå¼çš„éƒ¨ç½²åœ¨ä¸åŒçš„æœºå™¨ä¸Šï¼Œå°†ç¨‹åºçš„é…ç½®ä¿¡æ¯æ”¾åœ¨ ZooKeeper çš„ znode ä¸‹ï¼Œå½“æœ‰é…ç½®å‘ç”Ÿæ”¹å˜æ—¶ï¼Œä¹Ÿå°±æ˜¯ znode å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¯ä»¥é€šè¿‡æ”¹å˜ zk ä¸­æŸä¸ªç›®å½•èŠ‚ç‚¹çš„å†…å®¹ï¼Œåˆ©ç”¨ watch é€šçŸ¥ç»™å„ä¸ªå®¢æˆ·ç«¯ä»è€Œæ›´æ”¹é…ç½®ã€‚</p><p>ZooKeeper é…ç½®ç®¡ç†ç»“æ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><ol><li><p>åˆ†å¸ƒå¼ç¯å¢ƒä¸‹ï¼Œé…ç½®æ–‡ä»¶ç®¡ç†å’ŒåŒæ­¥æ˜¯ä¸€ä¸ªå¸¸è§é—®é¢˜ã€‚</p><p>ä¸€ä¸ªé›†ç¾¤ä¸­ï¼Œæ‰€æœ‰èŠ‚ç‚¹çš„é…ç½®ä¿¡æ¯æ˜¯ä¸€è‡´çš„ï¼Œæ¯”å¦‚ Hadoop é›†ç¾¤ã€‚</p><p>å¯¹é…ç½®æ–‡ä»¶ä¿®æ”¹åï¼Œå¸Œæœ›èƒ½å¤Ÿå¿«é€ŸåŒæ­¥åˆ°å„ä¸ªèŠ‚ç‚¹ä¸Šã€‚</p></li><li><p>é…ç½®ç®¡ç†å¯äº¤ç”± ZooKeeper å®ç°ã€‚</p><p>å¯å°†é…ç½®ä¿¡æ¯å†™å…¥ ZooKeeper ä¸Šçš„ä¸€ä¸ª Znodeã€‚å„ä¸ªèŠ‚ç‚¹ç›‘å¬è¿™ä¸ª Znodeã€‚</p><p>ä¸€æ—¦ Znode ä¸­çš„æ•°æ®è¢«ä¿®æ”¹ï¼ŒZooKeeper å°†é€šçŸ¥å„ä¸ªèŠ‚ç‚¹ã€‚</p></li></ol></li><li><p><strong>é›†ç¾¤ç®¡ç†</strong></p><p>æ‰€è°“é›†ç¾¤ç®¡ç†å°±æ˜¯ï¼šæ˜¯å¦æœ‰æœºå™¨é€€å‡ºå’ŒåŠ å…¥ã€é€‰ä¸¾ masterã€‚</p><p>é›†ç¾¤ç®¡ç†ä¸»è¦æŒ‡é›†ç¾¤ç›‘æ§å’Œé›†ç¾¤æ§åˆ¶ä¸¤ä¸ªæ–¹é¢ã€‚å‰è€…ä¾§é‡äºé›†ç¾¤è¿è¡Œæ—¶çš„çŠ¶æ€çš„æ”¶é›†ï¼Œåè€…åˆ™æ˜¯å¯¹é›†ç¾¤è¿›è¡Œæ“ä½œä¸æ§åˆ¶ã€‚å¼€å‘å’Œè¿ç»´ä¸­ï¼Œé¢å¯¹é›†ç¾¤ï¼Œç»å¸¸æœ‰å¦‚ä¸‹éœ€æ±‚:</p><ol><li>å¸Œæœ›çŸ¥é“é›†ç¾¤ä¸­ç©¶ç«Ÿæœ‰å¤šå°‘æœºå™¨åœ¨å·¥ä½œ</li><li>å¯¹é›†ç¾¤ä¸­çš„æ¯å°æœºå™¨çš„è¿è¡Œæ—¶çŠ¶æ€è¿›è¡Œæ•°æ®æ”¶é›†</li><li>å¯¹é›†ç¾¤ä¸­æœºå™¨è¿›è¡Œä¸Šä¸‹çº¿çš„æ“ä½œ</li></ol><p>é›†ç¾¤ç®¡ç†ç»“æ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><ol><li><p>åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œå®æ—¶æŒæ¡æ¯ä¸ªèŠ‚ç‚¹çš„çŠ¶æ€æ˜¯å¿…è¦çš„ï¼Œå¯æ ¹æ®èŠ‚ç‚¹å®æ—¶çŠ¶æ€åšå‡ºä¸€äº›è°ƒæ•´ã€‚</p></li><li><p>å¯äº¤ç”± ZooKeeper å®ç°ã€‚</p><p>å¯å°†èŠ‚ç‚¹ä¿¡æ¯å†™å…¥ ZooKeeper ä¸Šçš„ä¸€ä¸ª Znodeã€‚</p><p>ç›‘å¬è¿™ä¸ª Znode å¯è·å–å®ƒçš„å®æ—¶çŠ¶æ€å˜åŒ–ã€‚</p></li><li><p>å…¸å‹åº”ç”¨: Hbase ä¸­ Master çŠ¶æ€ç›‘æ§ä¸é€‰ä¸¾ã€‚</p></li></ol><p>åˆ©ç”¨ ZooKeeper çš„å¼ºä¸€è‡´æ€§ï¼Œèƒ½å¤Ÿä¿è¯åœ¨åˆ†å¸ƒå¼é«˜å¹¶å‘æƒ…å†µä¸‹èŠ‚ç‚¹åˆ›å»ºçš„å…¨å±€å”¯ä¸€æ€§ï¼Œå³ï¼šåŒæ—¶æœ‰å¤šä¸ªå®¢æˆ·ç«¯è¯·æ±‚åˆ›å»º /currentMaster èŠ‚ç‚¹ï¼Œæœ€ç»ˆä¸€å®šåªæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯è¯·æ±‚èƒ½å¤Ÿåˆ›å»ºæˆåŠŸ</p></li><li><p><strong>åˆ†å¸ƒå¼é€šçŸ¥ä¸åè°ƒ</strong></p><ol><li><p>åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œç»å¸¸å­˜åœ¨ä¸€ä¸ªæœåŠ¡éœ€è¦çŸ¥é“å®ƒæ‰€ç®¡ç†çš„å­æœåŠ¡çš„çŠ¶æ€ã€‚</p><p>NameNode éœ€çŸ¥é“å„ä¸ª Datanode çš„çŠ¶æ€ã€‚</p><p>JobTracker éœ€çŸ¥é“å„ä¸ª TaskTracker çš„çŠ¶æ€ã€‚</p></li><li><p>å¿ƒè·³æ£€æµ‹æœºåˆ¶å¯é€šè¿‡ ZooKeeper æ¥å®ç°ã€‚</p></li><li><p>ä¿¡æ¯æ¨é€å¯ç”± ZooKeeper æ¥å®ç°ï¼ŒZooKeeper ç›¸å½“äºä¸€ä¸ªå‘å¸ƒ/è®¢é˜…ç³»ç»Ÿã€‚</p></li></ol></li><li><p><strong>åˆ†å¸ƒå¼é”</strong></p><p>å¤„äºä¸åŒèŠ‚ç‚¹ä¸Šä¸åŒçš„æœåŠ¡ï¼Œå®ƒä»¬å¯èƒ½éœ€è¦é¡ºåºçš„è®¿é—®ä¸€äº›èµ„æºï¼Œè¿™é‡Œéœ€è¦ä¸€æŠŠåˆ†å¸ƒå¼çš„é”ã€‚åˆ†å¸ƒå¼é”å…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼šå†™é”ã€è¯»é”ã€æ—¶åºé”ã€‚</p><ul><li>å†™é”ï¼šåœ¨ zk ä¸Šåˆ›å»ºçš„ä¸€ä¸ªä¸´æ—¶çš„æ— ç¼–å·çš„èŠ‚ç‚¹ã€‚ç”±äºæ˜¯æ— åºç¼–å·ï¼Œåœ¨åˆ›å»ºæ—¶ä¸ä¼šè‡ªåŠ¨ç¼–å·ï¼Œå¯¼è‡´åªèƒ½å®¢æˆ·ç«¯æœ‰ä¸€ä¸ªå®¢æˆ·ç«¯å¾—åˆ°é”ï¼Œç„¶åè¿›è¡Œå†™å…¥ã€‚</li><li>è¯»é”ï¼šåœ¨ zk ä¸Šåˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„æœ‰ç¼–å·çš„èŠ‚ç‚¹ï¼Œè¿™æ ·å³ä½¿ä¸‹æ¬¡æœ‰å®¢æˆ·ç«¯åŠ å…¥æ˜¯åŒæ—¶åˆ›å»ºç›¸åŒçš„èŠ‚ç‚¹æ—¶ï¼Œä»–ä¹Ÿä¼šè‡ªåŠ¨ç¼–å·ï¼Œä¹Ÿå¯ä»¥è·å¾—é”å¯¹è±¡ï¼Œç„¶åå¯¹å…¶è¿›è¡Œè¯»å–ã€‚</li></ul></li><li><p>æ—¶åºé”ï¼šåœ¨ zk ä¸Šåˆ›å»ºçš„ä¸€ä¸ªä¸´æ—¶çš„æœ‰ç¼–å·çš„èŠ‚ç‚¹æ ¹æ®ç¼–å·çš„å¤§å°æ§åˆ¶é”ã€‚</p></li></ul><p><strong>åˆ†å¸ƒå¼é˜Ÿåˆ—</strong></p><p>åˆ†å¸ƒå¼é˜Ÿåˆ—åˆ†ä¸ºä¸¤ç§ï¼š</p><ol><li><p>å½“ä¸€ä¸ªé˜Ÿåˆ—çš„æˆå‘˜éƒ½èšé½æ—¶ï¼Œè¿™ä¸ªé˜Ÿåˆ—æ‰å¯ç”¨ï¼Œå¦åˆ™ä¸€ç›´ç­‰å¾…æ‰€æœ‰æˆå‘˜åˆ°è¾¾ï¼Œè¿™ç§æ˜¯åŒæ­¥é˜Ÿåˆ—ã€‚</p><p>ä¸€ä¸ª job ç”±å¤šä¸ª task ç»„æˆï¼Œåªæœ‰æ‰€æœ‰ä»»åŠ¡å®Œæˆåï¼Œjob æ‰è¿è¡Œå®Œæˆã€‚</p><p>å¯ä¸º job åˆ›å»ºä¸€ä¸ª/job ç›®å½•ï¼Œç„¶ååœ¨è¯¥ç›®å½•ä¸‹ï¼Œä¸ºæ¯ä¸ªå®Œæˆçš„ task åˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„ Znodeï¼Œä¸€æ—¦ä¸´æ—¶èŠ‚ç‚¹æ•°ç›®è¾¾åˆ° task æ€»æ•°ï¼Œåˆ™è¡¨æ˜ job è¿è¡Œå®Œæˆã€‚</p></li><li><p>é˜Ÿåˆ—æŒ‰ç…§ FIFO æ–¹å¼è¿›è¡Œå…¥é˜Ÿå’Œå‡ºé˜Ÿæ“ä½œï¼Œä¾‹å¦‚å®ç°ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…æ¨¡å‹ã€‚</p></li></ol><h2 id="_3ã€è¯´è¯´zookeeperçš„å·¥ä½œåŸç†" tabindex="-1"><a class="header-anchor" href="#_3ã€è¯´è¯´zookeeperçš„å·¥ä½œåŸç†" aria-hidden="true">#</a> 3ã€è¯´è¯´Zookeeperçš„å·¥ä½œåŸç†ï¼Ÿ</h2><p>Zookeeper çš„æ ¸å¿ƒæ˜¯åŸå­å¹¿æ’­ï¼Œè¿™ä¸ªæœºåˆ¶ä¿è¯äº†å„ä¸ª Server ä¹‹é—´çš„åŒæ­¥ã€‚å®ç°è¿™ä¸ªæœºåˆ¶çš„åè®®å«åš Zab åè®®ã€‚</p><p>Zab åè®®æœ‰ä¸¤ç§æ¨¡å¼ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯æ¢å¤æ¨¡å¼ï¼ˆé€‰ä¸»ï¼‰å’Œå¹¿æ’­æ¨¡å¼ï¼ˆåŒæ­¥ï¼‰ã€‚</p><p>Zab åè®®çš„å…¨ç§°æ˜¯ Zookeeper Atomic Broadcast (Zookeeper åŸå­å¹¿æ’­)ã€‚Zookeeper æ˜¯é€šè¿‡ Zab åè®®æ¥ä¿è¯åˆ†å¸ƒå¼äº‹åŠ¡çš„æœ€ç»ˆä¸€è‡´æ€§ã€‚Zab åè®®è¦æ±‚æ¯ä¸ª Leader éƒ½è¦ç»å†ä¸‰ä¸ªé˜¶æ®µï¼šå‘ç°ï¼ŒåŒæ­¥ï¼Œå¹¿æ’­ã€‚</p><p>å½“æœåŠ¡å¯åŠ¨æˆ–è€…åœ¨é¢†å¯¼è€…å´©æºƒåï¼ŒZab å°±è¿›å…¥äº†æ¢å¤æ¨¡å¼ï¼Œå½“é¢†å¯¼è€…è¢«é€‰ä¸¾å‡ºæ¥ï¼Œä¸”å¤§å¤šæ•° Server å®Œæˆäº†å’Œ leader çš„çŠ¶æ€åŒæ­¥ä»¥åï¼Œæ¢å¤æ¨¡å¼å°±ç»“æŸäº†ã€‚çŠ¶æ€åŒæ­¥ä¿è¯äº† leader å’Œ Server å…·æœ‰ç›¸åŒçš„ç³»ç»ŸçŠ¶æ€ã€‚</p><p>ä¸ºäº†ä¿è¯äº‹åŠ¡çš„é¡ºåºä¸€è‡´æ€§ï¼Œzookeeper é‡‡ç”¨äº†é€’å¢çš„äº‹åŠ¡ id å·ï¼ˆzxidï¼‰æ¥æ ‡è¯†äº‹åŠ¡ã€‚æ‰€æœ‰çš„æè®® (proposal) éƒ½åœ¨è¢«æå‡ºçš„æ—¶å€™åŠ ä¸Šäº† zxidã€‚å®ç°ä¸­ zxid æ˜¯ä¸€ä¸ª 64 ä½çš„æ•°å­—ï¼Œå®ƒé«˜ 32 ä½æ˜¯ epoch ç”¨æ¥æ ‡è¯† leader å…³ç³»æ˜¯å¦æ”¹å˜ï¼Œæ¯æ¬¡ä¸€ä¸ª leader è¢«é€‰å‡ºæ¥ï¼Œå®ƒéƒ½ä¼šæœ‰ä¸€ä¸ªæ–°çš„ epochï¼Œæ ‡è¯†å½“å‰å±äºé‚£ä¸ª leader çš„ç»Ÿæ²»æ—¶æœŸã€‚ä½ 32 ä½ç”¨äºé€’å¢è®¡æ•°ã€‚</p><p>epochï¼šå¯ä»¥ç†è§£ä¸ºçš‡å¸çš„å¹´å·ï¼Œå½“æ–°çš„çš‡å¸ leader äº§ç”Ÿåï¼Œå°†æœ‰ä¸€ä¸ªæ–°çš„ epoch å¹´å·ã€‚</p><p>æ¯ä¸ª Server åœ¨å·¥ä½œè¿‡ç¨‹ä¸­æœ‰ä¸‰ç§çŠ¶æ€ï¼š</p><ul><li>LOOKINGï¼šå½“å‰ Server ä¸çŸ¥é“ leader æ˜¯è°ï¼Œæ­£åœ¨æœå¯»ã€‚</li><li>LEADINGï¼šå½“å‰ Server å³ä¸ºé€‰ä¸¾å‡ºæ¥çš„ leaderã€‚</li><li>FOLLOWINGï¼šleader å·²ç»é€‰ä¸¾å‡ºæ¥ï¼Œå½“å‰ Server ä¸ä¹‹åŒæ­¥ã€‚</li></ul><h2 id="_4-è¯·æè¿°ä¸€ä¸‹-zookeeper-çš„é€šçŸ¥æœºåˆ¶æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#_4-è¯·æè¿°ä¸€ä¸‹-zookeeper-çš„é€šçŸ¥æœºåˆ¶æ˜¯ä»€ä¹ˆ" aria-hidden="true">#</a> 4ï¼Œè¯·æè¿°ä¸€ä¸‹ Zookeeper çš„é€šçŸ¥æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>Zookeeperå…è®¸å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯çš„æŸä¸ª znode æ³¨å†Œä¸€ä¸ª Watcher ç›‘å¬ï¼Œå½“æœåŠ¡ç«¯çš„ä¸€äº›æŒ‡å®šäº‹ä»¶è§¦å‘äº†è¿™ä¸ª Watcher ï¼ŒæœåŠ¡ç«¯ä¼šå‘æŒ‡å®šå®¢æˆ·ç«¯å‘é€ä¸€ä¸ªäº‹ä»¶é€šçŸ¥æ¥å®ç°åˆ†å¸ƒå¼çš„é€šçŸ¥åŠŸèƒ½ï¼Œç„¶åå®¢æˆ·ç«¯æ ¹æ® Watcher é€šçŸ¥çŠ¶æ€å’Œäº‹ä»¶ç±»å‹åšå‡ºä¸šåŠ¡ä¸Šçš„æ”¹å˜ã€‚</p><p>å¤§è‡´åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼š</p><ul><li><p>å®¢æˆ·ç«¯æ³¨å†Œ Watcher</p><ol><li>è°ƒç”¨ getDataã€getChildrenã€exist ä¸‰ä¸ª API ï¼Œä¼ å…¥ Watcher å¯¹è±¡ã€‚</li><li>æ ‡è®°è¯·æ±‚ request ï¼Œå°è£… Watcher åˆ° WatchRegistration ã€‚</li><li>å°è£…æˆ Packet å¯¹è±¡ï¼Œå‘æœåŠ¡ç«¯å‘é€ request ã€‚</li><li>æ”¶åˆ°æœåŠ¡ç«¯å“åº”åï¼Œå°† Watcher æ³¨å†Œåˆ° ZKWatcherManager ä¸­è¿›è¡Œç®¡ç†ã€‚</li><li>è¯·æ±‚è¿”å›ï¼Œå®Œæˆæ³¨å†Œã€‚</li></ol></li><li><p>æœåŠ¡ç«¯å¤„ç† Watcher</p><ol><li>æœåŠ¡ç«¯æ¥æ”¶ Watcher å¹¶å­˜å‚¨ ã€‚</li><li>Watcher è§¦å‘</li><li>è°ƒç”¨ process æ–¹æ³•æ¥è§¦å‘ Watcher ã€‚</li></ol></li><li><p>å®¢æˆ·ç«¯å›è°ƒ Watcher</p><ol><li>å®¢æˆ·ç«¯ SendThread çº¿ç¨‹æ¥æ”¶äº‹ä»¶é€šçŸ¥ï¼Œäº¤ç”± EventThread çº¿ç¨‹å›è°ƒ Watcher ã€‚</li><li>å®¢æˆ·ç«¯çš„ Watcher æœºåˆ¶åŒæ ·æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œä¸€æ—¦è¢«è§¦å‘åï¼Œè¯¥ Watcher å°±å¤±æ•ˆäº†ã€‚</li></ol><p>client ç«¯ä¼šå¯¹æŸä¸ª znode å»ºç«‹ä¸€ä¸ª watcher äº‹ä»¶ï¼Œå½“è¯¥ znode å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè¿™äº› client ä¼šæ”¶åˆ° zk çš„é€šçŸ¥ï¼Œç„¶å client å¯ä»¥æ ¹æ® znode å˜åŒ–æ¥åšå‡ºä¸šåŠ¡ä¸Šçš„æ”¹å˜ç­‰ã€‚</p></li></ul><h2 id="_5ã€zookeeper-å¯¹èŠ‚ç‚¹çš„-watch-ç›‘å¬é€šçŸ¥æ˜¯æ°¸ä¹…çš„å—" tabindex="-1"><a class="header-anchor" href="#_5ã€zookeeper-å¯¹èŠ‚ç‚¹çš„-watch-ç›‘å¬é€šçŸ¥æ˜¯æ°¸ä¹…çš„å—" aria-hidden="true">#</a> 5ã€Zookeeper å¯¹èŠ‚ç‚¹çš„ watch ç›‘å¬é€šçŸ¥æ˜¯æ°¸ä¹…çš„å—ï¼Ÿ</h2><p>ä¸æ˜¯ï¼Œä¸€æ¬¡æ€§çš„ã€‚æ— è®ºæ˜¯æœåŠ¡ç«¯è¿˜æ˜¯å®¢æˆ·ç«¯ï¼Œä¸€æ—¦ä¸€ä¸ª Watcher è¢«è§¦å‘, Zookeeperéƒ½ä¼šå°†å…¶ä»ç›¸åº”çš„å­˜å‚¨ä¸­ç§»é™¤ã€‚è¿™æ ·çš„è®¾è®¡æœ‰æ•ˆçš„å‡è½»äº†æœåŠ¡ç«¯çš„å‹åŠ›ï¼Œä¸ç„¶å¯¹äºæ›´æ–°éå¸¸é¢‘ç¹çš„èŠ‚ç‚¹ï¼ŒæœåŠ¡ç«¯ä¼šä¸æ–­çš„å‘å®¢æˆ·ç«¯å‘é€äº‹ä»¶é€šçŸ¥ï¼Œæ— è®ºå¯¹äºç½‘ç»œè¿˜æ˜¯æœåŠ¡ç«¯çš„å‹åŠ›éƒ½éå¸¸å¤§ã€‚</p><h2 id="_6ã€zookeeper-é›†ç¾¤ä¸­æœ‰å“ªäº›è§’è‰²" tabindex="-1"><a class="header-anchor" href="#_6ã€zookeeper-é›†ç¾¤ä¸­æœ‰å“ªäº›è§’è‰²" aria-hidden="true">#</a> 6ã€Zookeeper é›†ç¾¤ä¸­æœ‰å“ªäº›è§’è‰²ï¼Ÿ</h2><p>åœ¨ä¸€ä¸ªé›†ç¾¤ä¸­ï¼Œæœ€å°‘éœ€è¦ 3 å°ã€‚æˆ–è€…ä¿è¯ 2N + 1 å°ï¼Œå³å¥‡æ•°ã€‚ä¸ºä»€ä¹ˆä¿è¯å¥‡æ•°ï¼Ÿä¸»è¦æ˜¯ä¸ºäº†é€‰ä¸¾ç®—æ³•ã€‚</p><h2 id="_7ã€zookeeper-é›†ç¾¤ä¸­-server-æœ‰å“ªäº›å·¥ä½œçŠ¶æ€" tabindex="-1"><a class="header-anchor" href="#_7ã€zookeeper-é›†ç¾¤ä¸­-server-æœ‰å“ªäº›å·¥ä½œçŠ¶æ€" aria-hidden="true">#</a> 7ã€Zookeeper é›†ç¾¤ä¸­ Server æœ‰å“ªäº›å·¥ä½œçŠ¶æ€ï¼Ÿ</h2><ul><li><p><strong>LOOKING</strong></p><p>å¯»æ‰¾ Leader çŠ¶æ€ï¼›å½“æœåŠ¡å™¨å¤„äºè¯¥çŠ¶æ€æ—¶ï¼Œå®ƒä¼šè®¤ä¸ºå½“å‰é›†ç¾¤ä¸­æ²¡æœ‰ Leader ï¼Œå› æ­¤éœ€è¦è¿›å…¥ Leader é€‰ä¸¾çŠ¶æ€</p></li><li><p><strong>FOLLOWING</strong></p><p>è·Ÿéšè€…çŠ¶æ€ï¼›è¡¨æ˜å½“å‰æœåŠ¡å™¨è§’è‰²æ˜¯ Follower</p></li><li><p><strong>LEADING</strong> é¢†å¯¼è€…çŠ¶æ€ï¼›è¡¨æ˜å½“å‰æœåŠ¡å™¨è§’è‰²æ˜¯ Leader</p></li><li><p><strong>OBSERVING</strong> è§‚å¯Ÿè€…çŠ¶æ€ï¼›è¡¨æ˜å½“å‰æœåŠ¡å™¨è§’è‰²æ˜¯ Observer</p></li></ul><h2 id="_8ã€zookeeper-é›†ç¾¤ä¸­æ˜¯æ€æ ·é€‰ä¸¾-leader-çš„" tabindex="-1"><a class="header-anchor" href="#_8ã€zookeeper-é›†ç¾¤ä¸­æ˜¯æ€æ ·é€‰ä¸¾-leader-çš„" aria-hidden="true">#</a> 8ã€Zookeeper é›†ç¾¤ä¸­æ˜¯æ€æ ·é€‰ä¸¾ leader çš„ï¼Ÿ</h2><p>å½“ Leader å´©æºƒäº†ï¼Œæˆ–è€…å¤±å»äº†å¤§å¤šæ•°çš„ Followerï¼Œè¿™æ—¶å€™ Zookeeper å°±è¿›å…¥æ¢å¤æ¨¡å¼ï¼Œæ¢å¤æ¨¡å¼éœ€è¦é‡æ–°é€‰ä¸¾å‡ºä¸€ä¸ªæ–°çš„ Leaderï¼Œè®©æ‰€æœ‰çš„ Server éƒ½æ¢å¤åˆ°ä¸€ä¸ªçŠ¶æ€<strong>LOOKING</strong> ã€‚</p><p>Zookeeper æœ‰ä¸¤ç§é€‰ä¸¾ç®—æ³•ï¼šåŸºäº basic paxos å®ç°å’ŒåŸºäº fast paxos å®ç°ã€‚é»˜è®¤ä¸º fast paxos ç”±äºç¯‡å¹…é—®é¢˜ï¼Œè¿™é‡Œæ¨èï¼š<a href="https://www.cnblogs.com/leesf456/p/6107600.html" target="_blank" rel="noopener noreferrer">é€‰ä¸¾æµç¨‹<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="_9ã€zookeeper-æ˜¯å¦‚ä½•ä¿è¯äº‹åŠ¡çš„é¡ºåºä¸€è‡´æ€§çš„å‘¢" tabindex="-1"><a class="header-anchor" href="#_9ã€zookeeper-æ˜¯å¦‚ä½•ä¿è¯äº‹åŠ¡çš„é¡ºåºä¸€è‡´æ€§çš„å‘¢" aria-hidden="true">#</a> 9ã€Zookeeper æ˜¯å¦‚ä½•ä¿è¯äº‹åŠ¡çš„é¡ºåºä¸€è‡´æ€§çš„å‘¢ï¼Ÿ</h2><p>Zookeeper é‡‡ç”¨äº†é€’å¢çš„äº‹åŠ¡ id æ¥è¯†åˆ«ï¼Œæ‰€æœ‰çš„ proposal (æè®®)éƒ½åœ¨è¢«æå‡ºçš„æ—¶å€™åŠ ä¸Šäº†zxid ã€‚ zxid å®é™…ä¸Šæ˜¯ä¸€ä¸ª 64 ä½æ•°å­—ã€‚</p><p>é«˜ 32 ä½æ˜¯ epoch ç”¨æ¥æ ‡è¯† Leader æ˜¯å¦å‘ç”Ÿäº†æ”¹å˜ï¼Œå¦‚æœæœ‰æ–°çš„ Leader äº§ç”Ÿå‡ºæ¥, epoch ä¼šè‡ªå¢ã€‚ ä½ 32 ä½ç”¨æ¥é€’å¢è®¡æ•°ã€‚ å½“æ–°äº§ç”Ÿçš„proposalçš„æ—¶å€™ï¼Œä¼šä¾æ®æ•°æ®åº“çš„ä¸¤é˜¶æ®µè¿‡ç¨‹ï¼Œé¦–å…ˆä¼šå‘å…¶ä»–çš„ Server å‘å‡ºäº‹åŠ¡æ‰§è¡Œè¯·æ±‚ï¼Œå¦‚æœè¶…è¿‡åŠæ•°çš„æœºå™¨éƒ½èƒ½æ‰§è¡Œå¹¶ä¸”èƒ½å¤ŸæˆåŠŸï¼Œé‚£ä¹ˆå°±ä¼šå¼€å§‹æ‰§è¡Œã€‚</p><h2 id="_10ã€zookeeper-é›†ç¾¤ä¸­ä¸ªæœåŠ¡å™¨ä¹‹é—´æ˜¯æ€æ ·é€šä¿¡çš„" tabindex="-1"><a class="header-anchor" href="#_10ã€zookeeper-é›†ç¾¤ä¸­ä¸ªæœåŠ¡å™¨ä¹‹é—´æ˜¯æ€æ ·é€šä¿¡çš„" aria-hidden="true">#</a> 10ã€ZooKeeper é›†ç¾¤ä¸­ä¸ªæœåŠ¡å™¨ä¹‹é—´æ˜¯æ€æ ·é€šä¿¡çš„ï¼Ÿ</h2><p>Leader æœåŠ¡å™¨ä¼šå’Œæ¯ä¸€ä¸ª Follower/Observer æœåŠ¡å™¨éƒ½å»ºç«‹ TCP è¿æ¥ï¼ŒåŒæ—¶ä¸ºæ¯ä¸ªFollower/Observer éƒ½åˆ›å»ºä¸€ä¸ªå«åš LearnerHandler çš„å®ä½“ã€‚</p><ul><li><p>LearnerHandler ä¸»è¦è´Ÿè´£ Leader å’Œ Follower/Observer ä¹‹é—´çš„ç½‘ç»œé€šè®¯ï¼ŒåŒ…æ‹¬æ•°æ®åŒæ­¥ï¼Œè¯·æ±‚è½¬å‘å’Œ proposal æè®®çš„æŠ•ç¥¨ç­‰ã€‚</p></li><li><p>Leader æœåŠ¡å™¨ä¿å­˜äº†æ‰€æœ‰ Follower/Observer çš„ LearnerHandler ã€‚</p></li></ul><h2 id="_11ã€zookeeper-åˆ†å¸ƒå¼é”æ€ä¹ˆå®ç°çš„" tabindex="-1"><a class="header-anchor" href="#_11ã€zookeeper-åˆ†å¸ƒå¼é”æ€ä¹ˆå®ç°çš„" aria-hidden="true">#</a> 11ã€ZooKeeper åˆ†å¸ƒå¼é”æ€ä¹ˆå®ç°çš„ï¼Ÿ</h2><p>å¦‚æœæœ‰å®¢æˆ·ç«¯ 1ã€å®¢æˆ·ç«¯ 2 ç­‰ N ä¸ªå®¢æˆ·ç«¯äº‰æŠ¢ä¸€ä¸ªZookeeperåˆ†å¸ƒå¼é”ã€‚å¤§è‡´å¦‚ä¸‹ï¼š</p><ol><li><p>å¤§å®¶éƒ½æ˜¯ä¸Šæ¥ç›´æ¥åˆ›å»ºä¸€ä¸ªé”èŠ‚ç‚¹ä¸‹çš„ä¸€ä¸ªæ¥ä¸€ä¸ªçš„ä¸´æ—¶æœ‰åºèŠ‚ç‚¹</p></li><li><p>å¦‚æœè‡ªå·±ä¸æ˜¯ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°±å¯¹è‡ªå·±ä¸Šä¸€ä¸ªèŠ‚ç‚¹åŠ ç›‘å¬å™¨</p></li><li><p>åªè¦ä¸Šä¸€ä¸ªèŠ‚ç‚¹é‡Šæ”¾é”ï¼Œè‡ªå·±å°±æ’åˆ°å‰é¢å»äº†ï¼Œç›¸å½“äºæ˜¯ä¸€ä¸ªæ’é˜Ÿæœºåˆ¶ã€‚</p></li></ol><p>è€Œä¸”ç”¨ä¸´æ—¶é¡ºåºèŠ‚ç‚¹çš„å¦å¤–ä¸€ä¸ªç”¨æ„å°±æ˜¯ï¼Œå¦‚æœæŸä¸ªå®¢æˆ·ç«¯åˆ›å»ºä¸´æ—¶é¡ºåºèŠ‚ç‚¹ä¹‹åï¼Œä¸å°å¿ƒè‡ªå·±å®•æœºäº†ä¹Ÿæ²¡å…³ç³», Zookeeperæ„ŸçŸ¥åˆ°é‚£ä¸ªå®¢æˆ·ç«¯å®•æœºï¼Œä¼šè‡ªåŠ¨åˆ é™¤å¯¹åº”çš„ä¸´æ—¶é¡ºåºèŠ‚ç‚¹ï¼Œç›¸å½“äºè‡ªåŠ¨é‡Šæ”¾é”ï¼Œæˆ–è€…æ˜¯è‡ªåŠ¨å–æ¶ˆè‡ªå·±çš„æ’é˜Ÿã€‚</p><p>æœ¬åœ°é”ï¼Œå¯ä»¥ç”¨ JDK å®ç°ï¼Œä½†æ˜¯åˆ†å¸ƒå¼é”å°±å¿…é¡»è¦ç”¨åˆ°åˆ†å¸ƒå¼çš„ç»„ä»¶ã€‚æ¯”å¦‚ ZooKeeperã€Redisã€‚ç½‘ä¸Šä»£ç ä¸€å¤§æ®µï¼Œé¢è¯•ä¸€èˆ¬ä¹Ÿä¸è¦å†™ï¼Œæˆ‘è¿™è¯´ä¸€äº›å…³é”®ç‚¹ã€‚</p><p>å‡ ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹å¦‚ä¸‹ã€‚</p><ul><li>æ­»é”é—®é¢˜ï¼šé”ä¸èƒ½å› ä¸ºæ„å¤–å°±å˜æˆæ­»é”ï¼Œæ‰€ä»¥è¦ç”¨ ZK çš„ä¸´æ—¶èŠ‚ç‚¹ï¼Œå®¢æˆ·ç«¯è¿æ¥å¤±æ•ˆäº†ï¼Œé”å°±è‡ªåŠ¨é‡Šæ”¾äº†ã€‚</li><li>é”ç­‰å¾…é—®é¢˜ï¼šé”æœ‰æ’é˜Ÿçš„éœ€æ±‚ï¼Œæ‰€ä»¥è¦ ZK çš„é¡ºåºèŠ‚ç‚¹ã€‚</li><li>é”ç®¡ç†é—®é¢˜ï¼šä¸€ä¸ªä½¿ç”¨ä½¿ç”¨é‡Šæ”¾äº†é”ï¼Œéœ€è¦é€šçŸ¥å…¶ä»–ä½¿ç”¨è€…ï¼Œæ‰€ä»¥éœ€è¦ç”¨åˆ°ç›‘å¬ã€‚</li><li>ç›‘å¬çš„ç¾Šç¾¤æ•ˆåº”ï¼šæ¯”å¦‚æœ‰ 1000 ä¸ªé”ç«äº‰è€…ï¼Œé”é‡Šæ”¾äº†ï¼Œ1000 ä¸ªç«äº‰è€…å°±å¾—åˆ°äº†é€šçŸ¥ï¼Œç„¶ååˆ¤æ–­ï¼Œæœ€ç»ˆåºå·æœ€å°çš„é‚£ä¸ªæ‹¿åˆ°äº†é”ã€‚å…¶å®ƒ 999 ä¸ªç«äº‰è€…é‡æ–°æ³¨å†Œç›‘å¬ã€‚è¿™å°±æ˜¯ç¾Šç¾¤æ•ˆåº”ï¼Œå‡ºç‚¹äº‹ï¼Œå°±ä¼šæƒŠåŠ¨æ•´ä¸ªç¾Šç¾¤ã€‚åº”è¯¥æ¯ä¸ªç«äº‰è€…åªç›‘å¬è‡ªå·±å‰é¢çš„é‚£ä¸ªèŠ‚ç‚¹ã€‚æ¯”å¦‚ 2 å·é‡Šæ”¾äº†é”ï¼Œé‚£ä¹ˆåªæœ‰ 3 å·å¾—åˆ°äº†é€šçŸ¥ã€‚</li></ul><h2 id="_12ã€äº†è§£zookeeperçš„ç³»ç»Ÿæ¶æ„å—" tabindex="-1"><a class="header-anchor" href="#_12ã€äº†è§£zookeeperçš„ç³»ç»Ÿæ¶æ„å—" aria-hidden="true">#</a> 12ã€äº†è§£Zookeeperçš„ç³»ç»Ÿæ¶æ„å—ï¼Ÿ</h2><p>ZooKeeper çš„æ¶æ„å›¾ä¸­æˆ‘ä»¬éœ€è¦äº†è§£å’ŒæŒæ¡çš„ä¸»è¦æœ‰ï¼š</p><ol><li>ZooKeeper åˆ†ä¸ºæœåŠ¡å™¨ç«¯ï¼ˆServerï¼‰ å’Œå®¢æˆ·ç«¯ï¼ˆClientï¼‰ï¼Œå®¢æˆ·ç«¯å¯ä»¥è¿æ¥åˆ°æ•´ä¸ªZooKeeper æœåŠ¡çš„ä»»æ„æœåŠ¡å™¨ä¸Šï¼ˆé™¤é leaderServes å‚æ•°è¢«æ˜¾å¼è®¾ç½®, leader ä¸å…è®¸æ¥å—å®¢æˆ·ç«¯è¿æ¥ï¼‰ã€‚</li><li>å®¢æˆ·ç«¯ä½¿ç”¨å¹¶ç»´æŠ¤ä¸€ä¸ª TCP è¿æ¥ï¼Œé€šè¿‡è¿™ä¸ªè¿æ¥å‘é€è¯·æ±‚ã€æ¥å—å“åº”ã€è·å–è§‚å¯Ÿçš„äº‹ä»¶ä»¥åŠå‘é€å¿ƒè·³ã€‚å¦‚æœè¿™ä¸ª TCP è¿æ¥ä¸­æ–­ï¼Œå®¢æˆ·ç«¯å°†è‡ªåŠ¨å°è¯•è¿æ¥åˆ°å¦å¤–çš„ ZooKeeper æœåŠ¡å™¨ã€‚å®¢æˆ·ç«¯ç¬¬ä¸€æ¬¡è¿æ¥åˆ° ZooKeeper æœåŠ¡æ—¶ï¼Œæ¥å—è¿™ä¸ªè¿æ¥çš„ ZooKeeper æœåŠ¡å™¨ä¼šä¸ºè¿™ä¸ªå®¢æˆ·ç«¯å»ºç«‹ä¸€ä¸ªä¼šè¯ã€‚å½“è¿™ä¸ªå®¢æˆ·ç«¯è¿æ¥åˆ°å¦å¤–çš„æœåŠ¡å™¨æ—¶ï¼Œè¿™ä¸ªä¼šè¯ä¼šè¢«æ–°çš„æœåŠ¡å™¨é‡æ–°å»ºç«‹ã€‚</li><li>ä¸Šå›¾ä¸­æ¯ä¸€ä¸ª Server ä»£è¡¨ä¸€ä¸ªå®‰è£… Zookeeper æœåŠ¡çš„æœºå™¨ï¼Œå³æ˜¯æ•´ä¸ªæä¾› Zookeeper æœåŠ¡çš„é›†ç¾¤(æˆ–è€…æ˜¯ç”±ä¼ªé›†ç¾¤ç»„æˆ)</li><li>ç»„æˆ ZooKeeper æœåŠ¡çš„æœåŠ¡å™¨å¿…é¡»å½¼æ­¤äº†è§£ã€‚å®ƒä»¬ç»´æŠ¤ä¸€ä¸ªå†…å­˜ä¸­çš„çŠ¶æ€å›¾åƒï¼Œä»¥åŠæŒä¹…å­˜å‚¨ä¸­çš„äº‹åŠ¡æ—¥å¿—å’Œå¿«ç…§, åªè¦å¤§å¤šæ•°æœåŠ¡å™¨å¯ç”¨ï¼ŒZooKeeper æœåŠ¡å°±å¯ç”¨</li><li>ZooKeeper å¯åŠ¨æ—¶ï¼Œå°†ä»å®ä¾‹ä¸­é€‰ä¸¾ä¸€ä¸ª leaderï¼ŒLeader è´Ÿè´£å¤„ç†æ•°æ®æ›´æ–°ç­‰æ“ä½œï¼Œä¸€ä¸ªæ›´æ–°æ“ä½œæˆåŠŸçš„æ ‡å¿—æ˜¯å½“ä¸”ä»…å½“å¤§å¤šæ•° Server åœ¨å†…å­˜ä¸­æˆåŠŸä¿®æ”¹æ•°æ®ã€‚æ¯ä¸ª Server åœ¨å†…å­˜ä¸­å­˜å‚¨äº†ä¸€ä»½æ•°æ®ã€‚</li><li>Zookeeper æ˜¯å¯ä»¥é›†ç¾¤å¤åˆ¶çš„ï¼Œé›†ç¾¤é—´é€šè¿‡ Zab åè®®ï¼ˆZookeeper Atomic Broadcastï¼‰æ¥ä¿æŒæ•°æ®çš„ä¸€è‡´æ€§ï¼›</li><li>Zab åè®®åŒ…å«ä¸¤ä¸ªé˜¶æ®µï¼šleader election é˜¶æ®µå’Œ Atomic Broadcast é˜¶æ®µã€‚ <ul><li>é›†ç¾¤ä¸­å°†é€‰ä¸¾å‡ºä¸€ä¸ª leaderï¼Œå…¶ä»–çš„æœºå™¨åˆ™ç§°ä¸º followerï¼Œæ‰€æœ‰çš„å†™æ“ä½œéƒ½è¢«ä¼ é€ç»™ leaderï¼Œå¹¶é€šè¿‡ broadcast å°†æ‰€æœ‰çš„æ›´æ–°å‘Šè¯‰ç»™ followerã€‚</li><li>å½“ leader å´©æºƒæˆ–è€… leader å¤±å»å¤§å¤šæ•°çš„ follower æ—¶ï¼Œéœ€è¦é‡æ–°é€‰ä¸¾å‡ºä¸€ä¸ªæ–°çš„ leaderï¼Œè®©æ‰€æœ‰çš„æœåŠ¡å™¨éƒ½æ¢å¤åˆ°ä¸€ä¸ªæ­£ç¡®çš„çŠ¶æ€ã€‚</li><li>å½“ leader è¢«é€‰ä¸¾å‡ºæ¥ï¼Œä¸”å¤§å¤šæ•°æœåŠ¡å™¨å®Œæˆäº†å’Œ leader çš„çŠ¶æ€åŒæ­¥åï¼Œleadder election çš„è¿‡ç¨‹å°±ç»“æŸäº†ï¼Œå°±å°†ä¼šè¿›å…¥åˆ° Atomic broadcast çš„è¿‡ç¨‹ã€‚</li><li>Atomic Broadcast åŒæ­¥ leader å’Œ follower ä¹‹é—´çš„ä¿¡æ¯ï¼Œä¿è¯ leader å’Œ follower å…·æœ‰å½¢åŒçš„ç³»ç»ŸçŠ¶æ€ã€‚</li></ul></li></ol><h2 id="_13ã€zookeeperä¸ºä»€ä¹ˆè¦è¿™ä¹ˆè®¾è®¡" tabindex="-1"><a class="header-anchor" href="#_13ã€zookeeperä¸ºä»€ä¹ˆè¦è¿™ä¹ˆè®¾è®¡" aria-hidden="true">#</a> 13ã€Zookeeperä¸ºä»€ä¹ˆè¦è¿™ä¹ˆè®¾è®¡ï¼Ÿ</h2><p>ZooKeeper è®¾è®¡çš„ç›®çš„æ˜¯æä¾›é«˜æ€§èƒ½ã€é«˜å¯ç”¨ã€é¡ºåºä¸€è‡´æ€§çš„åˆ†å¸ƒå¼åè°ƒæœåŠ¡ã€ä¿è¯æ•°æ®æœ€ç»ˆä¸€è‡´æ€§ã€‚ é«˜æ€§èƒ½ï¼ˆç®€å•çš„æ•°æ®æ¨¡å‹ï¼‰</p><ol><li><p>é‡‡ç”¨æ ‘å½¢ç»“æ„ç»„ç»‡æ•°æ®èŠ‚ç‚¹ï¼›</p></li><li><p>å…¨é‡æ•°æ®èŠ‚ç‚¹ï¼Œéƒ½å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼›</p></li><li><p>Follower å’Œ Observer ç›´æ¥å¤„ç†éäº‹åŠ¡è¯·æ±‚ï¼› é«˜å¯ç”¨ï¼ˆæ„å»ºé›†ç¾¤ï¼‰</p></li><li><p>åŠæ•°ä»¥ä¸Šæœºå™¨å­˜æ´»ï¼ŒæœåŠ¡å°±èƒ½æ­£å¸¸è¿è¡Œ</p></li><li><p>è‡ªåŠ¨è¿›è¡Œ Leader é€‰ä¸¾ é¡ºåºä¸€è‡´æ€§ï¼ˆäº‹åŠ¡æ“ä½œçš„é¡ºåºï¼‰</p></li><li><p>æ¯ä¸ªäº‹åŠ¡è¯·æ±‚ï¼Œéƒ½ä¼šè½¬å‘ç»™ Leader å¤„ç†</p></li><li><p>æ¯ä¸ªäº‹åŠ¡ï¼Œä¼šåˆ†é…å…¨å±€å”¯ä¸€çš„é€’å¢ idï¼ˆzxidï¼Œ64 ä½ï¼šepoch + è‡ªå¢ idï¼‰ æœ€ç»ˆä¸€è‡´æ€§</p></li><li><p>é€šè¿‡æè®®æŠ•ç¥¨æ–¹å¼ï¼Œä¿è¯äº‹åŠ¡æäº¤çš„å¯é æ€§</p></li><li><p>æè®®æŠ•ç¥¨æ–¹å¼ï¼Œåªèƒ½ä¿è¯ Client æ”¶åˆ°äº‹åŠ¡æäº¤æˆåŠŸåï¼ŒåŠæ•°ä»¥ä¸ŠèŠ‚ç‚¹èƒ½å¤Ÿçœ‹åˆ°æœ€æ–°æ•°æ®</p></li></ol><h2 id="_14ã€ä½ çŸ¥é“zookeeperä¸­æœ‰å“ªäº›è§’è‰²" tabindex="-1"><a class="header-anchor" href="#_14ã€ä½ çŸ¥é“zookeeperä¸­æœ‰å“ªäº›è§’è‰²" aria-hidden="true">#</a> 14ã€ä½ çŸ¥é“Zookeeperä¸­æœ‰å“ªäº›è§’è‰²ï¼Ÿ</h2><p>ç³»ç»Ÿæ¨¡å‹ï¼š</p><p>// TODO image</p><ul><li><strong>é¢†å¯¼è€…(leader)</strong> Leader æœåŠ¡å™¨ä¸ºå®¢æˆ·ç«¯æä¾›è¯»æœåŠ¡å’Œå†™æœåŠ¡ ã€‚ è´Ÿè´£è¿›è¡ŒæŠ•ç¥¨çš„å‘èµ·å’Œå†³è®® , æ›´æ–°ç³»ç»ŸçŠ¶æ€ ã€‚</li><li><strong>å­¦ä¹ è€…(learner)</strong></li><li><strong>è·Ÿéšè€…(follower)</strong> Follower æœåŠ¡å™¨ä¸ºå®¢æˆ·ç«¯æä¾›è¯»æœåŠ¡ï¼Œå‚ä¸ Leader é€‰ä¸¾è¿‡ç¨‹ï¼Œå‚ä¸å†™æ“ ä½œâ€œè¿‡åŠå†™æˆåŠŸâ€ç­–ç•¥ã€‚</li><li><strong>è§‚å¯Ÿè€…(observer)</strong> Observer æœåŠ¡å™¨ä¸ºå®¢æˆ·ç«¯æä¾›è¯»æœåŠ¡ï¼Œä¸å‚ä¸ Leader é€‰ä¸¾è¿‡ç¨‹ï¼Œä¸å‚ä¸ å†™æ“ä½œâ€œè¿‡åŠå†™æˆåŠŸâ€ç­–ç•¥ã€‚ç”¨äºåœ¨ä¸å½±å“å†™æ€§èƒ½çš„å‰æä¸‹æå‡é›†ç¾¤çš„è¯»æ€§èƒ½ã€‚</li><li><strong>å®¢æˆ·ç«¯(client)</strong> ï¼šæœåŠ¡è¯·æ±‚å‘èµ·æ–¹ã€‚</li></ul><h2 id="_15ã€ä½ ç†Ÿæ‚‰zookeeperèŠ‚ç‚¹znodeå’Œç›¸å…³å±æ€§å—" tabindex="-1"><a class="header-anchor" href="#_15ã€ä½ ç†Ÿæ‚‰zookeeperèŠ‚ç‚¹znodeå’Œç›¸å…³å±æ€§å—" aria-hidden="true">#</a> 15ã€ä½ ç†Ÿæ‚‰ZookeeperèŠ‚ç‚¹ZNodeå’Œç›¸å…³å±æ€§å—ï¼Ÿ</h2><ul><li><p>èŠ‚ç‚¹</p><ul><li><p>Znode ä¸¤ç§ç±»å‹ ï¼š</p><ul><li>æŒä¹…çš„ï¼ˆpersistentï¼‰ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯æ–­å¼€è¿æ¥åï¼Œåˆ›å»ºçš„èŠ‚ç‚¹ä¸åˆ é™¤ï¼ˆé»˜è®¤ï¼‰ã€‚</li><li>çŸ­æš‚çš„ï¼ˆephemeralï¼‰ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯æ–­å¼€è¿æ¥åï¼Œåˆ›å»ºçš„èŠ‚ç‚¹è‡ªå·±åˆ é™¤ã€‚</li></ul></li><li><p>Znode æœ‰å››ç§å½¢å¼ ï¼š</p><ol><li>æŒä¹…åŒ–ç›®å½•èŠ‚ç‚¹ï¼ˆPERSISTENTï¼‰ï¼šå®¢æˆ·ç«¯ä¸ Zookeeper æ–­å¼€è¿æ¥åï¼Œè¯¥èŠ‚ç‚¹ä¾æ—§å­˜åœ¨æŒä¹…åŒ–é¡ºåºç¼–å·ç›®å½•èŠ‚ç‚¹ï¼ˆPERSISTENT_SEQUENTIALï¼‰</li><li>å®¢æˆ·ç«¯ä¸ Zookeeper æ–­å¼€è¿æ¥åï¼Œè¯¥èŠ‚ç‚¹ä¾æ—§å­˜åœ¨ï¼Œåªæ˜¯ Zookeeper ç»™è¯¥èŠ‚ç‚¹åç§°è¿›è¡Œé¡ºåºç¼–å·ï¼šä¸´æ—¶ç›®å½•èŠ‚ç‚¹ï¼ˆEPHEMERALï¼‰</li><li>å®¢æˆ·ç«¯ä¸ Zookeeper æ–­å¼€è¿æ¥åï¼Œè¯¥èŠ‚ç‚¹è¢«åˆ é™¤ï¼šä¸´æ—¶é¡ºåºç¼–å·ç›®å½•èŠ‚ç‚¹(EPHEMERAL_SEQUENTIAL)</li><li>å®¢æˆ·ç«¯ä¸ Zookeeper æ–­å¼€è¿æ¥åï¼Œè¯¥èŠ‚ç‚¹è¢«åˆ é™¤ï¼Œåªæ˜¯ Zookeeper ç»™è¯¥èŠ‚ç‚¹åç§°è¿›è¡Œé¡ºåºç¼–å·</li></ol></li></ul><p><strong>ã€Œæ³¨æ„ã€</strong>ï¼šåˆ›å»º ZNode æ—¶è®¾ç½®é¡ºåºæ ‡è¯†ï¼ŒZNode åç§°åä¼šé™„åŠ ä¸€ä¸ªå€¼ï¼Œé¡ºåºå·æ˜¯ä¸€ä¸ªå•è°ƒé€’å¢çš„è®¡æ•°å™¨ï¼Œç”±çˆ¶èŠ‚ç‚¹ç»´æŠ¤ã€‚</p></li><li><p>èŠ‚ç‚¹å±æ€§</p><p>ä¸€ä¸ª znode èŠ‚ç‚¹ä¸ä»…å¯ä»¥å­˜å‚¨æ•°æ®ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–ç‰¹åˆ«çš„å±æ€§ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª/test èŠ‚ç‚¹åˆ†æä¸€ä¸‹å®ƒå„ä¸ªå±æ€§çš„å«ä¹‰ã€‚</p></li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>  [zk: localhost:2181(CONNECTED) 6] get /test 456
  cZxid = 0x59ac //
  ctime = Mon Mar 30 15:20:08 CST 2020 mZxid = 0x59ad
  mtime = Mon Mar 30 15:22:25 CST 2020 pZxid = 0x59ac
  cversion = 0
  dataVersion = 2
  aclVersion = 0 ephemeralOwner = 0x0 dataLength = 3
  numChildren = 0
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>å±æ€§è¯´æ˜</p><table><thead><tr><th>èŠ‚ç‚¹å±æ€§</th><th>æ³¨è§£</th></tr></thead><tbody><tr><td>cZxid</td><td>è¯¥æ•°æ®èŠ‚ç‚¹è¢«åˆ›å»ºæ—¶çš„äº‹ç‰© id</td></tr><tr><td>mZxid</td><td>è¯¥æ•°æ®èŠ‚ç‚¹è¢«ä¿®æ”¹æ—¶çš„æœ€æ–°äº‹åŠ¡ id</td></tr><tr><td>pZxid</td><td>å½“å‰èŠ‚ç‚¹çš„çˆ¶çº§èŠ‚ç‚¹äº‹ç‰© id</td></tr><tr><td>ctime</td><td>è¯¥æ•°æ®èŠ‚ç‚¹åˆ›å»ºæ—¶é—´</td></tr><tr><td>mtime</td><td>è¯¥æ•°æ®èŠ‚ç‚¹æœ€åä¿®æ”¹æ—¶é—´</td></tr><tr><td>dataVersion</td><td>å½“å‰èŠ‚ç‚¹ç‰ˆæœ¬å· (æ¯ä¿®æ”¹ä¸€æ¬¡å€¼ +1 é€’å¢)</td></tr><tr><td>cversion</td><td>å­èŠ‚ç‚¹ç‰ˆæœ¬å· (å­èŠ‚ç‚¹ä¿®æ”¹æ¬¡æ•°ï¼Œæ¯ä¿®æ”¹ä¸€æ¬¡å€¼ +1 é€’å¢)</td></tr><tr><td>aclVersion</td><td>å½“å‰èŠ‚ç‚¹ acl ç‰ˆæœ¬å· (èŠ‚ç‚¹è¢«ä¿®æ”¹ acl æƒé™ï¼Œæ¯ä¿®æ”¹ä¸€æ¬¡å€¼ +1 é€’å¢)</td></tr><tr><td>ephemeralOwner</td><td>ä¸´æ—¶èŠ‚ç‚¹è¡¨ç¤ºï¼Œå½“å‰èŠ‚ç‚¹å¦‚æœæ—¶ä¸´æ—¶èŠ‚ç‚¹ï¼Œåˆ™å­˜å‚¨çš„åˆ›å»ºè€…çš„ä¼šè¯ id (sessionId)ï¼Œå¦‚æœä¸æ˜¯ï¼Œå€¼ä¸º0</td></tr><tr><td>dataLength</td><td>å½“å‰èŠ‚ç‚¹æ‰€å­˜å‚¨çš„æ•°æ®é•¿åº¦</td></tr><tr><td>numChildren</td><td>å½“å‰èŠ‚ç‚¹ä¸‹å­èŠ‚ç‚¹çš„ä¸ªæ•°</td></tr></tbody></table><h2 id="_16ã€è¯·ç®€è¿°zookeeperçš„é€‰ä¸»æµç¨‹" tabindex="-1"><a class="header-anchor" href="#_16ã€è¯·ç®€è¿°zookeeperçš„é€‰ä¸»æµç¨‹" aria-hidden="true">#</a> 16ã€è¯·ç®€è¿°Zookeeperçš„é€‰ä¸»æµç¨‹</h2><p>Zookeeper çš„æ ¸å¿ƒæ˜¯åŸå­å¹¿æ’­ï¼Œè¿™ä¸ªæœºåˆ¶ä¿è¯äº†å„ä¸ª Server ä¹‹é—´çš„åŒæ­¥ã€‚å®ç°è¿™ä¸ªæœºåˆ¶çš„åè®®å«åš Zab åè®®ã€‚Zab åè®®æœ‰ä¸¤ç§æ¨¡å¼ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯æ¢å¤æ¨¡å¼ï¼ˆé€‰ä¸»ï¼‰å’Œå¹¿æ’­æ¨¡å¼ï¼ˆåŒæ­¥ï¼‰ã€‚å½“æœåŠ¡å¯åŠ¨æˆ–è€…åœ¨é¢†å¯¼è€…å´©æºƒåï¼ŒZab å°±è¿›å…¥äº†æ¢å¤æ¨¡å¼ï¼Œå½“é¢†å¯¼è€…è¢«é€‰ä¸¾å‡ºæ¥ï¼Œä¸”å¤§å¤šæ•° Server å®Œæˆäº†å’Œ leader çš„çŠ¶æ€åŒæ­¥ä»¥åï¼Œæ¢å¤æ¨¡å¼å°±ç»“æŸäº†ã€‚çŠ¶æ€åŒæ­¥ä¿è¯äº† leader å’Œ Server å…·æœ‰ç›¸åŒçš„ç³»ç»ŸçŠ¶æ€ã€‚leader é€‰ä¸¾æ˜¯ä¿è¯åˆ†å¸ƒå¼æ•°æ®ä¸€è‡´æ€§çš„å…³é”®ã€‚</p><p>å‡ºç°é€‰ä¸¾ä¸»è¦æ˜¯ä¸¤ç§åœºæ™¯ï¼šåˆå§‹åŒ–ã€leader ä¸å¯ç”¨ã€‚</p><p>å½“ zk é›†ç¾¤ä¸­çš„ä¸€å°æœåŠ¡å™¨å‡ºç°ä»¥ä¸‹ä¸¤ç§æƒ…å†µä¹‹ä¸€æ—¶ï¼Œå°±ä¼šå¼€å§‹ leader é€‰ä¸¾ã€‚</p><ol><li>æœåŠ¡å™¨åˆå§‹åŒ–å¯åŠ¨ã€‚</li><li>æœåŠ¡å™¨è¿è¡ŒæœŸé—´æ— æ³•å’Œ leader ä¿æŒè¿æ¥ã€‚</li></ol><p>è€Œå½“ä¸€å°æœºå™¨è¿›å…¥ leader é€‰ä¸¾æµç¨‹æ—¶ï¼Œå½“å‰é›†ç¾¤ä¹Ÿå¯èƒ½å¤„äºä»¥ä¸‹ä¸¤ç§çŠ¶æ€ã€‚</p><ol><li>é›†ç¾¤ä¸­æœ¬æ¥å°±å·²ç»å­˜åœ¨ä¸€ä¸ª leaderã€‚</li><li>é›†ç¾¤ä¸­ç¡®å®ä¸å­˜åœ¨ leaderã€‚</li></ol><p>é¦–å…ˆç¬¬ä¸€ç§æƒ…å†µï¼Œé€šå¸¸æ˜¯é›†ç¾¤ä¸­æŸä¸€å°æœºå™¨å¯åŠ¨æ¯”è¾ƒæ™šï¼Œåœ¨å®ƒå¯åŠ¨ä¹‹å‰ï¼Œé›†ç¾¤å·²ç»æ­£å¸¸å·¥ä½œï¼Œå³å·²ç»å­˜åœ¨ä¸€å° leader æœåŠ¡å™¨ã€‚å½“è¯¥æœºå™¨è¯•å›¾å»é€‰ä¸¾ leader æ—¶ï¼Œä¼šè¢«å‘ŠçŸ¥å½“å‰æœåŠ¡å™¨çš„ leader ä¿¡æ¯ï¼Œå®ƒä»…ä»…éœ€è¦å’Œ leader æœºå™¨å»ºç«‹è¿æ¥ï¼Œå¹¶è¿›è¡ŒçŠ¶æ€åŒæ­¥å³å¯ã€‚</p><p>é‡ç‚¹æ˜¯ leader ä¸å¯ç”¨äº†ï¼Œæ­¤æ—¶çš„é€‰ä¸»åˆ¶åº¦ã€‚</p><p>æŠ•ç¥¨ä¿¡æ¯ä¸­åŒ…å«ä¸¤ä¸ªæœ€åŸºæœ¬çš„ä¿¡æ¯ã€‚</p><ul><li>sid ï¼šå³ server idï¼Œç”¨æ¥æ ‡è¯†è¯¥æœºå™¨åœ¨é›†ç¾¤ä¸­çš„æœºå™¨åºå·ã€‚</li><li>zxid ï¼šå³ zookeeper äº‹åŠ¡ id å·ã€‚</li></ul><p>ZooKeeper çŠ¶æ€çš„æ¯ä¸€æ¬¡æ”¹å˜, éƒ½å¯¹åº”ç€ä¸€ä¸ªé€’å¢çš„ Transaction id,ï¼Œè¯¥ id ç§°ä¸º zxid.ï¼Œç”±äº zxid çš„é€’å¢æ€§è´¨, å¦‚æœ zxid1 å°äº zxid2,ï¼Œé‚£ä¹ˆ zxid1 è‚¯å®šå…ˆäº zxid2 å‘ç”Ÿã€‚åˆ›å»ºä»»æ„èŠ‚ç‚¹ï¼Œæˆ–è€…æ›´æ–°ä»»æ„èŠ‚ç‚¹çš„æ•°æ®, æˆ–è€…åˆ é™¤ä»»æ„èŠ‚ç‚¹ï¼Œéƒ½ä¼šå¯¼è‡´ Zookeeper çŠ¶æ€å‘ç”Ÿæ”¹å˜ï¼Œä»è€Œå¯¼è‡´ zxid çš„å€¼å¢åŠ ã€‚</p><p>ä»¥ï¼ˆsidï¼Œzxidï¼‰çš„å½¢å¼æ¥æ ‡è¯†ä¸€æ¬¡æŠ•ç¥¨ä¿¡æ¯ã€‚</p><p>ä¾‹å¦‚ï¼šå¦‚æœå½“å‰æœåŠ¡å™¨è¦æ¨ä¸¾ sid ä¸º 1ï¼Œzxid ä¸º 8 çš„æœåŠ¡å™¨æˆä¸º leaderï¼Œé‚£ä¹ˆæŠ•ç¥¨ä¿¡æ¯å¯ä»¥è¡¨ç¤ºä¸º (1, 8)</p><p>é›†ç¾¤ä¸­çš„æ¯å°æœºå™¨å‘å‡ºè‡ªå·±çš„æŠ•ç¥¨åï¼Œä¹Ÿä¼šæ¥å—æ¥è‡ªé›†ç¾¤ä¸­å…¶ä»–æœºå™¨çš„æŠ•ç¥¨ã€‚æ¯å°æœºå™¨éƒ½ä¼šæ ¹æ®ä¸€å®šçš„è§„åˆ™ï¼Œæ¥å¤„ç†æ”¶åˆ°çš„å…¶ä»–æœºå™¨çš„æŠ•ç¥¨ï¼Œä»¥æ­¤æ¥å†³å®šæ˜¯å¦éœ€è¦å˜æ›´è‡ªå·±çš„æŠ•ç¥¨ã€‚</p><p>è§„åˆ™å¦‚ä¸‹ ï¼š</p><ol><li>åˆå§‹é˜¶æ®µï¼Œéƒ½ä¼šç»™è‡ªå·±æŠ•ç¥¨ã€‚</li><li>å½“æ¥æ”¶åˆ°æ¥è‡ªå…¶ä»–æœåŠ¡å™¨çš„æŠ•ç¥¨æ—¶ï¼Œéƒ½éœ€è¦å°†åˆ«äººçš„æŠ•ç¥¨å’Œè‡ªå·±çš„æŠ•ç¥¨è¿›è¡Œ pkï¼Œè§„åˆ™å¦‚ä¸‹ï¼š ä¼˜å…ˆæ£€æŸ¥ zxidã€‚zxid æ¯”è¾ƒå¤§çš„æœåŠ¡å™¨ä¼˜å…ˆä½œä¸º leaderã€‚å¦‚æœ zxid ç›¸åŒçš„è¯ï¼Œå°±æ¯”è¾ƒ sidï¼Œsid æ¯”è¾ƒå¤§çš„æœåŠ¡å™¨ä½œä¸º leaderã€‚</li></ol><p>æ‰€æœ‰æœåŠ¡å¯åŠ¨æ—¶å€™çš„é€‰ä¸¾æµç¨‹ï¼š</p><p>ä¸‰å°æœåŠ¡å™¨ server1ã€server2ã€server3ï¼š</p><ol><li><p>server1 å¯åŠ¨ï¼Œä¸€å°æœºå™¨ä¸ä¼šé€‰ä¸¾ã€‚</p></li><li><p>server2 å¯åŠ¨ï¼Œserver1 å’Œ server2 çš„çŠ¶æ€æ”¹ä¸º lookingï¼Œå¹¿æ’­æŠ•ç¥¨</p></li><li><p>server3 å¯åŠ¨ï¼ŒçŠ¶æ€æ”¹ä¸º lookingï¼ŒåŠ å…¥å¹¿æ’­æŠ•ç¥¨ã€‚</p></li><li><p>åˆè¯†çŠ¶æ€ï¼Œäº’ä¸è®¤è¯†ï¼Œå¤§å®¶éƒ½è®¤ä¸ºè‡ªå·±æ˜¯ç‹è€…ï¼ŒæŠ•ç¥¨ä¹ŸæŠ•è‡ªå·±ä¸º Leaderã€‚</p></li><li><p>æŠ•ç¥¨ä¿¡æ¯è¯´æ˜ï¼Œç¥¨ä¿¡æ¯æœ¬æ¥ä¸ºäº”å…ƒç»„ï¼Œè¿™é‡Œä¸ºäº†é€»è¾‘æ¸…æ™°ï¼Œç®€åŒ–ä¸‹è¡¨è¾¾ã€‚ åˆè¯† zxid = 0ï¼Œsid æ˜¯æ¯ä¸ªèŠ‚ç‚¹çš„åå­—ï¼Œè¿™ä¸ª sid åœ¨ zoo.cfg ä¸­é…ç½®ï¼Œä¸ä¼šé‡å¤ã€‚</p><table><thead><tr><th>èŠ‚ç‚¹</th><th>sid</th></tr></thead><tbody><tr><td>server1</td><td>1</td></tr><tr><td>server2</td><td>2</td></tr><tr><td>server3</td><td>3</td></tr></tbody></table></li><li><p>åˆå§‹ zxid=0ï¼Œserver1 æŠ•ç¥¨ï¼ˆ1ï¼Œ0ï¼‰ï¼Œserver2 æŠ•ç¥¨ï¼ˆ2ï¼Œ0ï¼‰ï¼Œserver3 æŠ•ç¥¨ï¼ˆ3ï¼Œ0ï¼‰</p></li><li><p>server1 æ”¶åˆ°æŠ•ç¥¨ï¼ˆ2ï¼Œ0ï¼‰æ—¶ï¼Œä¼šå…ˆéªŒè¯æŠ•ç¥¨çš„åˆæ³•æ€§ï¼Œç„¶åè‡ªå·±çš„ç¥¨è¿›è¡Œ pkï¼Œpk çš„é€»è¾‘æ˜¯å…ˆæ¯”è¾ƒ zxidï¼Œserver1ï¼ˆzxidï¼‰=server2ï¼ˆzxidï¼‰=0ï¼Œzxid ç›¸ç­‰å†æ¯”è¾ƒ sidï¼Œserver1ï¼ˆsidï¼‰&lt; server2(sid)ï¼Œpk ç»“æœä¸º server2 çš„æŠ•ç¥¨è·èƒœã€‚server1 æ›´æ–°è‡ªå·±çš„æŠ•ç¥¨ä¸º ï¼ˆ2ï¼Œ0ï¼‰ï¼Œserver1 é‡æ–°æŠ•ç¥¨ã€‚</p></li><li><p>TODO è¿™é‡Œæœ€ç»ˆæ˜¯ 2 è¿˜æ˜¯ 3ï¼Œéœ€è¦åšå®éªŒç¡®å®šã€‚</p></li><li><p>server2 æ”¶åˆ° server1 æŠ•ç¥¨ï¼Œä¼šå…ˆéªŒè¯æŠ•ç¥¨çš„åˆæ³•æ€§ï¼Œç„¶å pkï¼Œè‡ªå·±çš„ç¥¨è·èƒœï¼Œserver ä¸ç”¨æ›´æ–°è‡ªå·±çš„ç¥¨ï¼Œpk åï¼Œé‡æ–°åœ¨å‘é€ä¸€æ¬¡æŠ•ç¥¨ã€‚</p></li><li><p>ç»Ÿè®¡æŠ•ç¥¨ï¼Œpk åä¼šç»Ÿè®¡æŠ•ç¥¨ï¼Œå¦‚æœåŠæ•°ä»¥ä¸Šçš„èŠ‚ç‚¹æŠ•å‡ºç›¸åŒçš„ç¥¨ï¼Œç¡®å®šé€‰å‡ºäº† Leaderã€‚</p></li><li><p>é€‰ä¸¾ç»“æŸï¼Œè¢«é€‰ä¸­èŠ‚ç‚¹çš„çŠ¶æ€ç”± LOOKING å˜æˆ LEADINGï¼Œå…¶ä»–å‚åŠ é€‰ä¸¾çš„èŠ‚ç‚¹ç”± LOOKING å˜æˆ FOLLOWINGã€‚å¦‚æœæœ‰ Observer èŠ‚ç‚¹ï¼Œå¦‚æœ Observer ä¸å‚ä¸é€‰ä¸¾ï¼Œæ‰€ä»¥é€‰ä¸¾å‰åå®ƒçš„çŠ¶æ€ä¸€ç›´æ˜¯ OBSERVINGï¼Œæ²¡æœ‰å˜åŒ–ã€‚ ç®€å•åœ°è¯´ å¼€å§‹æŠ•ç¥¨ -&gt; èŠ‚ç‚¹çŠ¶æ€å˜æˆ LOOKING -&gt; æ¯ä¸ªèŠ‚ç‚¹é€‰è‡ªå·±-&gt; æ”¶åˆ°ç¥¨è¿›è¡Œ PK -&gt; sid å¤§çš„è·èƒœ -&gt; æ›´æ–°é€‰ç¥¨ -&gt; å†æ¬¡æŠ•ç¥¨ -&gt; ç»Ÿè®¡é€‰ç¥¨ï¼Œé€‰ç¥¨è¿‡åŠæ•°é€‰ä¸¾ç»“æœ -&gt; èŠ‚ç‚¹çŠ¶æ€æ›´æ–°ä¸ºè‡ªå·±çš„è§’è‰²çŠ¶æ€ã€‚</p></li></ol><h2 id="_17ã€ä¸ºä»€ä¹ˆzookeeperé›†ç¾¤çš„æ•°ç›®-ä¸€èˆ¬ä¸ºå¥‡æ•°ä¸ª" tabindex="-1"><a class="header-anchor" href="#_17ã€ä¸ºä»€ä¹ˆzookeeperé›†ç¾¤çš„æ•°ç›®-ä¸€èˆ¬ä¸ºå¥‡æ•°ä¸ª" aria-hidden="true">#</a> 17ã€ä¸ºä»€ä¹ˆZookeeperé›†ç¾¤çš„æ•°ç›®ï¼Œä¸€èˆ¬ä¸ºå¥‡æ•°ä¸ªï¼Ÿ</h2><p>é¦–å…ˆéœ€è¦æ˜ç¡® zookeeper é€‰ä¸¾çš„è§„åˆ™ ï¼šleader é€‰ä¸¾ , è¦æ±‚<strong>å¯ç”¨èŠ‚ç‚¹æ•°é‡ &gt; æ€»èŠ‚ç‚¹æ•°é‡/2</strong> ã€‚</p><p>æ¯”å¦‚ï¼šæ ‡è®°ä¸€ä¸ªå†™æ˜¯å¦æˆåŠŸæ˜¯è¦åœ¨è¶…è¿‡ä¸€åŠèŠ‚ç‚¹å‘é€å†™è¯·æ±‚æˆåŠŸæ—¶æ‰è®¤ä¸ºæœ‰æ•ˆã€‚åŒæ ·ï¼ŒZookeeper é€‰æ‹©é¢†å¯¼è€…èŠ‚ç‚¹ä¹Ÿæ˜¯åœ¨è¶…è¿‡ä¸€åŠèŠ‚ç‚¹åŒæ„æ—¶æ‰æœ‰æ•ˆã€‚æœ€åï¼ŒZookeeper æ˜¯å¦æ­£å¸¸æ˜¯è¦æ ¹æ®æ˜¯å¦è¶…è¿‡ä¸€åŠçš„èŠ‚ç‚¹æ­£å¸¸æ‰ç®—æ­£å¸¸ã€‚è¿™æ˜¯åŸºäº CAP çš„ä¸€è‡´æ€§åŸç†ã€‚</p><p>zookeeperæœ‰è¿™æ ·ä¸€ä¸ªç‰¹æ€§ï¼šé›†ç¾¤ä¸­åªè¦æœ‰è¿‡åŠçš„æœºå™¨æ˜¯æ­£å¸¸å·¥ä½œçš„ï¼Œé‚£ä¹ˆæ•´ä¸ªé›†ç¾¤å¯¹å¤–å°±æ˜¯å¯ç”¨çš„ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´å¦‚æœæœ‰ 2 ä¸ª zookeeperï¼Œé‚£ä¹ˆåªè¦æœ‰ 1 ä¸ªæ­»äº† zookeeper å°±ä¸èƒ½ç”¨äº†ï¼Œå› ä¸º 1 æ²¡æœ‰è¿‡åŠï¼Œæ‰€ä»¥ 2 ä¸ª zookeeper çš„æ­»äº¡å®¹å¿åº¦ä¸º 0ï¼›</p><p>åŒç†ï¼Œè¦æ˜¯æœ‰ 3 ä¸ª zookeeperï¼Œä¸€ä¸ªæ­»äº†ï¼Œè¿˜å‰©ä¸‹ 2 ä¸ªæ­£å¸¸çš„ï¼Œè¿‡åŠäº†ï¼Œæ‰€ä»¥ 3 ä¸ª zookeeper çš„å®¹å¿åº¦ä¸º 1ï¼›</p><p>åŒç†ï¼š</p><ul><li>2-&gt;0ï¼›ä¸¤ä¸ª zookeeperï¼Œæœ€å¤š 0 ä¸ª zookeeper å¯ä»¥ä¸å¯ç”¨ã€‚</li><li>3-&gt;1ï¼›ä¸‰ä¸ª zookeeperï¼Œæœ€å¤š 1 ä¸ª zookeeper å¯ä»¥ä¸å¯ç”¨ã€‚</li><li>4-&gt;1ï¼›å››ä¸ª zookeeperï¼Œæœ€å¤š 1 ä¸ª zookeeper å¯ä»¥ä¸å¯ç”¨ã€‚</li><li>5-&gt;2ï¼›äº”ä¸ª zookeeperï¼Œæœ€å¤š 2 ä¸ª zookeeper å¯ä»¥ä¸å¯ç”¨ã€‚</li><li>6-&gt;2ï¼›ä¸¤ä¸ª zookeeperï¼Œæœ€å¤š 0 ä¸ª zookeeper å¯ä»¥ä¸å¯ç”¨ã€‚ ....</li></ul><p>ä¼šå‘ç°ä¸€ä¸ªè§„å¾‹ï¼Œ2n å’Œ 2n-1 çš„å®¹å¿åº¦æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯ n-1ï¼Œæ‰€ä»¥ä¸ºäº†æ›´åŠ é«˜æ•ˆï¼Œä½•å¿…å¢åŠ é‚£ä¸€ä¸ªä¸å¿…è¦çš„ zookeeper å‘¢ã€‚ zookeeper çš„é€‰ä¸¾ç­–ç•¥ä¹Ÿæ˜¯éœ€è¦åŠæ•°ä»¥ä¸Šçš„èŠ‚ç‚¹åŒæ„æ‰èƒ½å½“é€‰ leaderï¼Œå¦‚æœæ˜¯å¶æ•°èŠ‚ç‚¹å¯èƒ½å¯¼è‡´ç¥¨æ•°ç›¸åŒçš„æƒ…å†µã€‚</p><h2 id="_18ã€çŸ¥é“zookeeperç›‘å¬å™¨çš„åŸç†å—" tabindex="-1"><a class="header-anchor" href="#_18ã€çŸ¥é“zookeeperç›‘å¬å™¨çš„åŸç†å—" aria-hidden="true">#</a> 18ã€çŸ¥é“Zookeeperç›‘å¬å™¨çš„åŸç†å—ï¼Ÿ</h2><ol><li>åˆ›å»ºä¸€ä¸ª Main()çº¿ç¨‹ã€‚</li><li>åœ¨ Main()çº¿ç¨‹ä¸­åˆ›å»ºä¸¤ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªè´Ÿè´£ç½‘ç»œè¿æ¥é€šä¿¡ï¼ˆconnectï¼‰ï¼Œä¸€ä¸ªè´Ÿè´£ç›‘å¬ ï¼ˆlistenerï¼‰ã€‚</li><li>é€šè¿‡ connect çº¿ç¨‹å°†æ³¨å†Œçš„ç›‘å¬äº‹ä»¶å‘é€ç»™ Zookeeperã€‚</li><li>å°†æ³¨å†Œçš„ç›‘å¬äº‹ä»¶æ·»åŠ åˆ° Zookeeper çš„æ³¨å†Œç›‘å¬å™¨åˆ—è¡¨ä¸­ã€‚</li><li>Zookeeper ç›‘å¬åˆ°æœ‰æ•°æ®æˆ–è·¯å¾„å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒæŠŠè¿™æ¡æ¶ˆæ¯å‘é€ç»™ Listener çº¿ç¨‹ã€‚</li><li>Listener çº¿ç¨‹å†…éƒ¨è°ƒç”¨ process()æ–¹æ³•</li></ol><h2 id="_19ã€è¯´è¯´zookeeperä¸­çš„acl-æƒé™æ§åˆ¶æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#_19ã€è¯´è¯´zookeeperä¸­çš„acl-æƒé™æ§åˆ¶æœºåˆ¶" aria-hidden="true">#</a> 19ã€è¯´è¯´Zookeeperä¸­çš„ACL æƒé™æ§åˆ¶æœºåˆ¶</h2><ul><li><p>UGOï¼ˆUser/Group/Others)</p><p>ç›®å‰åœ¨ Linux/Unix æ–‡ä»¶ç³»ç»Ÿä¸­ä½¿ç”¨ï¼Œä¹Ÿæ˜¯ä½¿ç”¨æœ€å¹¿æ³›çš„æƒé™æ§åˆ¶æ–¹å¼ã€‚æ˜¯ä¸€ç§ç²—ç²’åº¦çš„æ–‡ä»¶ç³»ç»Ÿæƒé™æ§åˆ¶æ¨¡å¼ã€‚</p></li><li><p>ACLï¼ˆAccess Control Listï¼‰è®¿é—®æ§åˆ¶åˆ—è¡¨åŒ…æ‹¬ä¸‰ä¸ªæ–¹é¢ï¼š</p><ul><li><p>æƒé™æ¨¡å¼ï¼ˆSchemeï¼‰</p><ol><li>IPï¼šä» IP åœ°å€ç²’åº¦è¿›è¡Œæƒé™æ§åˆ¶</li><li>Digestï¼šæœ€å¸¸ç”¨ï¼Œç”¨ç±»ä¼¼äº username:password çš„æƒé™æ ‡è¯†æ¥è¿›è¡Œæƒé™é…ç½®ï¼Œä¾¿äºåŒºåˆ†ä¸åŒåº”ç”¨æ¥è¿›è¡Œæƒé™æ§åˆ¶</li><li>Worldï¼šæœ€å¼€æ”¾çš„æƒé™æ§åˆ¶æ–¹å¼ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„ digest æ¨¡å¼ï¼Œåªæœ‰ä¸€ä¸ªæƒé™æ ‡è¯†â€œworld:anyoneâ€</li><li>Superï¼šè¶…çº§ç”¨æˆ·</li></ol></li><li><p>æˆæƒå¯¹è±¡ æˆæƒå¯¹è±¡æŒ‡çš„æ˜¯æƒé™èµ‹äºˆçš„ç”¨æˆ·æˆ–ä¸€ä¸ªæŒ‡å®šå®ä½“ï¼Œä¾‹å¦‚ IP åœ°å€æˆ–æ˜¯æœºå™¨ç¯ã€‚</p></li><li><p>æƒé™ Permission</p><ol><li>CREATEï¼šæ•°æ®èŠ‚ç‚¹åˆ›å»ºæƒé™ï¼Œå…è®¸æˆæƒå¯¹è±¡åœ¨è¯¥ Znode ä¸‹åˆ›å»ºå­èŠ‚ç‚¹</li><li>DELETEï¼šå­èŠ‚ç‚¹åˆ é™¤æƒé™ï¼Œå…è®¸æˆæƒå¯¹è±¡åˆ é™¤è¯¥æ•°æ®èŠ‚ç‚¹çš„å­èŠ‚ç‚¹</li><li>READï¼šæ•°æ®èŠ‚ç‚¹çš„è¯»å–æƒé™ï¼Œå…è®¸æˆæƒå¯¹è±¡è®¿é—®è¯¥æ•°æ®èŠ‚ç‚¹å¹¶è¯»å–å…¶æ•°æ®å†…å®¹æˆ–å­èŠ‚ç‚¹åˆ—è¡¨ç­‰</li><li>WRITEï¼šæ•°æ®èŠ‚ç‚¹æ›´æ–°æƒé™ï¼Œå…è®¸æˆæƒå¯¹è±¡å¯¹è¯¥æ•°æ®èŠ‚ç‚¹è¿›è¡Œæ›´æ–°æ“ä½œ</li><li>ADMINï¼šæ•°æ®èŠ‚ç‚¹ç®¡ç†æƒé™ï¼Œå…è®¸æˆæƒå¯¹è±¡å¯¹è¯¥æ•°æ®èŠ‚ç‚¹è¿›è¡Œ ACL ç›¸å…³è®¾ç½®æ“ä½œ</li></ol></li></ul></li></ul><h2 id="_20ã€zookeeper-æœ‰å“ªå‡ ç§å‡ ç§éƒ¨ç½²æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#_20ã€zookeeper-æœ‰å“ªå‡ ç§å‡ ç§éƒ¨ç½²æ¨¡å¼" aria-hidden="true">#</a> 20ã€Zookeeper æœ‰å“ªå‡ ç§å‡ ç§éƒ¨ç½²æ¨¡å¼ï¼Ÿ</h2><p>Zookeeper æœ‰ä¸‰ç§éƒ¨ç½²æ¨¡å¼ï¼š</p><ol><li>å•æœºéƒ¨ç½²ï¼šä¸€å°é›†ç¾¤ä¸Šè¿è¡Œï¼›</li><li>é›†ç¾¤éƒ¨ç½²ï¼šå¤šå°é›†ç¾¤è¿è¡Œï¼›</li><li>ä¼ªé›†ç¾¤éƒ¨ç½²ï¼šä¸€å°é›†ç¾¤å¯åŠ¨å¤šä¸ª Zookeeper å®ä¾‹è¿è¡Œã€‚</li></ol><h2 id="_21ã€zookeeperé›†ç¾¤æ”¯æŒåŠ¨æ€æ·»åŠ æœºå™¨å—" tabindex="-1"><a class="header-anchor" href="#_21ã€zookeeperé›†ç¾¤æ”¯æŒåŠ¨æ€æ·»åŠ æœºå™¨å—" aria-hidden="true">#</a> 21ã€Zookeeperé›†ç¾¤æ”¯æŒåŠ¨æ€æ·»åŠ æœºå™¨å—ï¼Ÿ</h2><p>å…¶å®å°±æ˜¯æ°´å¹³æ‰©å®¹äº†ï¼ŒZookeeper åœ¨è¿™æ–¹é¢ä¸å¤ªå¥½ã€‚ä¸¤ç§æ–¹å¼ï¼š</p><ul><li>å…¨éƒ¨é‡å¯ï¼šå…³é—­æ‰€æœ‰ Zookeeper æœåŠ¡ï¼Œä¿®æ”¹é…ç½®ä¹‹åå¯åŠ¨ã€‚ä¸å½±å“ä¹‹å‰å®¢æˆ·ç«¯çš„ä¼šè¯ã€‚</li><li>é€ä¸ªé‡å¯ï¼šåœ¨è¿‡åŠå­˜æ´»å³å¯ç”¨çš„åŸåˆ™ä¸‹ï¼Œä¸€å°æœºå™¨é‡å¯ä¸å½±å“æ•´ä¸ªé›†ç¾¤å¯¹å¤–æä¾›æœåŠ¡ã€‚è¿™æ˜¯æ¯”è¾ƒå¸¸ç”¨çš„æ–¹å¼ã€‚ 3.5 ç‰ˆæœ¬å¼€å§‹æ”¯æŒåŠ¨æ€æ‰©å®¹ã€‚</li></ul><h2 id="_22ã€æè¿°ä¸€ä¸‹-zab-åè®®" tabindex="-1"><a class="header-anchor" href="#_22ã€æè¿°ä¸€ä¸‹-zab-åè®®" aria-hidden="true">#</a> 22ã€æè¿°ä¸€ä¸‹ ZAB åè®®</h2><p>ZAB åè®®æ˜¯ ZooKeeper è‡ªå·±å®šä¹‰çš„åè®®ï¼Œå…¨å ZooKeeper åŸå­å¹¿æ’­åè®®ã€‚</p><p>ZAB åè®®æœ‰ä¸¤ç§æ¨¡å¼ï¼šLeader èŠ‚ç‚¹å´©æºƒäº†å¦‚ä½•æ¢å¤å’Œæ¶ˆæ¯å¦‚ä½•å¹¿æ’­åˆ°æ‰€æœ‰èŠ‚ç‚¹ã€‚</p><p>æ•´ä¸ª ZooKeeper é›†ç¾¤æ²¡æœ‰ Leader èŠ‚ç‚¹çš„æ—¶å€™ï¼Œå±äºå´©æºƒçš„æƒ…å†µã€‚æ¯”å¦‚é›†ç¾¤å¯åŠ¨åˆšåˆšå¯åŠ¨ï¼Œè¿™æ—¶èŠ‚ç‚¹ä»¬äº’ç›¸ä¸è®¤è¯†ã€‚æ¯”å¦‚è¿ä½œ Leader èŠ‚ç‚¹å®•æœºäº†ï¼Œåˆæˆ–è€…ç½‘ç»œé—®é¢˜ï¼Œå…¶ä»–èŠ‚ç‚¹ Ping ä¸é€š Leader èŠ‚ç‚¹äº†ã€‚è¿™æ—¶å°±éœ€è¦ ZAB ä¸­çš„èŠ‚ç‚¹å´©æºƒåè®®ï¼Œæ‰€æœ‰èŠ‚ç‚¹è¿›å…¥é€‰ä¸¾æ¨¡å¼ï¼Œé€‰ä¸¾å‡ºæ–°çš„ Leaderã€‚æ•´ä¸ªé€‰ä¸¾è¿‡ç¨‹å°±æ˜¯é€šè¿‡å¹¿æ’­æ¥å®ç°çš„ã€‚é€‰ä¸¾æˆåŠŸåï¼Œä¸€åˆ‡éƒ½éœ€è¦ä»¥ Leader çš„æ•°æ®ä¸ºå‡†ï¼Œé‚£ä¹ˆå°±éœ€è¦è¿›è¡Œæ•°æ®åŒæ­¥äº†ã€‚</p><h2 id="_23ã€zab-å’Œ-paxos-ç®—æ³•çš„è”ç³»ä¸åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#_23ã€zab-å’Œ-paxos-ç®—æ³•çš„è”ç³»ä¸åŒºåˆ«" aria-hidden="true">#</a> 23ã€ZAB å’Œ Paxos ç®—æ³•çš„è”ç³»ä¸åŒºåˆ«ï¼Ÿ</h2><ul><li><p>ç›¸åŒç‚¹ï¼š</p><ol><li>ä¸¤è€…éƒ½å­˜åœ¨ä¸€ä¸ªç±»ä¼¼äº Leader è¿›ç¨‹çš„è§’è‰²ï¼Œç”±å…¶è´Ÿè´£åè°ƒå¤šä¸ª Follower è¿›ç¨‹çš„è¿è¡Œ</li><li>Leader è¿›ç¨‹éƒ½ä¼šç­‰å¾…è¶…è¿‡åŠæ•°çš„ Follower åšå‡ºæ­£ç¡®çš„åé¦ˆåï¼Œæ‰ä¼šå°†ä¸€ä¸ªææ¡ˆè¿›è¡Œæäº¤</li><li>ZAB åè®®ä¸­ï¼Œæ¯ä¸ª Proposal ä¸­éƒ½åŒ…å«ä¸€ä¸ª epoch å€¼æ¥ä»£è¡¨å½“å‰çš„ Leader å‘¨æœŸï¼ŒPaxos ä¸­åå­—ä¸º Ballot</li></ol></li><li><p>ä¸åŒç‚¹ï¼š</p><p>ZAB ç”¨æ¥æ„å»ºé«˜å¯ç”¨çš„åˆ†å¸ƒå¼æ•°æ®ä¸»å¤‡ç³»ç»Ÿï¼ˆZookeeperï¼‰ï¼ŒPaxos æ˜¯ç”¨æ¥æ„å»ºåˆ†å¸ƒå¼ä¸€è‡´æ€§çŠ¶æ€æœºç³»ç»Ÿã€‚</p></li></ul><h2 id="_24ã€zookeeper-å®•æœºå¦‚ä½•å¤„ç†" tabindex="-1"><a class="header-anchor" href="#_24ã€zookeeper-å®•æœºå¦‚ä½•å¤„ç†" aria-hidden="true">#</a> 24ã€ZooKeeper å®•æœºå¦‚ä½•å¤„ç†ï¼Ÿ</h2><p>ZooKeeper æœ¬èº«ä¹Ÿæ˜¯é›†ç¾¤ï¼Œæ¨èé…ç½®å¥‡æ•°ä¸ªæœåŠ¡å™¨ã€‚å› ä¸ºå®•æœºå°±éœ€è¦é€‰ä¸¾ï¼Œé€‰ä¸¾éœ€è¦åŠæ•° +1 ç¥¨æ‰èƒ½é€šè¿‡ï¼Œä¸ºäº†é¿å…æ‰“æˆå¹³æ‰‹ã€‚è¿›æ¥ä¸ç”¨å¶æ•°ä¸ªæœåŠ¡å™¨ã€‚</p><p>å¦‚æœæ˜¯ Follower å®•æœºäº†ï¼Œæ²¡å…³ç³»ä¸å½±å“ä»»ä½•ä½¿ç”¨ã€‚ç”¨æˆ·æ— æ„ŸçŸ¥ã€‚å¦‚æœ Leader å®•æœºï¼Œé›†ç¾¤å°±å¾—åœæ­¢å¯¹å¤–æœåŠ¡ï¼Œå¼€å§‹é€‰ä¸¾ï¼Œé€‰ä¸¾å‡ºä¸€ä¸ª Leader èŠ‚ç‚¹åï¼Œè¿›è¡Œæ•°æ®åŒæ­¥ï¼Œä¿è¯æ‰€æœ‰èŠ‚ç‚¹æ•°æ®å’Œ Leader ç»Ÿä¸€ï¼Œç„¶åå¼€å§‹å¯¹å¤–æä¾›æœåŠ¡ã€‚ ä¸ºå•¥æŠ•ç¥¨éœ€è¦åŠæ•° +1ï¼Œå¦‚æœåŠæ•°å°±å¯ä»¥çš„è¯ï¼Œç½‘ç»œçš„é—®é¢˜å¯èƒ½å¯¼è‡´é›†ç¾¤é€‰ä¸¾å‡ºæ¥ä¸¤ä¸ª Leaderï¼Œå„æœ‰ä¸€åŠçš„å°å¼Ÿæ”¯æŒï¼Œè¿™æ ·æ•°æ®ä¹Ÿå°±ä¹±å¥—äº†ã€‚</p><h2 id="_25ã€-æè¿°ä¸€ä¸‹-zookeeper-çš„-session-ç®¡ç†çš„æ€æƒ³" tabindex="-1"><a class="header-anchor" href="#_25ã€-æè¿°ä¸€ä¸‹-zookeeper-çš„-session-ç®¡ç†çš„æ€æƒ³" aria-hidden="true">#</a> 25ã€ æè¿°ä¸€ä¸‹ ZooKeeper çš„ session ç®¡ç†çš„æ€æƒ³ï¼Ÿ</h2><ul><li>åˆ†æ¡¶ç­–ç•¥ï¼š</li></ul><p>ç®€å•åœ°è¯´ï¼Œå°±æ˜¯ä¸åŒçš„ä¼šè¯è¿‡æœŸå¯èƒ½éƒ½æœ‰æ—¶é—´é—´éš”ï¼Œæ¯”å¦‚ 15 ç§’è¿‡æœŸã€15.1 ç§’è¿‡æœŸã€15.8 ç§’è¿‡æœŸ, ZooKeeper ç»Ÿä¸€è®©è¿™äº› session 16 ç§’è¿‡æœŸã€‚è¿™æ ·éå¸¸æ–¹ä¾¿ç®¡ç†ï¼Œçœ‹ä¸‹é¢çš„å…¬å¼ï¼Œè¿‡æœŸæ—¶é—´æ€»æ˜¯ ExpirationInterval çš„æ•´æ•°å€ã€‚</p><ul><li><p>è®¡ç®—å…¬å¼ï¼š</p><blockquote><p>ExpirationTime = currentTime + sessionTimeout</p><p>ExpirationTime = (ExpirationTime / ExpirationInrerval + 1) * ExpirationInterval</p></blockquote></li></ul><p>è§å›¾ç‰‡ï¼š</p><p>é»˜è®¤é…ç½®çš„ session è¶…æ—¶æ—¶é—´æ˜¯åœ¨ 2<em>tickTime~20</em>tickTimeã€‚</p><h2 id="_26ã€zookeeper-è´Ÿè½½å‡è¡¡å’Œ-nginx-è´Ÿè½½å‡è¡¡æœ‰ä»€ä¹ˆåŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#_26ã€zookeeper-è´Ÿè½½å‡è¡¡å’Œ-nginx-è´Ÿè½½å‡è¡¡æœ‰ä»€ä¹ˆåŒºåˆ«" aria-hidden="true">#</a> 26ã€ZooKeeper è´Ÿè½½å‡è¡¡å’Œ Nginx è´Ÿè½½å‡è¡¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h2><ul><li><p><strong>ZooKeeper</strong> ï¼š</p><ol><li>ä¸å­˜åœ¨å•ç‚¹é—®é¢˜ï¼Œzab æœºåˆ¶ä¿è¯å•ç‚¹æ•…éšœå¯é‡æ–°é€‰ä¸¾ä¸€ä¸ª Leader</li><li>åªè´Ÿè´£æœåŠ¡çš„æ³¨å†Œä¸å‘ç°ï¼Œä¸è´Ÿè´£è½¬å‘ï¼Œå‡å°‘ä¸€æ¬¡æ•°æ®äº¤æ¢ï¼ˆæ¶ˆè´¹æ–¹ä¸æœåŠ¡æ–¹ç›´æ¥é€šä¿¡ï¼‰</li><li>éœ€è¦è‡ªå·±å®ç°ç›¸åº”çš„è´Ÿè½½å‡è¡¡ç®—æ³•</li></ol></li><li><p><strong>Nginx</strong> ï¼š</p><ol><li>å­˜åœ¨å•ç‚¹é—®é¢˜ï¼Œå•ç‚¹è´Ÿè½½é«˜æ•°æ®é‡å¤§ï¼Œéœ€è¦é€šè¿‡ KeepAlived è¾…åŠ©å®ç°é«˜å¯ç”¨</li><li>æ¯æ¬¡è´Ÿè½½ï¼Œéƒ½å……å½“ä¸€æ¬¡ä¸­é—´äººè½¬å‘è§’è‰²ï¼Œæœ¬èº«æ˜¯ä¸ªåå‘ä»£ç†æœåŠ¡å™¨</li><li>è‡ªå¸¦è´Ÿè½½å‡è¡¡ç®—æ³•</li></ol></li></ul><h2 id="_27ã€è¯´è¯´zookeeper-çš„åºåˆ—åŒ–" tabindex="-1"><a class="header-anchor" href="#_27ã€è¯´è¯´zookeeper-çš„åºåˆ—åŒ–" aria-hidden="true">#</a> 27ã€è¯´è¯´ZooKeeper çš„åºåˆ—åŒ–</h2><p><strong>åºåˆ—åŒ–</strong> ï¼š</p><ol><li>å†…å­˜æ•°æ®ï¼Œä¿å­˜åˆ°ç¡¬ç›˜éœ€è¦åºåˆ—åŒ–ã€‚</li><li>å†…å­˜æ•°æ®ï¼Œé€šè¿‡ç½‘ç»œä¼ è¾“åˆ°å…¶ä»–èŠ‚ç‚¹ï¼Œéœ€è¦åºåˆ—åŒ–ã€‚</li></ol><p>ZK ä½¿ç”¨çš„åºåˆ—åŒ–åè®®æ˜¯ Juteï¼ŒJute æä¾›äº† Record æ¥å£ã€‚æ¥å£æä¾›äº†ä¸¤ä¸ªæ–¹æ³•ï¼š</p><ol><li>serialize åºåˆ—åŒ–æ–¹æ³•</li><li>deserialize ååºåˆ—åŒ–æ–¹æ³•</li></ol><p>è¦ç³»åˆ—åŒ–çš„æ–¹æ³•ï¼Œåœ¨è¿™ä¸¤ä¸ªæ–¹æ³•ä¸­å­˜å…¥åˆ°æµå¯¹è±¡ä¸­å³å¯ã€‚</p><h2 id="_28-åœ¨zookeeper-ä¸­-zxid-æ˜¯ä»€ä¹ˆ-æœ‰ä»€ä¹ˆä½œç”¨" tabindex="-1"><a class="header-anchor" href="#_28-åœ¨zookeeper-ä¸­-zxid-æ˜¯ä»€ä¹ˆ-æœ‰ä»€ä¹ˆä½œç”¨" aria-hidden="true">#</a> 28ï¼Œåœ¨Zookeeper ä¸­ Zxid æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</h2><ul><li><p><strong>Zxid</strong></p><p>ä¹Ÿå°±æ˜¯äº‹åŠ¡ idï¼Œä¸ºäº†ä¿è¯äº‹åŠ¡çš„é¡ºåºä¸€è‡´æ€§ï¼ŒZooKeeper é‡‡ç”¨äº†é€’å¢çš„äº‹åŠ¡ Zxid æ¥æ ‡è¯†äº‹åŠ¡ã€‚proposal éƒ½ä¼šåŠ ä¸Šäº† Zxidã€‚Zxid æ˜¯ä¸€ä¸ª 64 ä½çš„æ•°å­—ï¼Œå®ƒé«˜ 32 ä½æ˜¯ Epoch ç”¨æ¥æ ‡è¯†æœä»£å˜åŒ–ï¼Œæ¯”å¦‚æ¯æ¬¡é€‰ä¸¾ Epoch éƒ½ä¼šåŠ æ”¹å˜ã€‚ä½ 32 ä½ç”¨äºé€’å¢è®¡æ•°ã€‚</p></li><li><p><strong>Epoch</strong> ï¼š</p><p>å¯ä»¥ç†è§£ä¸ºå½“å‰é›†ç¾¤æ‰€å¤„çš„å¹´ä»£æˆ–è€…å‘¨æœŸï¼Œæ¯ä¸ª Leader å°±åƒçš‡å¸ï¼Œéƒ½æœ‰è‡ªå·±çš„å¹´å·ï¼Œæ‰€ä»¥æ¯æ¬¡æ”¹æœæ¢ä»£ï¼ŒLeader å˜æ›´ä¹‹åï¼Œéƒ½ä¼šåœ¨å‰ä¸€ä¸ªå¹´ä»£çš„åŸºç¡€ä¸ŠåŠ  1ã€‚è¿™æ ·å°±ç®—æ—§çš„ Leader å´©æºƒæ¢å¤ä¹‹åï¼Œä¹Ÿæ²¡æœ‰äººå¬å®ƒçš„äº†ï¼Œå› ä¸º Follower åªå¬ä»å½“å‰å¹´ä»£çš„ Leader çš„å‘½ä»¤ã€‚</p></li></ul><h2 id="_29ã€è®²è§£ä¸€ä¸‹-zookeeper-çš„æŒä¹…åŒ–æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#_29ã€è®²è§£ä¸€ä¸‹-zookeeper-çš„æŒä¹…åŒ–æœºåˆ¶" aria-hidden="true">#</a> 29ã€è®²è§£ä¸€ä¸‹ ZooKeeper çš„æŒä¹…åŒ–æœºåˆ¶</h2><ul><li><p>ä»€ä¹ˆæ˜¯æŒä¹…åŒ–ï¼Ÿ</p><ol><li>æ•°æ®ï¼Œå­˜åˆ°ç£ç›˜æˆ–è€…æ–‡ä»¶å½“ä¸­ã€‚</li><li>æœºå™¨é‡å¯åï¼Œæ•°æ®ä¸ä¼šä¸¢å¤±ã€‚å†…å­˜ -&gt; ç£ç›˜çš„æ˜ å°„ï¼Œå’Œåºåˆ—åŒ–æœ‰äº›åƒã€‚</li></ol></li><li><p>ZooKeeper çš„æŒä¹…åŒ–ï¼š</p><ul><li>SnapShot å¿«ç…§ï¼Œè®°å½•å†…å­˜ä¸­çš„å…¨é‡æ•°æ®</li><li>TxnLog å¢é‡äº‹åŠ¡æ—¥å¿—ï¼Œè®°å½•æ¯ä¸€æ¡å¢åˆ æ”¹è®°å½•ï¼ˆæŸ¥ä¸æ˜¯äº‹åŠ¡æ—¥å¿—ï¼Œä¸ä¼šå¼•èµ·æ•°æ®å˜åŒ–ï¼‰</li></ul></li><li><p>ä¸ºä»€ä¹ˆæŒä¹…åŒ–è¿™ä¹ˆéº»çƒ¦ï¼Œä¸€ä¸ªä¸å¯ç”¨å—ï¼Ÿ</p><p>å¿«ç…§çš„ç¼ºç‚¹ï¼Œæ–‡ä»¶å¤ªå¤§ï¼Œè€Œä¸”å¿«ç…§æ–‡ä»¶ä¸ä¼šæ˜¯æœ€æ–°çš„æ•°æ®ã€‚å¢é‡äº‹åŠ¡æ—¥å¿—çš„ç¼ºç‚¹ï¼Œè¿è¡Œæ—¶é—´é•¿äº†ï¼Œæ—¥å¿—å¤ªå¤šäº†ï¼ŒåŠ è½½å¤ªæ…¢ã€‚äºŒè€…ç»“åˆæœ€å¥½ã€‚</p><p>å¿«ç…§æ¨¡å¼</p><ul><li>å°† ZooKeeper å†…å­˜ä¸­ä»¥ DataTree æ•°æ®ç»“æ„å­˜å‚¨çš„æ•°æ®å®šæœŸå­˜å‚¨åˆ°ç£ç›˜ä¸­ã€‚</li><li>ç”±äºå¿«ç…§æ–‡ä»¶æ˜¯å®šæœŸå¯¹æ•°æ®çš„å…¨é‡å¤‡ä»½ï¼Œæ‰€ä»¥å¿«ç…§æ–‡ä»¶ä¸­æ•°æ®é€šå¸¸ä¸æ˜¯æœ€æ–°çš„ã€‚</li></ul><p>è§å›¾ç‰‡ï¼š</p></li></ul><h2 id="_30ã€zookeeperé€‰ä¸¾ä¸­æŠ•ç¥¨ä¿¡æ¯çš„äº”å…ƒç»„æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#_30ã€zookeeperé€‰ä¸¾ä¸­æŠ•ç¥¨ä¿¡æ¯çš„äº”å…ƒç»„æ˜¯ä»€ä¹ˆ" aria-hidden="true">#</a> 30ã€Zookeeperé€‰ä¸¾ä¸­æŠ•ç¥¨ä¿¡æ¯çš„äº”å…ƒç»„æ˜¯ä»€ä¹ˆï¼Ÿ</h2><ul><li>Leaderï¼šè¢«é€‰ä¸¾çš„ Leader çš„ SID</li><li>Zxidï¼šè¢«é€‰ä¸¾çš„ Leader çš„äº‹åŠ¡ ID</li><li>Sidï¼šå½“å‰æœåŠ¡å™¨çš„ SID</li><li>electionEpochï¼šå½“å‰æŠ•ç¥¨çš„è½®æ¬¡</li><li>peerEpochï¼šå½“å‰æœåŠ¡å™¨çš„ Epoch</li></ul><p><strong>Epoch &gt;Zxid &gt; Sid</strong></p><p>Epochï¼ŒZxid éƒ½å¯èƒ½ä¸€è‡´ï¼Œä½†æ˜¯ Sid ä¸€å®šä¸ä¸€æ ·ï¼Œè¿™æ ·ä¸¤å¼ é€‰ç¥¨ä¸€å®šä¼š PK å‡ºç»“æœã€‚</p><h2 id="_31ã€è¯´è¯´zookeeperä¸­çš„è„‘è£‚" tabindex="-1"><a class="header-anchor" href="#_31ã€è¯´è¯´zookeeperä¸­çš„è„‘è£‚" aria-hidden="true">#</a> 31ã€è¯´è¯´Zookeeperä¸­çš„è„‘è£‚ï¼Ÿ</h2><p>ç®€å•ç‚¹æ¥è¯´ï¼Œè„‘è£‚(Split-Brain) å°±æ˜¯æ¯”å¦‚å½“ä½ çš„ cluster é‡Œé¢æœ‰ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œå®ƒä»¬éƒ½çŸ¥é“åœ¨è¿™ä¸ª cluster é‡Œéœ€è¦é€‰ä¸¾å‡ºä¸€ä¸ª masterã€‚é‚£ä¹ˆå½“å®ƒä»¬ä¸¤ä¸ªä¹‹é—´çš„é€šä¿¡å®Œå…¨æ²¡æœ‰é—®é¢˜çš„æ—¶å€™ï¼Œå°±ä¼šè¾¾æˆå…±è¯†ï¼Œé€‰å‡ºå…¶ä¸­ä¸€ä¸ªä½œä¸º masterã€‚ä½†æ˜¯å¦‚æœå®ƒä»¬ä¹‹é—´çš„é€šä¿¡å‡ºäº†é—®é¢˜ï¼Œé‚£ä¹ˆä¸¤ä¸ªç»“ç‚¹éƒ½ä¼šè§‰å¾—ç°åœ¨æ²¡æœ‰ masterï¼Œæ‰€ä»¥æ¯ä¸ªéƒ½æŠŠè‡ªå·±é€‰ä¸¾æˆ masterï¼Œäºæ˜¯ cluster é‡Œé¢å°±ä¼šæœ‰ä¸¤ä¸ª masterã€‚</p><p>å¯¹äº Zookeeper æ¥è¯´æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„é—®é¢˜ï¼Œå°±æ˜¯åˆ°åº•æ˜¯æ ¹æ®ä¸€ä¸ªä»€ä¹ˆæ ·çš„æƒ…å†µæ¥åˆ¤æ–­ä¸€ä¸ªèŠ‚ç‚¹æ­»äº¡ down æ‰äº†ï¼Ÿåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­è¿™äº›éƒ½æ˜¯æœ‰ç›‘æ§è€…æ¥åˆ¤æ–­çš„ï¼Œä½†æ˜¯ç›‘æ§è€…ä¹Ÿå¾ˆéš¾åˆ¤å®šå…¶ä»–çš„èŠ‚ç‚¹çš„çŠ¶æ€ï¼Œå”¯ä¸€ä¸€ä¸ªå¯é çš„é€”å¾„å°±æ˜¯å¿ƒè·³ï¼ŒZookeeper ä¹Ÿæ˜¯ä½¿ç”¨å¿ƒè·³æ¥åˆ¤æ–­å®¢æˆ·ç«¯æ˜¯å¦ä»ç„¶æ´»ç€ã€‚</p><p>ä½¿ç”¨ ZooKeeper æ¥åš Leader HA åŸºæœ¬éƒ½æ˜¯åŒæ ·çš„æ–¹å¼ï¼šæ¯ä¸ªèŠ‚ç‚¹éƒ½å°è¯•æ³¨å†Œä¸€ä¸ªè±¡å¾ leader çš„ä¸´æ—¶èŠ‚ç‚¹ï¼Œå…¶ä»–æ²¡æœ‰æ³¨å†ŒæˆåŠŸçš„åˆ™æˆä¸º followerï¼Œå¹¶ä¸”é€šè¿‡ watch æœºåˆ¶ç›‘æ§ç€ leader æ‰€åˆ›å»ºçš„ä¸´æ—¶èŠ‚ç‚¹ï¼Œ Zookeeper é€šè¿‡å†…éƒ¨å¿ƒè·³æœºåˆ¶æ¥ç¡®å®š leader çš„çŠ¶æ€ï¼Œä¸€æ—¦ leader å‡ºç°æ„å¤– Zookeeper èƒ½å¾ˆå¿«è·æ‚‰å¹¶ä¸”é€šçŸ¥å…¶ä»–çš„ followerï¼Œå…¶ä»– ï¬‚ower åœ¨ä¹‹åä½œå‡ºç›¸å…³ååº”ï¼Œè¿™æ ·å°±å®Œæˆäº†ä¸€ä¸ªåˆ‡æ¢ï¼Œè¿™ç§æ¨¡å¼ä¹Ÿæ˜¯æ¯”è¾ƒé€šç”¨çš„æ¨¡å¼ï¼ŒåŸºæœ¬å¤§éƒ¨åˆ†éƒ½æ˜¯è¿™æ ·å®ç°çš„ã€‚ä½†æ˜¯è¿™é‡Œé¢æœ‰ä¸ªå¾ˆä¸¥é‡çš„é—®é¢˜ï¼Œå¦‚æœæ³¨æ„ä¸åˆ°ä¼šå¯¼è‡´çŸ­æš‚çš„æ—¶é—´å†…ç³»ç»Ÿå‡ºç°è„‘è£‚ï¼Œå› ä¸ºå¿ƒè·³å‡ºç°è¶…æ—¶å¯èƒ½æ˜¯ leader æŒ‚äº†ï¼Œä½†æ˜¯ä¹Ÿå¯èƒ½æ˜¯ zookeeper èŠ‚ç‚¹ä¹‹é—´ç½‘ç»œå‡ºç°äº†é—®é¢˜ï¼Œå¯¼è‡´ leader å‡æ­»çš„æƒ…å†µï¼Œleader å…¶å®å¹¶æœªæ­»æ‰ï¼Œä½†æ˜¯ä¸ ZooKeeper ä¹‹é—´çš„ç½‘ç»œå‡ºç°é—®é¢˜å¯¼è‡´ Zookeeper è®¤ä¸ºå…¶æŒ‚æ‰äº†ç„¶åé€šçŸ¥å…¶ä»–èŠ‚ç‚¹è¿›è¡Œåˆ‡æ¢ï¼Œè¿™æ · follower ä¸­å°±æœ‰ä¸€ä¸ªæˆä¸ºäº† leaderï¼Œä½†æ˜¯åŸæœ¬çš„ leader å¹¶æœªæ­»æ‰ï¼Œè¿™æ—¶å€™ client ä¹Ÿè·å¾— leader åˆ‡æ¢çš„æ¶ˆæ¯ï¼Œä½†æ˜¯ä»ç„¶ä¼šæœ‰ä¸€äº›å»¶æ—¶ï¼Œzookeeper éœ€è¦é€šè®¯éœ€è¦ä¸€ä¸ªä¸€ä¸ªé€šçŸ¥ï¼Œè¿™æ—¶å€™æ•´ä¸ªç³»ç»Ÿå°±å¾ˆæ··ä¹±å¯èƒ½æœ‰ä¸€éƒ¨åˆ† client å·²ç»é€šçŸ¥åˆ°äº†è¿æ¥åˆ°æ–°çš„ leader ä¸Šå»äº†ï¼Œæœ‰çš„ client ä»ç„¶è¿æ¥åœ¨è€çš„ leader ä¸Šï¼Œå¦‚æœåŒæ—¶æœ‰ä¸¤ä¸ª client éœ€è¦å¯¹ leader çš„åŒä¸€ä¸ªæ•°æ®æ›´æ–°ï¼Œå¹¶ä¸”åˆšå¥½è¿™ä¸¤ä¸ª client æ­¤åˆ»åˆ†åˆ«è¿æ¥åœ¨æ–°è€çš„ leader ä¸Šï¼Œå°±ä¼šå‡ºç°å¾ˆä¸¥é‡é—®é¢˜ã€‚</p><p>è¿™é‡Œåšä¸‹å°æ€»ç»“ï¼š</p><ul><li><strong>å‡æ­»</strong>ï¼šç”±äºå¿ƒè·³è¶…æ—¶ï¼ˆç½‘ç»œåŸå› å¯¼è‡´çš„ï¼‰è®¤ä¸º leader æ­»äº†ï¼Œä½†å…¶å® leader è¿˜å­˜æ´»ç€ã€‚</li><li><strong>è„‘è£‚</strong>ï¼šç”±äºå‡æ­»ä¼šå‘èµ·æ–°çš„ leader é€‰ä¸¾ï¼Œé€‰ä¸¾å‡ºä¸€ä¸ªæ–°çš„ leaderï¼Œä½†æ—§çš„ leader ç½‘ç»œåˆé€šäº†ï¼Œå¯¼è‡´å‡ºç°äº†ä¸¤ä¸ª leader ï¼Œæœ‰çš„å®¢æˆ·ç«¯è¿æ¥åˆ°è€çš„ leaderï¼Œè€Œæœ‰çš„å®¢æˆ·ç«¯åˆ™è¿æ¥åˆ°æ–°çš„ leaderã€‚</li></ul><h2 id="_32ã€zookeeperè„‘è£‚æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„" tabindex="-1"><a class="header-anchor" href="#_32ã€zookeeperè„‘è£‚æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„" aria-hidden="true">#</a> 32ã€Zookeeperè„‘è£‚æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„ï¼Ÿ</h2><p>ä¸»è¦åŸå› æ˜¯ Zookeeper é›†ç¾¤å’Œ Zookeeper client åˆ¤æ–­è¶…æ—¶å¹¶ä¸èƒ½åšåˆ°å®Œå…¨åŒæ­¥ï¼Œä¹Ÿå°±æ˜¯è¯´å¯èƒ½ä¸€å‰ä¸€åï¼Œå¦‚æœæ˜¯é›†ç¾¤å…ˆäº client å‘ç°ï¼Œé‚£å°±ä¼šå‡ºç°ä¸Šé¢çš„æƒ…å†µã€‚åŒæ—¶ï¼Œåœ¨å‘ç°å¹¶åˆ‡æ¢åé€šçŸ¥å„ä¸ªå®¢æˆ·ç«¯ä¹Ÿæœ‰å…ˆåå¿«æ…¢ã€‚ä¸€èˆ¬å‡ºç°è¿™ç§æƒ…å†µçš„å‡ ç‡å¾ˆå°ï¼Œéœ€è¦ leader èŠ‚ç‚¹ä¸ Zookeeper é›†ç¾¤ç½‘ç»œæ–­å¼€ï¼Œä½†æ˜¯ä¸å…¶ä»–é›†ç¾¤è§’è‰²ä¹‹é—´çš„ç½‘ç»œæ²¡æœ‰é—®é¢˜ï¼Œè¿˜è¦æ»¡è¶³ä¸Šé¢é‚£äº›æƒ…å†µï¼Œä½†æ˜¯ä¸€æ—¦å‡ºç°å°±ä¼šå¼•èµ·å¾ˆä¸¥é‡çš„åæœï¼Œæ•°æ®ä¸ä¸€è‡´ã€‚</p><h2 id="_33ã€zookeeper-æ˜¯å¦‚ä½•è§£å†³è„‘è£‚é—®é¢˜çš„" tabindex="-1"><a class="header-anchor" href="#_33ã€zookeeper-æ˜¯å¦‚ä½•è§£å†³è„‘è£‚é—®é¢˜çš„" aria-hidden="true">#</a> 33ã€Zookeeper æ˜¯å¦‚ä½•è§£å†³è„‘è£‚é—®é¢˜çš„ï¼Ÿ</h2><p>è¦è§£å†³ Split-Brain è„‘è£‚çš„é—®é¢˜ï¼Œä¸€èˆ¬æœ‰ä¸‹é¢å‡ ç§ç§æ–¹æ³•ï¼š Quorums (æ³•å®šäººæ•°) æ–¹å¼: æ¯”å¦‚ 3 ä¸ªèŠ‚ç‚¹çš„é›†ç¾¤ï¼ŒQuorums = 2, ä¹Ÿå°±æ˜¯è¯´é›†ç¾¤å¯ä»¥å®¹å¿ 1 ä¸ªèŠ‚ç‚¹å¤±æ•ˆï¼Œè¿™æ—¶å€™è¿˜èƒ½é€‰ä¸¾å‡º 1 ä¸ª leadï¼Œé›†ç¾¤è¿˜å¯ç”¨ã€‚æ¯”å¦‚ 4 ä¸ªèŠ‚ç‚¹çš„é›†ç¾¤ï¼Œå®ƒçš„ Quorums = 3ï¼ŒQuorums è¦è¶…è¿‡ 3ï¼Œç›¸å½“äºé›†ç¾¤çš„å®¹å¿åº¦è¿˜æ˜¯ 1ï¼Œå¦‚æœ 2 ä¸ªèŠ‚ç‚¹å¤±æ•ˆï¼Œé‚£ä¹ˆæ•´ä¸ªé›†ç¾¤è¿˜æ˜¯æ— æ•ˆçš„ã€‚è¿™æ˜¯ zookeeper é˜²æ­¢&quot;è„‘è£‚&quot;é»˜è®¤é‡‡ç”¨çš„æ–¹æ³•ã€‚</p><p>é‡‡ç”¨ Redundant communications (å†—ä½™é€šä¿¡)æ–¹å¼ï¼šé›†ç¾¤ä¸­é‡‡ç”¨å¤šç§é€šä¿¡æ–¹å¼ï¼Œé˜²æ­¢ä¸€ç§é€šä¿¡æ–¹å¼å¤±æ•ˆå¯¼è‡´é›†ç¾¤ä¸­çš„èŠ‚ç‚¹æ— æ³•é€šä¿¡ã€‚</p><p>Fencing (å…±äº«èµ„æº) æ–¹å¼ï¼šæ¯”å¦‚èƒ½çœ‹åˆ°å…±äº«èµ„æºå°±è¡¨ç¤ºåœ¨é›†ç¾¤ä¸­ï¼Œèƒ½å¤Ÿè·å¾—å…±äº«èµ„æºçš„é”çš„å°±æ˜¯ Leaderï¼Œçœ‹ä¸åˆ°å…±äº«èµ„æºçš„ï¼Œå°±ä¸åœ¨é›†ç¾¤ä¸­ã€‚</p><p>è¦æƒ³é¿å… zookeeper&quot;è„‘è£‚&quot;æƒ…å†µå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œåœ¨ follower èŠ‚ç‚¹åˆ‡æ¢çš„æ—¶å€™ä¸åœ¨æ£€æŸ¥åˆ°è€çš„ leader èŠ‚ç‚¹å‡ºç°é—®é¢˜åé©¬ä¸Šåˆ‡æ¢ï¼Œè€Œæ˜¯åœ¨ä¼‘çœ ä¸€æ®µè¶³å¤Ÿçš„æ—¶é—´ï¼Œç¡®ä¿è€çš„ leader å·²ç»è·çŸ¥å˜æ›´å¹¶ä¸”åšäº†ç›¸å…³çš„ shutdown æ¸…ç†å·¥ä½œäº†ç„¶åå†æ³¨å†Œæˆä¸º master å°±èƒ½é¿å…è¿™ç±»é—®é¢˜äº†ï¼Œè¿™ä¸ªä¼‘çœ æ—¶é—´ä¸€èˆ¬å®šä¹‰ä¸ºä¸ zookeeper å®šä¹‰çš„è¶…æ—¶æ—¶é—´å°±å¤Ÿäº†ï¼Œä½†æ˜¯è¿™æ®µæ—¶é—´å†…ç³»ç»Ÿå¯èƒ½æ˜¯ä¸å¯ç”¨çš„ï¼Œä½†æ˜¯ç›¸å¯¹äºæ•°æ®ä¸ä¸€è‡´çš„åæœæ¥è¯´è¿˜æ˜¯å€¼å¾—çš„ã€‚</p><p>zooKeeper é»˜è®¤é‡‡ç”¨äº† Quorums è¿™ç§æ–¹å¼æ¥é˜²æ­¢&quot;è„‘è£‚&quot;ç°è±¡ã€‚å³åªæœ‰é›†ç¾¤ä¸­è¶…è¿‡åŠæ•°èŠ‚ç‚¹æŠ•ç¥¨æ‰èƒ½é€‰ä¸¾å‡º Leaderã€‚è¿™æ ·çš„æ–¹å¼å¯ä»¥ç¡®ä¿ leader çš„å”¯ä¸€æ€§,è¦ä¹ˆé€‰å‡ºå”¯ä¸€çš„ä¸€ä¸ª leader,è¦ä¹ˆé€‰ä¸¾å¤±è´¥ã€‚</p><p>åœ¨ zookeeper ä¸­ Quorums ä½œç”¨å¦‚ä¸‹ï¼š</p><ul><li>é›†ç¾¤ä¸­æœ€å°‘çš„èŠ‚ç‚¹æ•°ç”¨æ¥é€‰ä¸¾ leader ä¿è¯é›†ç¾¤å¯ç”¨ã€‚</li><li>é€šçŸ¥å®¢æˆ·ç«¯æ•°æ®å·²ç»å®‰å…¨ä¿å­˜å‰é›†ç¾¤ä¸­æœ€å°‘æ•°é‡çš„èŠ‚ç‚¹æ•°å·²ç»ä¿å­˜äº†è¯¥æ•°æ®ã€‚ä¸€æ—¦è¿™äº›èŠ‚ç‚¹ä¿å­˜äº†è¯¥æ•°æ®ï¼Œå®¢æˆ·ç«¯å°†è¢«é€šçŸ¥å·²ç»å®‰å…¨ä¿å­˜äº†ï¼Œå¯ä»¥ç»§ç»­å…¶ä»–ä»»åŠ¡ã€‚è€Œé›†ç¾¤ä¸­å‰©ä½™çš„èŠ‚ç‚¹å°†ä¼šæœ€ç»ˆä¹Ÿä¿å­˜äº†è¯¥æ•°æ®ã€‚</li></ul><p>å‡è®¾æŸä¸ª leader å‡æ­»ï¼Œå…¶ä½™çš„ followers é€‰ä¸¾å‡ºäº†ä¸€ä¸ªæ–°çš„ leaderã€‚è¿™æ—¶ï¼Œæ—§çš„ leader å¤æ´»å¹¶ä¸”ä»ç„¶è®¤ä¸ºè‡ªå·±æ˜¯ leaderï¼Œè¿™ä¸ªæ—¶å€™å®ƒå‘å…¶ä»– followers å‘å‡ºå†™è¯·æ±‚ä¹Ÿæ˜¯ä¼šè¢«æ‹’ç»çš„ã€‚å› ä¸ºæ¯å½“æ–° leader äº§ç”Ÿæ—¶ï¼Œä¼šç”Ÿæˆä¸€ä¸ª epoch æ ‡å·(æ ‡è¯†å½“å‰å±äºé‚£ä¸ª leader çš„ç»Ÿæ²»æ—¶æœŸ)ï¼Œè¿™ä¸ª epoch æ˜¯é€’å¢çš„ï¼Œ followers å¦‚æœç¡®è®¤äº†æ–°çš„ leader å­˜åœ¨ï¼ŒçŸ¥é“å…¶ epochï¼Œå°±ä¼šæ‹’ç» epoch å°äºç°ä»» leader epoch çš„æ‰€æœ‰è¯·æ±‚ã€‚é‚£æœ‰æ²¡æœ‰ follower ä¸çŸ¥é“æ–°çš„ leader å­˜åœ¨å‘¢ï¼Œæœ‰å¯èƒ½ï¼Œä½†è‚¯å®šä¸æ˜¯å¤§å¤šæ•°ï¼Œå¦åˆ™æ–° leader æ— æ³•äº§ç”Ÿã€‚Zookeeper çš„å†™ä¹Ÿéµå¾ª quorum æœºåˆ¶ï¼Œå› æ­¤ï¼Œå¾—ä¸åˆ°å¤§å¤šæ•°æ”¯æŒçš„å†™æ˜¯æ— æ•ˆçš„ï¼Œæ—§ leader å³ä½¿å„ç§è®¤ä¸ºè‡ªå·±æ˜¯ leaderï¼Œä¾ç„¶æ²¡æœ‰ä»€ä¹ˆä½œç”¨ã€‚ zookeeper é™¤äº†å¯ä»¥é‡‡ç”¨ä¸Šé¢é»˜è®¤çš„ Quorums æ–¹å¼æ¥é¿å…å‡ºç°&quot;è„‘è£‚&quot;ï¼Œè¿˜å¯ä»¥å¯é‡‡ç”¨ä¸‹é¢çš„é¢„é˜²æªæ–½ï¼š</p><ol><li>æ·»åŠ å†—ä½™çš„å¿ƒè·³çº¿ï¼Œä¾‹å¦‚åŒçº¿æ¡çº¿ï¼Œå°½é‡å‡å°‘â€œè£‚è„‘â€å‘ç”Ÿæœºä¼šã€‚</li><li>å¯ç”¨ç£ç›˜é”ã€‚æ­£åœ¨æœåŠ¡ä¸€æ–¹é”ä½å…±äº«ç£ç›˜ï¼Œ&quot;è£‚è„‘&quot;å‘ç”Ÿæ—¶ï¼Œè®©å¯¹æ–¹å®Œå…¨&quot;æŠ¢ä¸èµ°&quot;å…±äº«ç£ç›˜èµ„æºã€‚ä½†ä½¿ç”¨é”ç£ç›˜ä¹Ÿä¼šæœ‰ä¸€ä¸ªä¸å°çš„é—®é¢˜ï¼Œå¦‚æœå ç”¨å…±äº«ç›˜çš„ä¸€æ–¹ä¸ä¸»åŠ¨&quot;è§£é”&quot;ï¼Œå¦ä¸€æ–¹å°±æ°¸è¿œå¾—ä¸åˆ°å…±äº«ç£ç›˜ã€‚ç°å®ä¸­å‡å¦‚æœåŠ¡èŠ‚ç‚¹çªç„¶æ­»æœºæˆ–å´©æºƒï¼Œå°±ä¸å¯èƒ½æ‰§è¡Œè§£é”å‘½ä»¤ã€‚åå¤‡èŠ‚ç‚¹ä¹Ÿå°±æ¥ç®¡ä¸äº†å…±äº«èµ„æºå’Œåº”ç”¨æœåŠ¡ã€‚äºæ˜¯æœ‰äººåœ¨ HA ä¸­è®¾è®¡äº†&quot;æ™ºèƒ½&quot;é”ã€‚å³æ­£åœ¨æœåŠ¡çš„ä¸€æ–¹åªåœ¨å‘ç°å¿ƒè·³çº¿å…¨éƒ¨æ–­å¼€ï¼ˆå¯Ÿè§‰ä¸åˆ°å¯¹ç«¯ï¼‰æ—¶æ‰å¯ç”¨ç£ç›˜é”ã€‚å¹³æ—¶å°±ä¸ä¸Šé”äº†ã€‚</li><li>è®¾ç½®ä»²è£æœºåˆ¶ã€‚ä¾‹å¦‚è®¾ç½®å‚è€ƒ IPï¼ˆå¦‚ç½‘å…³ IPï¼‰ï¼Œå½“å¿ƒè·³çº¿å®Œå…¨æ–­å¼€æ—¶ï¼Œ2 ä¸ªèŠ‚ç‚¹éƒ½å„è‡ª ping ä¸€ä¸‹å‚è€ƒ IPï¼Œä¸é€šåˆ™è¡¨æ˜æ–­ç‚¹å°±å‡ºåœ¨æœ¬ç«¯ï¼Œä¸ä»…&quot;å¿ƒè·³&quot;ã€è¿˜å…¼å¯¹å¤–&quot;æœåŠ¡&quot;çš„æœ¬ç«¯ç½‘ç»œé“¾è·¯æ–­äº†ï¼Œå³ä½¿å¯åŠ¨ï¼ˆæˆ–ç»§ç»­ï¼‰åº”ç”¨æœåŠ¡ä¹Ÿæ²¡æœ‰ç”¨äº†ï¼Œé‚£å°±ä¸»åŠ¨æ”¾å¼ƒç«äº‰ï¼Œè®©èƒ½å¤Ÿ ping é€šå‚è€ƒ IP çš„ä¸€ç«¯å»èµ·æœåŠ¡ã€‚æ›´ä¿é™©ä¸€äº›ï¼Œping ä¸é€šå‚è€ƒ IP çš„ä¸€æ–¹å¹²è„†å°±è‡ªæˆ‘é‡å¯ï¼Œä»¥å½»åº•é‡Šæ”¾æœ‰å¯èƒ½è¿˜å ç”¨ç€çš„é‚£äº›å…±äº«èµ„æºã€‚</li></ol><h2 id="_34ã€è¯´è¯´-zookeeper-çš„-cap-é—®é¢˜ä¸Šåšçš„å–èˆ" tabindex="-1"><a class="header-anchor" href="#_34ã€è¯´è¯´-zookeeper-çš„-cap-é—®é¢˜ä¸Šåšçš„å–èˆ" aria-hidden="true">#</a> 34ã€è¯´è¯´ Zookeeper çš„ CAP é—®é¢˜ä¸Šåšçš„å–èˆï¼Ÿ</h2><ul><li><p><strong>ä¸€è‡´æ€§ C</strong> ï¼šZookeeper æ˜¯å¼ºä¸€è‡´æ€§ç³»ç»Ÿï¼Œä¸ºäº†ä¿è¯è¾ƒå¼ºçš„å¯ç”¨æ€§ï¼Œâ€œä¸€åŠä»¥ä¸ŠæˆåŠŸå³æˆåŠŸâ€çš„æ•°æ®åŒæ­¥æ–¹å¼å¯èƒ½ä¼šå¯¼è‡´éƒ¨åˆ†èŠ‚ç‚¹çš„æ•°æ®ä¸ä¸€è‡´ã€‚æ‰€ä»¥ Zookeeper è¿˜æä¾›äº† sync() æ“ä½œæ¥åšæ‰€æœ‰èŠ‚ç‚¹çš„æ•°æ®åŒæ­¥ï¼Œè¿™å°±å…³äº C å’Œ A çš„é€‰æ‹©é—®é¢˜äº¤ç»™äº†ç”¨æˆ·ï¼Œå› ä¸ºä½¿ç”¨ sync()åŠ¿å¿…ä¼šå»¶é•¿åŒæ­¥æ—¶é—´ï¼Œå¯ç”¨æ€§ä¼šæœ‰ä¸€äº›æŸå¤±ã€‚</p></li><li><p><strong>å¯ç”¨æ€§ A</strong> ï¼šZookeeper æ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œä¸”å„ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥ç›¸åº”è¯»è¯·æ±‚ï¼Œå…·æœ‰å¥½çš„å“åº”æ€§èƒ½ã€‚ Zookeeper ä¿è¯äº†æ•°æ®æ€»æ˜¯å¯ç”¨çš„ï¼Œæ²¡æœ‰é”ã€‚å¹¶ä¸”æœ‰ä¸€å¤§åŠçš„èŠ‚ç‚¹æ‰€æ‹¥æœ‰çš„æ•°æ®æ˜¯æœ€æ–°çš„ã€‚</p></li><li><p><strong>åˆ†åŒºå®¹å¿æ€§ P</strong> ï¼šFollower èŠ‚ç‚¹è¿‡å¤šä¼šå¯¼è‡´å¢å¤§æ•°æ®åŒæ­¥çš„å»¶æ—¶ï¼ˆéœ€è¦åŠæ•°ä»¥ä¸Š follower å†™å®Œæ äº¤ï¼‰ã€‚åŒæ—¶é€‰ä¸¾è¿‡ç¨‹çš„æ”¶æ•›é€Ÿåº¦ä¼šå˜æ…¢ï¼Œå¯ç”¨æ€§é™ä½ã€‚Zookeeper é€šè¿‡å¼•å…¥ observer èŠ‚ç‚¹ç¼“è§£äº†è¿™ä¸ªé—®é¢˜ï¼Œå¢åŠ  observer èŠ‚ç‚¹åé›†ç¾¤å¯æ¥å— client è¯·æ±‚çš„èŠ‚ç‚¹å¤šäº†ï¼Œè€Œä¸” observer ä¸å‚ä¸æŠ•ç¥¨ï¼Œå¯ä»¥æé«˜å¯ç”¨æ€§å’Œæ‰©å±•æ€§ï¼Œä½†æ˜¯èŠ‚ç‚¹å¤šæ•°æ®åŒæ­¥æ€»å½’æ˜¯ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥ä¸€è‡´æ€§ä¼šæœ‰æ‰€é™ä½ã€‚</p></li></ul><h2 id="_35ã€watch-ç›‘å¬ä¸ºä»€ä¹ˆæ˜¯ä¸€æ¬¡æ€§çš„" tabindex="-1"><a class="header-anchor" href="#_35ã€watch-ç›‘å¬ä¸ºä»€ä¹ˆæ˜¯ä¸€æ¬¡æ€§çš„" aria-hidden="true">#</a> 35ã€watch ç›‘å¬ä¸ºä»€ä¹ˆæ˜¯ä¸€æ¬¡æ€§çš„ï¼Ÿ</h2><p>å¦‚æœæœåŠ¡ç«¯å˜åŠ¨é¢‘ç¹ï¼Œè€Œç›‘å¬çš„å®¢æˆ·ç«¯å¾ˆå¤šæƒ…å†µä¸‹ï¼Œæ¯æ¬¡å˜åŠ¨éƒ½è¦é€šçŸ¥åˆ°æ‰€æœ‰çš„å®¢æˆ·ç«¯ï¼Œç»™ç½‘ç»œå’ŒæœåŠ¡å™¨é€ æˆå¾ˆå¤§å‹åŠ›ã€‚</p><p>ä¸€èˆ¬æ˜¯å®¢æˆ·ç«¯æ‰§è¡ŒgetData(èŠ‚ç‚¹ A,true) ï¼Œå¦‚æœèŠ‚ç‚¹ A å‘ç”Ÿäº†å˜æ›´æˆ–åˆ é™¤ï¼Œå®¢æˆ·ç«¯ä¼šå¾—åˆ°å®ƒçš„ watch äº‹ä»¶ï¼Œä½†æ˜¯åœ¨ä¹‹åèŠ‚ç‚¹ A åˆå‘ç”Ÿäº†å˜æ›´ï¼Œè€Œå®¢æˆ·ç«¯åˆæ²¡æœ‰è®¾ç½® watch äº‹ä»¶ï¼Œå°±ä¸å†ç»™å®¢æˆ·ç«¯å‘é€ã€‚</p><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¾ˆå¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„å®¢æˆ·ç«¯ä¸éœ€è¦çŸ¥é“æœåŠ¡ç«¯çš„æ¯ä¸€æ¬¡å˜åŠ¨ï¼Œæˆ‘åªè¦æœ€æ–°çš„æ•°æ®å³å¯ã€‚</p><!--]--></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/imdtf/blog/edit/main/docs/interview/zookeeper.md" rel="noopener noreferrer" target="_blank" aria-label="ç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" aria-labelledby="edit"><title id="edit" lang="en">edit icon</title><g fill="currentColor"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></g></svg><!--]-->ç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><span class="info">2022/6/8 23:47:48</span></div><div class="meta-item contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: imdtf@qq.com">DTF</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/interview/linux.html" class="nav-link prev" aria-label="Linux ç¯‡"><div class="hint"><span class="arrow left"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->Linux ç¯‡</div></a><a href="/interview/Redis.html" class="nav-link next" aria-label="Redis ç¯‡"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow right"></span></div><div class="link">Redis ç¯‡<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">é»˜è®¤é¡µè„š</div><div class="copyright">Copyright Â© 2022 DTF</div></footer><!--]--></div><!--]--><!----><!----><div id="pwa-install"><!----><div id="install-modal-wrapper" style="display:none;"><div class="background"></div><div class="install-modal"><div class="header"><button class="close-button" aria-label="å…³é—­"><svg xmlns="http://www.w3.org/2000/svg" class="icon close-icon" viewbox="0 0 1024 1024" aria-labelledby="close"><title id="close" lang="en">close icon</title><g fill="currentColor"><path d="M589.654 511.965 1007.212 84.22a49.777 49.777 0 0 0-.73-70.02 49.046 49.046 0 0 0-69.687.665L519.967 441.946 85.882 14.2a49.08 49.08 0 0 0-69.687.664 49.777 49.777 0 0 0 .664 70.019l433.454 427.082L16.859 939.048a49.777 49.777 0 0 0-.664 70.019 49.013 49.013 0 0 0 69.687.663l434.085-427.746 416.828 427.083A49.013 49.013 0 0 0 972.037 1024a48.416 48.416 0 0 0 34.512-14.27 49.777 49.777 0 0 0 .73-70.019z"></path></g></svg></button><div class="logo"><!----><div class="title"><h1></h1><p class="desc">è¯¥åº”ç”¨å¯ä»¥å®‰è£…åœ¨ä½ çš„ PC æˆ–ç§»åŠ¨è®¾å¤‡ä¸Šã€‚è¿™å°†ä½¿è¯¥ Web åº”ç”¨ç¨‹åºå¤–è§‚å’Œè¡Œä¸ºä¸å…¶ä»–åº”ç”¨ç¨‹åºç›¸åŒã€‚å®ƒå°†åœ¨å‡ºç°åœ¨åº”ç”¨ç¨‹åºåˆ—è¡¨ä¸­ï¼Œå¹¶å¯ä»¥å›ºå®šåˆ°ä¸»å±å¹•ï¼Œå¼€å§‹èœå•æˆ–ä»»åŠ¡æ ã€‚æ­¤ Web åº”ç”¨ç¨‹åºè¿˜å°†èƒ½å¤Ÿä¸å…¶ä»–åº”ç”¨ç¨‹åºå’Œä½ çš„æ“ä½œç³»ç»Ÿå®‰å…¨åœ°è¿›è¡Œäº¤äº’ã€‚</p></div></div></div><div class="content"><div class="highlight"><!----><!----></div><div class="description"><h3>è¯¦æƒ…</h3><p></p></div></div><div class="button-wrapper"><button class="install-button">å®‰è£…<span></span></button><button class="cancel-button">å–æ¶ˆ</button></div></div></div></div><!--]--></div>
    <script type="module" src="/assets/app.597ce2f2.js" defer></script>
  </body>
</html>
